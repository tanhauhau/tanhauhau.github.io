function n(){}function a(n,a){for(const s in a)n[s]=a[s];return n}function s(n){return n()}function t(){return Object.create(null)}function e(n){n.forEach(s)}function o(n){return"function"==typeof n}function p(n,a){return n!=n?a==a:n!==a||n&&"object"==typeof n||"function"==typeof n}function c(n,s,t,e){return n[1]&&e?a(t.ctx.slice(),n[1](e(s))):t.ctx}function l(n,a,s,t,e,o,p){const l=function(n,a,s,t){if(n[2]&&t){const e=n[2](t(s));if(void 0===a.dirty)return e;if("object"==typeof e){const n=[],s=Math.max(a.dirty.length,e.length);for(let t=0;t<s;t+=1)n[t]=a.dirty[t]|e[t];return n}return a.dirty|e}return a.dirty}(a,t,e,o);if(l){const e=c(a,s,t,p);n.p(e,l)}}function u(n,a){n.appendChild(a)}function r(n,a,s){n.insertBefore(a,s||null)}function i(n){n.parentNode.removeChild(n)}function k(n,a){for(let s=0;s<n.length;s+=1)n[s]&&n[s].d(a)}function d(n){return document.createElement(n)}function h(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function f(n){return document.createTextNode(n)}function m(){return f(" ")}function g(){return f("")}function w(n,a,s){null==s?n.removeAttribute(a):n.getAttribute(a)!==s&&n.setAttribute(a,s)}function v(n){return Array.from(n.childNodes)}function y(n,a,s,t){for(let t=0;t<n.length;t+=1){const e=n[t];if(e.nodeName===a){let a=0;const o=[];for(;a<e.attributes.length;){const n=e.attributes[a++];s[n.name]||o.push(n.name)}for(let n=0;n<o.length;n++)e.removeAttribute(o[n]);return n.splice(t,1)[0]}}return t?h(a):d(a)}function E(n,a){for(let s=0;s<n.length;s+=1){const t=n[s];if(3===t.nodeType)return t.data=""+a,n.splice(s,1)[0]}return f(a)}function b(n){return E(n," ")}function I(n,a){a=""+a,n.wholeText!==a&&(n.data=a)}function x(n,a){n.value=null==a?"":a}class P{constructor(n=null){this.a=n,this.e=this.n=null}m(n,a,s=null){this.e||(this.e=d(a.nodeName),this.t=a,this.h(n)),this.i(s)}h(n){this.e.innerHTML=n,this.n=Array.from(this.e.childNodes)}i(n){for(let a=0;a<this.n.length;a+=1)r(this.t,this.n[a],n)}p(n){this.d(),this.h(n),this.i(this.a)}d(){this.n.forEach(i)}}let j;function A(n){j=n}function T(n){(function(){if(!j)throw new Error("Function called outside component initialization");return j})().$$.on_mount.push(n)}const S=[],L=[],O=[],M=[],C=Promise.resolve();let q=!1;function N(n){O.push(n)}let R=!1;const $=new Set;function D(){if(!R){R=!0;do{for(let n=0;n<S.length;n+=1){const a=S[n];A(a),H(a.$$)}for(S.length=0;L.length;)L.pop()();for(let n=0;n<O.length;n+=1){const a=O[n];$.has(a)||($.add(a),a())}O.length=0}while(S.length);for(;M.length;)M.pop()();q=!1,R=!1,$.clear()}}function H(n){if(null!==n.fragment){n.update(),e(n.before_update);const a=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,a),n.after_update.forEach(N)}}const G=new Set;function B(n,a){n&&n.i&&(G.delete(n),n.i(a))}function F(n,a,s,t){if(n&&n.o){if(G.has(n))return;G.add(n),(void 0).c.push(()=>{G.delete(n),t&&(s&&n.d(1),t())}),n.o(a)}}function J(n){n&&n.c()}function U(n,a){n&&n.l(a)}function W(n,a,t){const{fragment:p,on_mount:c,on_destroy:l,after_update:u}=n.$$;p&&p.m(a,t),N(()=>{const a=c.map(s).filter(o);l?l.push(...a):e(a),n.$$.on_mount=[]}),u.forEach(N)}function _(n,a){const s=n.$$;null!==s.fragment&&(e(s.on_destroy),s.fragment&&s.fragment.d(a),s.on_destroy=s.fragment=null,s.ctx=[])}function V(n,a){-1===n.$$.dirty[0]&&(S.push(n),q||(q=!0,C.then(D)),n.$$.dirty.fill(0)),n.$$.dirty[a/31|0]|=1<<a%31}function z(a,s,o,p,c,l,u=[-1]){const r=j;A(a);const k=s.props||{},d=a.$$={fragment:null,ctx:null,props:l,update:n,not_equal:c,bound:t(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(r?r.$$.context:[]),callbacks:t(),dirty:u};let h=!1;if(d.ctx=o?o(a,k,(n,s,...t)=>{const e=t.length?t[0]:s;return d.ctx&&c(d.ctx[n],d.ctx[n]=e)&&(d.bound[n]&&d.bound[n](e),h&&V(a,n)),s}):[],d.update(),h=!0,e(d.before_update),d.fragment=!!p&&p(d.ctx),s.target){if(s.hydrate){const n=v(s.target);d.fragment&&d.fragment.l(n),n.forEach(i)}else d.fragment&&d.fragment.c();s.intro&&B(a.$$.fragment),W(a,s.target,s.anchor),D()}A(r)}class Y{$destroy(){_(this,1),this.$destroy=n}$on(n,a){const s=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return s.push(a),()=>{const n=s.indexOf(a);-1!==n&&s.splice(n,1)}}$set(){}}function K(a){let s,t,e,o,p,c,l,k,g,I,x,P,j,A,T,S,L,O,M,C,q,N,R,$,D,H,G,B,F,J,U,W,_,V,z;return{c(){s=d("header"),t=d("nav"),e=d("ul"),o=d("li"),p=d("a"),c=f("Tan Li Hau"),l=m(),k=d("li"),g=d("a"),I=f("About"),x=m(),P=d("li"),j=d("a"),A=f("Writings"),T=m(),S=d("li"),L=d("a"),O=f("Talks"),M=m(),C=d("li"),q=d("a"),N=f("Notes"),R=m(),$=d("li"),D=d("a"),H=f("Newsletter"),G=m(),B=d("li"),F=d("a"),J=h("svg"),U=h("path"),W=m(),_=d("a"),V=h("svg"),z=h("path"),this.h()},l(n){s=y(n,"HEADER",{class:!0});var a=v(s);t=y(a,"NAV",{});var u=v(t);e=y(u,"UL",{class:!0});var r=v(e);o=y(r,"LI",{class:!0});var d=v(o);p=y(d,"A",{href:!0,class:!0});var h=v(p);c=E(h,"Tan Li Hau"),h.forEach(i),d.forEach(i),l=b(r),k=y(r,"LI",{class:!0});var f=v(k);g=y(f,"A",{href:!0,class:!0});var m=v(g);I=E(m,"About"),m.forEach(i),f.forEach(i),x=b(r),P=y(r,"LI",{class:!0});var w=v(P);j=y(w,"A",{href:!0,class:!0});var Y=v(j);A=E(Y,"Writings"),Y.forEach(i),w.forEach(i),T=b(r),S=y(r,"LI",{class:!0});var K=v(S);L=y(K,"A",{href:!0,class:!0});var Z=v(L);O=E(Z,"Talks"),Z.forEach(i),K.forEach(i),M=b(r),C=y(r,"LI",{class:!0});var Q=v(C);q=y(Q,"A",{href:!0,class:!0});var X=v(q);N=E(X,"Notes"),X.forEach(i),Q.forEach(i),R=b(r),$=y(r,"LI",{class:!0});var nn=v($);D=y(nn,"A",{href:!0,class:!0});var an=v(D);H=E(an,"Newsletter"),an.forEach(i),nn.forEach(i),G=b(r),B=y(r,"LI",{class:!0});var sn=v(B);F=y(sn,"A",{"aria-label":!0,href:!0,class:!0});var tn=v(F);J=y(tn,"svg",{viewBox:!0,width:!0,height:!0,class:!0},1);var en=v(J);U=y(en,"path",{d:!0},1),v(U).forEach(i),en.forEach(i),tn.forEach(i),W=b(sn),_=y(sn,"A",{"aria-label":!0,href:!0,class:!0});var on=v(_);V=y(on,"svg",{viewBox:!0,width:!0,height:!0,class:!0},1);var pn=v(V);z=y(pn,"path",{d:!0},1),v(z).forEach(i),pn.forEach(i),on.forEach(i),sn.forEach(i),r.forEach(i),u.forEach(i),a.forEach(i),this.h()},h(){w(p,"href","/"),w(p,"class","svelte-f3e4uo"),w(o,"class","svelte-f3e4uo"),w(g,"href","/about"),w(g,"class","svelte-f3e4uo"),w(k,"class","svelte-f3e4uo"),w(j,"href","/blogs"),w(j,"class","svelte-f3e4uo"),w(P,"class","svelte-f3e4uo"),w(L,"href","/talks"),w(L,"class","svelte-f3e4uo"),w(S,"class","svelte-f3e4uo"),w(q,"href","/notes"),w(q,"class","svelte-f3e4uo"),w(C,"class","svelte-f3e4uo"),w(D,"href","/newsletter"),w(D,"class","svelte-f3e4uo"),w($,"class","svelte-f3e4uo"),w(U,"d","M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66\n    10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5\n    4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"),w(J,"viewBox","0 0 24 24"),w(J,"width","1em"),w(J,"height","1em"),w(J,"class","svelte-f3e4uo"),w(F,"aria-label","Twitter account"),w(F,"href","https://twitter.com/lihautan"),w(F,"class","svelte-f3e4uo"),w(z,"d","M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0\n    0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07\n    5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65\n    5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42\n    3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"),w(V,"viewBox","0 0 24 24"),w(V,"width","1em"),w(V,"height","1em"),w(V,"class","svelte-f3e4uo"),w(_,"aria-label","Github account"),w(_,"href","https://github.com/tanhauhau"),w(_,"class","svelte-f3e4uo"),w(B,"class","social svelte-f3e4uo"),w(e,"class","svelte-f3e4uo"),w(s,"class","svelte-f3e4uo")},m(n,a){r(n,s,a),u(s,t),u(t,e),u(e,o),u(o,p),u(p,c),u(e,l),u(e,k),u(k,g),u(g,I),u(e,x),u(e,P),u(P,j),u(j,A),u(e,T),u(e,S),u(S,L),u(L,O),u(e,M),u(e,C),u(C,q),u(q,N),u(e,R),u(e,$),u($,D),u(D,H),u(e,G),u(e,B),u(B,F),u(F,J),u(J,U),u(B,W),u(B,_),u(_,V),u(V,z)},p:n,i:n,o:n,d(n){n&&i(s)}}}class Z extends Y{constructor(n){super(),z(this,n,null,K,p,{})}}function Q(a){let s,t,e,o,p,c,l,k,h,g,I,P,j,A,T,S,L,O,M,C;return{c(){s=d("div"),t=d("h1"),e=f("Subscribe to my newsletter"),o=m(),p=d("h2"),c=f("Get the latest blog posts and project updates delivered right to your inbox"),l=m(),k=d("form"),h=d("div"),g=d("input"),I=m(),P=d("input"),A=m(),T=d("input"),S=m(),L=d("p"),O=f("Powered by Buttondown."),this.h()},l(n){s=y(n,"DIV",{class:!0});var a=v(s);t=y(a,"H1",{});var u=v(t);e=E(u,"Subscribe to my newsletter"),u.forEach(i),o=b(a),p=y(a,"H2",{class:!0});var r=v(p);c=E(r,"Get the latest blog posts and project updates delivered right to your inbox"),r.forEach(i),l=b(a),k=y(a,"FORM",{action:!0,method:!0,target:!0,onsubmit:!0,class:!0});var d=v(k);h=y(d,"DIV",{class:!0});var f=v(h);g=y(f,"INPUT",{type:!0,name:!0,id:!0,"aria-label":!0,placeholder:!0,class:!0}),I=b(f),P=y(f,"INPUT",{type:!0,value:!0,disabled:!0,class:!0}),f.forEach(i),A=b(d),T=y(d,"INPUT",{type:!0,value:!0,name:!0,class:!0}),S=b(d),L=y(d,"P",{class:!0});var m=v(L);O=E(m,"Powered by Buttondown."),m.forEach(i),d.forEach(i),a.forEach(i),this.h()},h(){w(p,"class","svelte-1k1s1co"),w(g,"type","email"),w(g,"name","email"),w(g,"id","bd-email"),w(g,"aria-label","email address"),w(g,"placeholder","youremail@example.com"),w(g,"class","svelte-1k1s1co"),w(P,"type","submit"),P.value="Subscribe",P.disabled=j=!a[0],w(P,"class","svelte-1k1s1co"),w(h,"class","form-item svelte-1k1s1co"),w(T,"type","hidden"),T.value="1",w(T,"name","embed"),w(T,"class","svelte-1k1s1co"),w(L,"class","svelte-1k1s1co"),w(k,"action","https://buttondown.email/api/emails/embed-subscribe/lihautan"),w(k,"method","post"),w(k,"target","popupwindow"),w(k,"onsubmit","window.open('https://buttondown.email/lihautan', 'popupwindow')"),w(k,"class","embeddable-buttondown-form"),w(s,"class","form svelte-1k1s1co")},m(n,i){var d,f,m,w;r(n,s,i),u(s,t),u(t,e),u(s,o),u(s,p),u(p,c),u(s,l),u(s,k),u(k,h),u(h,g),x(g,a[0]),u(h,I),u(h,P),u(k,A),u(k,T),u(k,S),u(k,L),u(L,O),M||(d=g,f="input",m=a[1],d.addEventListener(f,m,w),C=()=>d.removeEventListener(f,m,w),M=!0)},p(n,[a]){1&a&&g.value!==n[0]&&x(g,n[0]),1&a&&j!==(j=!n[0])&&(P.disabled=j)},i:n,o:n,d(n){n&&i(s),M=!1,C()}}}function X(n,a,s){let t;return[t,function(){t=this.value,s(0,t)}]}class nn extends Y{constructor(n){super(),z(this,n,X,Q,p,{})}}function an(n){return T(()=>(setTimeout(()=>{if(window.innerWidth>1080){const n=document.createElement("script");n.async=!0,n.type="text/javascript",n.src="//cdn.carbonads.com/carbon.js?serve=CE7ITK3E&placement=lihautancom",n.id="_carbonads_js",document.body.appendChild(n)}},5e3),()=>{try{const n=document.getElementById("carbonads");n.parentNode.removeChild(n)}catch(n){}})),[]}class sn extends Y{constructor(n){super(),z(this,n,an,null,p,{})}}var tn="https://lihautan.com/i-wrote-my-module-bundler/assets/hero-twitter-01456022.jpg";function en(n,a,s){const t=n.slice();return t[6]=a[s],t}function on(n,a,s){const t=n.slice();return t[6]=a[s],t}function pn(n){let a,s;return{c(){a=d("meta"),this.h()},l(n){a=y(n,"META",{name:!0,content:!0}),this.h()},h(){w(a,"name","keywords"),w(a,"content",s=n[6])},m(n,s){r(n,a,s)},p(n,t){4&t&&s!==(s=n[6])&&w(a,"content",s)},d(n){n&&i(a)}}}function cn(n){let a,s,t=n[6]+"";return{c(){a=d("span"),s=f(t),this.h()},l(n){a=y(n,"SPAN",{class:!0});var e=v(a);s=E(e,t),e.forEach(i),this.h()},h(){w(a,"class","svelte-9tqnza")},m(n,t){r(n,a,t),u(a,s)},p(n,a){4&a&&t!==(t=n[6]+"")&&I(s,t)},d(n){n&&i(a)}}}function ln(n){let a,s,t,e,o,p,h,x,j,A,T,S,L,O,M,C,q,N,R,$,D,H,G,V,z,Y,K,Q,X,an,ln,un,rn,kn,dn,hn,fn,mn,gn,wn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"Article",author:n[3],copyrightHolder:n[3],copyrightYear:"2020",creator:n[3],publisher:n[3],description:n[1],headline:n[0],name:n[0],inLanguage:"en"})}<\/script>`,vn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"BreadcrumbList",description:"Breadcrumbs list",name:"Breadcrumbs",itemListElement:[{"@type":"ListItem",item:{"@id":"https://lihautan.com",name:"Homepage"},position:1},{"@type":"ListItem",item:{"@id":"https%3A%2F%2Flihautan.com%2Fi-wrote-my-module-bundler",name:n[0]},position:2}]})}<\/script>`;document.title=a=n[0]+" | Tan Li Hau";let yn=n[2],En=[];for(let a=0;a<yn.length;a+=1)En[a]=pn(on(n,yn,a));G=new Z({});let bn=n[2],In=[];for(let a=0;a<bn.length;a+=1)In[a]=cn(en(n,bn,a));const xn=n[5].default,Pn=function(n,a,s,t){if(n){const e=c(n,a,s,t);return n[0](e)}}(xn,n,n[4],null);return rn=new nn({}),dn=new sn({}),{c(){s=d("meta"),t=d("meta"),e=d("meta"),o=d("meta"),p=d("meta"),h=d("meta"),x=d("meta"),j=d("meta"),A=d("meta"),T=d("meta"),S=d("meta");for(let n=0;n<En.length;n+=1)En[n].c();L=d("meta"),O=d("meta"),C=g(),N=g(),R=m(),$=d("a"),D=f("Skip to content"),H=m(),J(G.$$.fragment),V=m(),z=d("main"),Y=d("h1"),K=f(n[0]),Q=m();for(let n=0;n<In.length;n+=1)In[n].c();X=m(),an=d("article"),Pn&&Pn.c(),ln=m(),un=d("footer"),J(rn.$$.fragment),kn=m(),J(dn.$$.fragment),hn=m(),mn=g(),this.h()},l(a){const c=function(n,a=document.body){return Array.from(a.querySelectorAll(n))}('[data-svelte="svelte-n0q11s"]',document.head);s=y(c,"META",{name:!0,content:!0}),t=y(c,"META",{name:!0,content:!0}),e=y(c,"META",{name:!0,content:!0}),o=y(c,"META",{name:!0,content:!0}),p=y(c,"META",{name:!0,content:!0}),h=y(c,"META",{name:!0,content:!0}),x=y(c,"META",{name:!0,content:!0}),j=y(c,"META",{name:!0,content:!0}),A=y(c,"META",{name:!0,content:!0}),T=y(c,"META",{name:!0,content:!0}),S=y(c,"META",{name:!0,content:!0});for(let n=0;n<En.length;n+=1)En[n].l(c);L=y(c,"META",{itemprop:!0,content:!0}),O=y(c,"META",{itemprop:!0,content:!0}),C=g(),N=g(),c.forEach(i),R=b(a),$=y(a,"A",{href:!0,class:!0});var l=v($);D=E(l,"Skip to content"),l.forEach(i),H=b(a),U(G.$$.fragment,a),V=b(a),z=y(a,"MAIN",{id:!0,class:!0});var u=v(z);Y=y(u,"H1",{});var r=v(Y);K=E(r,n[0]),r.forEach(i),Q=b(u);for(let n=0;n<In.length;n+=1)In[n].l(u);X=b(u),an=y(u,"ARTICLE",{});var k=v(an);Pn&&Pn.l(k),k.forEach(i),u.forEach(i),ln=b(a),un=y(a,"FOOTER",{class:!0});var d=v(un);U(rn.$$.fragment,d),kn=b(d),U(dn.$$.fragment,d),d.forEach(i),hn=b(a),mn=g(),this.h()},h(){w(s,"name","description"),w(s,"content",n[1]),w(t,"name","image"),w(t,"content",tn),w(e,"name","og:image"),w(e,"content",tn),w(o,"name","og:title"),w(o,"content",n[0]),w(p,"name","og:description"),w(p,"content",n[1]),w(h,"name","og:type"),w(h,"content","website"),w(x,"name","twitter:card"),w(x,"content","summary_large_image"),w(j,"name","twitter:creator"),w(j,"content","@lihautan"),w(A,"name","twitter:title"),w(A,"content",n[0]),w(T,"name","twitter:description"),w(T,"content",n[1]),w(S,"name","twitter:image"),w(S,"content",tn),w(L,"itemprop","url"),w(L,"content","https%3A%2F%2Flihautan.com%2Fi-wrote-my-module-bundler"),w(O,"itemprop","image"),w(O,"content",tn),M=new P(C),q=new P(N),w($,"href","#content"),w($,"class","skip svelte-9tqnza"),w(z,"id","content"),w(z,"class","blog svelte-9tqnza"),w(un,"class","svelte-9tqnza"),fn=new P(mn)},m(n,a){u(document.head,s),u(document.head,t),u(document.head,e),u(document.head,o),u(document.head,p),u(document.head,h),u(document.head,x),u(document.head,j),u(document.head,A),u(document.head,T),u(document.head,S);for(let n=0;n<En.length;n+=1)En[n].m(document.head,null);u(document.head,L),u(document.head,O),M.m(wn,document.head),u(document.head,C),q.m(vn,document.head),u(document.head,N),r(n,R,a),r(n,$,a),u($,D),r(n,H,a),W(G,n,a),r(n,V,a),r(n,z,a),u(z,Y),u(Y,K),u(z,Q);for(let n=0;n<In.length;n+=1)In[n].m(z,null);u(z,X),u(z,an),Pn&&Pn.m(an,null),r(n,ln,a),r(n,un,a),W(rn,un,null),u(un,kn),W(dn,un,null),r(n,hn,a),fn.m('<script async defer src="https://platform.twitter.com/widgets.js" charset="utf-8"><\/script>',n,a),r(n,mn,a),gn=!0},p(n,[t]){if((!gn||1&t)&&a!==(a=n[0]+" | Tan Li Hau")&&(document.title=a),(!gn||2&t)&&w(s,"content",n[1]),(!gn||1&t)&&w(o,"content",n[0]),(!gn||2&t)&&w(p,"content",n[1]),(!gn||1&t)&&w(A,"content",n[0]),(!gn||2&t)&&w(T,"content",n[1]),4&t){let a;for(yn=n[2],a=0;a<yn.length;a+=1){const s=on(n,yn,a);En[a]?En[a].p(s,t):(En[a]=pn(s),En[a].c(),En[a].m(L.parentNode,L))}for(;a<En.length;a+=1)En[a].d(1);En.length=yn.length}if((!gn||3&t)&&wn!==(wn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"Article",author:n[3],copyrightHolder:n[3],copyrightYear:"2020",creator:n[3],publisher:n[3],description:n[1],headline:n[0],name:n[0],inLanguage:"en"})}<\/script>`)&&M.p(wn),(!gn||1&t)&&vn!==(vn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"BreadcrumbList",description:"Breadcrumbs list",name:"Breadcrumbs",itemListElement:[{"@type":"ListItem",item:{"@id":"https://lihautan.com",name:"Homepage"},position:1},{"@type":"ListItem",item:{"@id":"https%3A%2F%2Flihautan.com%2Fi-wrote-my-module-bundler",name:n[0]},position:2}]})}<\/script>`)&&q.p(vn),(!gn||1&t)&&I(K,n[0]),4&t){let a;for(bn=n[2],a=0;a<bn.length;a+=1){const s=en(n,bn,a);In[a]?In[a].p(s,t):(In[a]=cn(s),In[a].c(),In[a].m(z,X))}for(;a<In.length;a+=1)In[a].d(1);In.length=bn.length}Pn&&Pn.p&&16&t&&l(Pn,xn,n,n[4],t,null,null)},i(n){gn||(B(G.$$.fragment,n),B(Pn,n),B(rn.$$.fragment,n),B(dn.$$.fragment,n),gn=!0)},o(n){F(G.$$.fragment,n),F(Pn,n),F(rn.$$.fragment,n),F(dn.$$.fragment,n),gn=!1},d(n){i(s),i(t),i(e),i(o),i(p),i(h),i(x),i(j),i(A),i(T),i(S),k(En,n),i(L),i(O),i(C),n&&M.d(),i(N),n&&q.d(),n&&i(R),n&&i($),n&&i(H),_(G,n),n&&i(V),n&&i(z),k(In,n),Pn&&Pn.d(n),n&&i(ln),n&&i(un),_(rn),_(dn),n&&i(hn),n&&i(mn),n&&fn.d()}}}function un(n,a,s){let{title:t=""}=a,{description:e=""}=a,{tags:o=[]}=a;const p={"@type":"Person",name:"Tan Li Hau"};let{$$slots:c={},$$scope:l}=a;return n.$set=n=>{"title"in n&&s(0,t=n.title),"description"in n&&s(1,e=n.description),"tags"in n&&s(2,o=n.tags),"$$scope"in n&&s(4,l=n.$$scope)},[t,e,o,p,l,c]}class rn extends Y{constructor(n){super(),z(this,n,un,ln,p,{title:0,description:1,tags:2})}}function kn(a){let s,t,e,o,p,c,l,k,h,g,I,x,P,j,A,T,S,L,O,M,C,q,N,R,$,D,H,G,B,F,J,U,W,_,V,z,Y,K,Z,Q,X,nn,an,sn,tn,en,on,pn,cn,ln,un,rn,kn,dn,hn,fn,mn,gn,wn,vn,yn,En,bn,In,xn,Pn,jn,An,Tn,Sn,Ln,On,Mn,Cn,qn,Nn,Rn,$n,Dn,Hn,Gn,Bn,Fn,Jn,Un,Wn,_n,Vn,zn,Yn,Kn,Zn,Qn,Xn,na,aa,sa,ta,ea,oa,pa,ca,la,ua,ra,ia,ka,da,ha,fa,ma,ga,wa,va,ya,Ea,ba,Ia,xa,Pa,ja,Aa,Ta,Sa,La,Oa,Ma,Ca,qa,Na,Ra,$a,Da,Ha,Ga,Ba,Fa,Ja,Ua,Wa,_a,Va,za,Ya,Ka,Za,Qa,Xa,ns,as,ss,ts,es,os,ps,cs,ls,us,rs,is,ks,ds,hs,fs,ms,gs,ws,vs,ys,Es,bs,Is,xs,Ps,js,As,Ts,Ss,Ls,Os,Ms,Cs,qs,Ns,Rs,$s,Ds,Hs,Gs,Bs,Fs,Js,Us,Ws,_s,Vs,zs,Ys,Ks,Zs,Qs,Xs,nt,at,st,tt,et,ot,pt,ct,lt,ut,rt,it,kt,dt,ht,ft,mt,gt,wt,vt,yt,Et,bt,It,xt,Pt,jt,At,Tt,St,Lt,Ot,Mt,Ct,qt,Nt,Rt,$t,Dt,Ht,Gt,Bt,Ft,Jt,Ut,Wt,_t,Vt,zt,Yt,Kt,Zt,Qt,Xt,ne,ae,se,te,ee,oe,pe,ce,le,ue,re,ie,ke,de,he,fe,me,ge,we,ve,ye,Ee,be,Ie,xe,Pe,je,Ae,Te,Se,Le,Oe,Me,Ce,qe,Ne,Re,$e,De,He,Ge,Be,Fe,Je,Ue,We,_e,Ve,ze,Ye,Ke,Ze,Qe,Xe,no,ao,so,to,eo,oo,po,co,lo,uo,ro,io,ko,ho,fo,mo,go,wo,vo,yo,Eo,bo,Io,xo,Po,jo,Ao,To,So,Lo,Oo,Mo,Co,qo,No,Ro,$o,Do,Ho,Go,Bo,Fo,Jo,Uo,Wo,_o,Vo,zo,Yo,Ko,Zo,Qo,Xo,np,ap,sp,tp,ep,op,pp,cp,lp,up,rp,ip,kp,dp,hp,fp,mp,gp,wp,vp,yp,Ep,bp,Ip,xp,Pp,jp,Ap,Tp,Sp,Lp,Op,Mp,Cp,qp,Np,Rp,$p,Dp,Hp,Gp,Bp,Fp,Jp,Up,Wp,_p,Vp,zp,Yp,Kp,Zp,Qp,Xp,nc,ac,sc,tc,ec,oc,pc,cc,lc,uc,rc,ic,kc,dc,hc,fc,mc,gc,wc,vc,yc,Ec,bc,Ic,xc,Pc,jc,Ac,Tc,Sc,Lc,Oc,Mc,Cc,qc,Nc,Rc,$c,Dc,Hc,Gc,Bc,Fc,Jc,Uc,Wc,_c,Vc,zc,Yc,Kc,Zc,Qc,Xc,nl,al,sl,tl,el,ol,pl,cl,ll,ul,rl,il,kl,dl,hl,fl,ml,gl,wl,vl,yl,El,bl,Il,xl,Pl,jl,Al,Tl,Sl,Ll,Ol,Ml,Cl,ql,Nl,Rl,$l,Dl,Hl,Gl,Bl,Fl,Jl,Ul,Wl,_l,Vl,zl,Yl,Kl,Zl,Ql,Xl,nu,au,su,tu,eu,ou,pu,cu,lu,uu,ru,iu,ku,du,hu,fu,mu,gu,wu,vu,yu,Eu,bu,Iu,xu,Pu,ju,Au,Tu,Su,Lu,Ou,Mu,Cu,qu,Nu,Ru,$u,Du,Hu,Gu,Bu,Fu,Ju,Uu,Wu,_u,Vu,zu,Yu,Ku,Zu,Qu,Xu,nr,ar,sr,tr,er,or,pr,cr,lr,ur,rr,ir,kr,dr,hr,fr,mr,gr,wr,vr,yr,Er,br,Ir,xr,Pr,jr,Ar,Tr,Sr,Lr,Or,Mr,Cr,qr,Nr,Rr,$r,Dr,Hr,Gr,Br,Fr,Jr,Ur,Wr,_r,Vr,zr,Yr,Kr,Zr,Qr,Xr,ni,ai,si,ti,ei,oi,pi,ci,li,ui,ri,ii,ki,di,hi,fi,mi,gi,wi,vi,yi,Ei,bi,Ii,xi,Pi,ji,Ai,Ti,Si,Li,Oi,Mi,Ci,qi,Ni,Ri,$i,Di,Hi,Gi,Bi,Fi,Ji,Ui,Wi,_i,Vi,zi,Yi,Ki,Zi,Qi,Xi,nk,ak,sk,tk,ek,ok,pk,ck,lk,uk,rk,ik,kk,dk,hk,fk,mk,gk,wk,vk,yk,Ek,bk,Ik,xk,Pk,jk,Ak,Tk,Sk,Lk,Ok,Mk,Ck,qk,Nk,Rk,$k,Dk,Hk,Gk,Bk,Fk,Jk,Uk,Wk,_k,Vk,zk,Yk,Kk,Zk,Qk,Xk,nd,ad,sd,td,ed,od,pd,cd,ld,ud,rd,id,kd,dd,hd,fd,md,gd,wd,vd,yd,Ed;return{c(){s=d("section"),t=d("ul"),e=d("li"),o=d("a"),p=f("Getting Started"),c=d("ul"),l=d("li"),k=d("a"),h=f("The Input"),g=d("li"),I=d("a"),x=f("Writing"),P=d("li"),j=d("a"),A=f("Resolving"),T=d("li"),S=d("a"),L=f("Bundling"),O=d("ul"),M=d("li"),C=d("a"),q=f("Grouping modules into files"),N=d("li"),R=d("a"),$=f("Creating module map"),D=d("li"),H=d("a"),G=d("li"),B=d("a"),F=f("Optimisation"),J=d("ul"),U=d("li"),W=d("a"),_=f("Circular dependency"),V=d("li"),z=d("a"),Y=f("Summary"),K=d("ul"),Z=d("li"),Q=d("a"),X=f("Whats next?"),nn=d("li"),an=d("a"),sn=f("Further Readings"),tn=m(),en=d("p"),on=f("In my "),pn=d("a"),cn=f("previous article"),ln=f(", I explained how module bundler works. I used "),un=d("a"),rn=f("webpack"),kn=f(" and "),dn=d("a"),hn=f("rollup"),fn=f(" as example, how each of them gave us a different perspective on how we can bundle our JavaScript application."),mn=m(),gn=d("p"),wn=f("In this article, I am going to show you how I wrote my module bundler. The module bundler itself is not production-ready, yet I learned a ton through the exercise, and I am ever more appreciative of what modern module bundlers have provided."),vn=m(),yn=d("hr"),En=m(),bn=d("p"),In=f("‚ö†Ô∏è "),xn=d("strong"),Pn=f("Warning: Tons of JavaScript code ahead. üôàüò±üò®"),jn=f(" ‚ö†Ô∏è"),An=m(),Tn=d("hr"),Sn=m(),Ln=d("section"),On=d("h2"),Mn=d("a"),Cn=f("Getting Started"),qn=m(),Nn=d("p"),Rn=f("I talked about the input (the JavaScript modules) and the output (the bundled JavaScript file) of a module bundler in "),$n=d("a"),Dn=f("my previous article"),Hn=f(". Now it's time to write a module bundler that takes in the input and produces the output."),Gn=m(),Bn=d("p"),Fn=f("A "),Jn=d("em"),Un=f("basic"),Wn=f(" module bundler can be broken down into 2 parts:"),_n=m(),Vn=d("ul"),zn=d("li"),Yn=f("Understands the code and constructs the dependency graph "),Kn=d("strong"),Zn=f("(Dependency Resolution)"),Qn=m(),Xn=d("li"),na=f("Assembles the module into a single (or multiple) JavaScript file "),aa=d("strong"),sa=f("(Bundle)"),ta=m(),ea=d("blockquote"),oa=d("p"),pa=f("A "),ca=d("strong"),la=f("dependency graph"),ua=f(" is a graph representation of the dependency relationship between modules."),ra=m(),ia=d("section"),ka=d("h3"),da=d("a"),ha=f("The Input"),fa=m(),ma=d("p"),ga=f("In this article, I will be using following files as my input to the bundler:"),wa=m(),va=d("pre"),ya=m(),Ea=d("pre"),ba=m(),Ia=d("pre"),xa=m(),Pa=d("p"),ja=f("I've created the project on "),Aa=d("a"),Ta=f("Github"),Sa=f(", so if you are interested to try out yourself, you can clone it and checkout the "),La=d("code"),Oa=f("fixture-1"),Ma=f(" tag. The input files are in the "),Ca=d("code"),qa=f("fixture/"),Na=f(" folder."),Ra=m(),$a=d("section"),Da=d("h2"),Ha=d("a"),Ga=f("Writing"),Ba=m(),Fa=d("p"),Ja=f("I started with the main structure of the module bundler:"),Ua=m(),Wa=d("pre"),_a=m(),Va=d("blockquote"),za=d("p"),Ya=f("The "),Ka=d("strong"),Za=f("dependency graph"),Qa=f(" is a "),Xa=d("a"),ns=f("directed graph"),as=f(", where the vertex is the module, and the directed edge is the dependency relationship between the modules."),ss=m(),ts=d("pre"),es=m(),os=d("p"),ps=f('So, the entry module is "the root" of the graph.'),cs=m(),ls=d("p"),us=f("In "),rs=d("code"),is=f("createModule"),ks=f(", I instantiate a new "),ds=d("code"),hs=f("Module"),fs=f(" instance:"),ms=m(),gs=d("pre"),ws=m(),vs=d("p"),ys=f("The class "),Es=d("code"),bs=f("Module"),Is=f(" will be used to record module properties, such as the content, the dependencies, exported keys, etc."),xs=m(),Ps=d("pre"),js=m(),As=d("p"),Ts=f("While the "),Ss=d("code"),Ls=f("content"),Os=f(" is the string content of the module, to understand what it actually means, I used "),Ms=d("a"),Cs=f("babel"),qs=f(" to "),Ns=d("em"),Rs=f("parse the content"),$s=f(" into AST (Abstract Syntax Tree):"),Ds=m(),Hs=d("pre"),Gs=m(),Bs=d("p"),Fs=f("Next, I need to find out the dependency of this module:"),Js=m(),Us=d("pre"),Ws=m(),_s=d("p"),Vs=f("So, how can I know what are the dependencies of this module?"),zs=m(),Ys=d("p"),Ks=f("I can look for the "),Zs=d("code"),Qs=f("import"),Xs=f(" statement from the AST with the help of the\n"),nt=d("a"),at=f("babel-ast-explorer"),st=f("."),tt=m(),et=d("p"),ot=d("picture"),pt=d("source"),ct=d("source"),lt=d("img"),rt=m(),it=d("p"),kt=f("I found out that the "),dt=d("code"),ht=f("import"),ft=f(" statement in the AST is called the "),mt=d("code"),gt=f("ImportDeclaration"),wt=f(". It has "),vt=d("code"),yt=f("specifiers"),Et=f(" and "),bt=d("code"),It=f("source"),xt=f(", which the "),Pt=d("code"),jt=f("source.value"),At=f(" tells us what this module is importing from:"),Tt=m(),St=d("pre"),Lt=m(),Ot=d("p"),Mt=f("So I had the path that the module is requesting, but it could be relative to the current file, eg "),Ct=d("code"),qt=f('"./foo/bar"'),Nt=f(", or from the "),Rt=d("code"),$t=f("node_modules"),Dt=f(", eg: "),Ht=d("code"),Gt=f('"lodash"'),Bt=f(". How do I know what is the "),Ft=d("strong"),Jt=f("actual file path"),Ut=f(" that the module is requesting?"),Wt=m(),_t=d("p"),Vt=f("The step of figuring out the actual path based on the requested path, is called "),zt=d("strong"),Yt=f('"Resolving"'),Kt=f(":"),Zt=m(),Qt=d("pre"),Xt=m(),ne=d("p"),ae=d("em"),se=f("Resolving path to the actual file path"),te=m(),ee=d("section"),oe=d("h2"),pe=d("a"),ce=f("Resolving"),le=m(),ue=d("p"),re=f('Let\'s talk about resolving. We know that "import"ing '),ie=d("code"),ke=f("./b.js"),de=f(" in the following examples will result in getting a different file, because when we specify "),he=d("code"),fe=f("./"),me=f(', we are "import"ing relative to the current file.'),ge=m(),we=d("pre"),ve=m(),ye=d("pre"),Ee=m(),be=d("p"),Ie=f("So, what are the rules of resolving a module?"),xe=m(),Pe=d("p"),je=f("The Node.js documentation has listed out the "),Ae=d("a"),Te=f("detailed step of the module resolving algorithm"),Se=f(":"),Le=m(),Oe=d("p"),Me=f("When we specify a relative path, "),Ce=d("code"),qe=f("./b"),Ne=f(", Node.js will first assume that "),Re=d("code"),$e=f("./b"),De=f(" is a file, and tries the following extension if it doesn't exactly match the file name:"),He=m(),Ge=d("pre"),Be=m(),Fe=d("p"),Je=f("If the file does not exist, Node.js will then try to treat "),Ue=d("code"),We=f("./b"),_e=f(" as a directory, and try the following:"),Ve=m(),ze=d("pre"),Ye=m(),Ke=d("p"),Ze=f("If we specify "),Qe=d("code"),Xe=f("import 'b'"),no=f(" instead, Node.js will treat it as a package within "),ao=d("code"),so=f("node_modules/"),to=f(", and have a different resolving strategy."),eo=m(),oo=d("p"),po=f("Through the above illustration, we can see that resolving "),co=d("code"),lo=f("import './b'"),uo=f(" is not as simple as it seems. Besides the default Node.js resolving behaviour, "),ro=d("a"),io=f("webpack provides a lot more customisation options"),ko=f(", such as custom extensions, alias, modules folders, etc."),ho=m(),fo=d("p"),mo=f("Here, I am showing you the "),go=d("em"),wo=f('"simplest"'),vo=f(" resolver, which is to resolve relative path only:"),yo=m(),Eo=d("pre"),bo=m(),Io=d("blockquote"),xo=d("small"),Po=f("**Note:** You should try out writing a full node resolvers that resolve relatively as well as absolutely from `node_modules/`"),jo=m(),Ao=d("p"),To=f("Now I know the actual requested file paths, I then create modules out of them."),So=m(),Lo=d("pre"),Oo=m(),Mo=d("p"),Co=f("So, for each module, I find their dependencies, parse them, and find each dependency's dependencies, parse them as well, and find their dependencies, and so forth recursively. At the end of the process, I get a module dependency graph that looks something like this:"),qo=m(),No=d("pre"),Ro=m(),$o=d("p"),Do=f("The root of the graph is our entry module, and you can traverse the graph through the "),Ho=d("code"),Go=f("dependencies"),Bo=f(" of the module. As you can see, the "),Fo=d("code"),Jo=f("index.js"),Uo=f(" has 2 dependencies, the "),Wo=d("code"),_o=f("square.js"),Vo=f(" and the "),zo=d("code"),Yo=f("circle.js"),Ko=f("."),Zo=m(),Qo=d("blockquote"),Xo=d("small"),np=f("**Note:** If you are following along, you can checkout the tag `feat-1-module-dependency-graph`, to see the code that I had written up till this point."),ap=m(),sp=d("section"),tp=d("h2"),ep=d("a"),op=f("Bundling"),pp=m(),cp=d("p"),lp=f("With the module dependency graph, it's time to bundle them into a file!"),up=m(),rp=d("p"),ip=f("At this point in time, we can choose whether we want to bundle it in the "),kp=d("strong"),dp=f('"webpack way"'),hp=f(" or the "),fp=d("strong"),mp=f('"rollup way"'),gp=f(". In this article I am showing you how I did it the "),wp=d("strong"),vp=f('"webpack way"'),yp=f(". I'll write about bundling in the "),Ep=d("strong"),bp=f('"rollup way"'),Ip=f(" in the coming article."),xp=m(),Pp=d("blockquote"),jp=d("p"),Ap=f("If you have no idea about what is the "),Tp=d("strong"),Sp=f('"webpack way"'),Lp=f(" or "),Op=d("strong"),Mp=f('"rollup way"'),Cp=f(', I have "coined" the term in my '),qp=d("a"),Np=f("previous article"),Rp=f(" and have detailed explanation about them!"),$p=m(),Dp=d("p"),Hp=f("Let's take a look how the final bundled file would look like:"),Gp=m(),Bp=d("pre"),Fp=m(),Jp=d("p"),Up=f("Let's break it down to a few steps:"),Wp=m(),_p=d("ul"),Vp=d("li"),zp=d("strong"),Yp=f("Group modules into files"),Kp=m(),Zp=d("li"),Qp=d("strong"),Xp=f("Create the module map"),nc=f(' and wrapping each module in a "special" module factory function'),ac=m(),sc=d("li"),tc=d("strong"),ec=f('Create the "runtime"'),oc=f(", the glue that links each module together."),pc=m(),cc=d("section"),lc=d("h3"),uc=d("a"),rc=f("Grouping modules into files"),ic=m(),kc=d("p"),dc=f("This step is to decide which modules goes to which file. We can split modules into different files because of "),hc=d("a"),fc=f("code splitting"),mc=f(" due to dynamic import as well as optimisation, such as the webpack's "),gc=d("a"),wc=f("Chunk Splitting"),vc=f("."),yc=m(),Ec=d("p"),bc=f("I will support code splitting in the future. For now, I grouped all modules into 1 file."),Ic=m(),xc=d("p"),Pc=f("To collect all the modules from module graph into a list of modules, I did a graph traversal:"),jc=m(),Ac=d("pre"),Tc=m(),Sc=d("p"),Lc=f("...and I used the list of modules to create a module map."),Oc=m(),Mc=d("section"),Cc=d("h3"),qc=d("a"),Nc=f("Creating module map"),Rc=m(),$c=d("p"),Dc=f("The module map I created is a string, that would be inlined into the final bundle file."),Hc=m(),Gc=d("p"),Bc=f("I looped through each module, and used "),Fc=d("code"),Jc=f("module.filePath"),Uc=f(" as the key, and "),Wc=d("code"),_c=f("module.content"),Vc=f(" as the value."),zc=m(),Yc=d("p"),Kc=f("The reason I dont use "),Zc=d("code"),Qc=f("JSON.stringify(moduleMap)"),Xc=f(" instead of manually concatenating to build up the module map, is because JSON can only takes in "),nl=d("a"),al=f("JSON primitive data type"),sl=f(" as value, but what I built here is a JavaScript map, with "),tl=d("code"),el=f("function"),ol=f(" as value, but in string."),pl=m(),cl=d("pre"),ll=m(),ul=d("p"),rl=f("The function that wraps around the "),il=d("code"),kl=f("module.content"),dl=f(" is called the module factory function. It provides 2 parameter to the module:"),hl=m(),fl=d("ul"),ml=d("li"),gl=d("code"),wl=f("exports"),vl=f(", an object that the module can assign its exported value onto"),yl=m(),El=d("li"),bl=d("code"),Il=f("require"),xl=f(", a function that the module can invoke with module path to import exported value from another module"),Pl=m(),jl=d("p"),Al=f("The module map right now is not something that can be executed:"),Tl=m(),Sl=d("pre"),Ll=m(),Ol=d("p"),Ml=f("because it still uses "),Cl=d("code"),ql=f("import"),Nl=f(" and "),Rl=d("code"),$l=f("export"),Dl=f(". I had to transform them to use the "),Hl=d("code"),Gl=f("exports"),Bl=f(" and "),Fl=d("code"),Jl=f("require"),Ul=f(" that we pass in."),Wl=m(),_l=d("p"),Vl=f("To transform the code, I used the AST of the module again: trasform the ast and generate the new code from the transformed ast."),zl=m(),Yl=d("p"),Kl=f('What I need is to trasform the "from" to "to" of the following:'),Zl=m(),Ql=d("pre"),Xl=m(),nu=d("blockquote"),au=d("p"),su=f("I wrote a "),tu=d("a"),eu=f("step by step guide"),ou=f(" on how to write babel transformation, please do check it out."),pu=m(),cu=d("p"),lu=f("Knowing "),uu=d("strong"),ru=f("what to target on AST"),iu=f(" and "),ku=d("strong"),du=f("how the transformed AST look like"),hu=f(", I wrote my transformation code:"),fu=m(),mu=d("pre"),gu=m(),wu=d("p"),vu=f("I omitted the actual babel transformation code, because it is lengthy. If you are interested to read about it, you can check out "),yu=d("a"),Eu=f("from my Github repo"),bu=m(),Iu=d("p"),xu=f("So, now the module map looks ready:"),Pu=m(),ju=d("pre"),Au=m(),Tu=d("p"),Su=f("One thing to take note is that, for the "),Lu=d("code"),Ou=f("require"),Mu=f(" statements, I replaced the requested path to the actual resolved path, because I used the actual resolved path as the key to the module map."),Cu=m(),qu=d("section"),Nu=d("h3"),Ru=d("a"),$u=d("strong"),Du=f('Create the "runtime"'),Hu=m(),Gu=d("p"),Bu=f("Now it's time to create the runtime. The runtime is a piece of code that is part of the output bundle, that runs when the application code is running, therefore, the runtime."),Fu=m(),Ju=d("p"),Uu=f("The runtime code can be from a template file, but for simplicity sake, I kept the runtime code as a string:"),Wu=m(),_u=d("pre"),Vu=m(),zu=d("p"),Yu=f("The code above is self explanatory, except if you have no idea what does the "),Ku=d("code"),Zu=f("webpackStart()"),Qu=f(" do, you can read more about it in "),Xu=d("a"),nr=f("my previous post"),ar=f("."),sr=m(),tr=d("p"),er=f("Finally, I returned the module code from the "),or=d("code"),pr=f("bundle"),cr=f(" function:"),lr=m(),ur=d("pre"),rr=m(),ir=d("p"),kr=f("Now I run my bundler, it generates a "),dr=d("code"),hr=f("output/bundle.js"),fr=f(" file. I run the generated file with node and I see:"),mr=m(),gr=d("pre"),wr=m(),vr=d("p"),yr=f("That's it! A working module bundler!"),Er=m(),br=d("p"),Ir=f("Of course, the module bundler I've shown here is "),xr=d("strong"),Pr=f("nowhere near webpack"),jr=f(". Webpack supports more module system, resolving strategies, loading strategies, plugin system, optimisation, and many many more."),Ar=m(),Tr=d("section"),Sr=d("h2"),Lr=d("a"),Or=f("Optimisation"),Mr=m(),Cr=d("p"),qr=f("I played around my module bundler, and I quickly noticed a bug: "),Nr=d("strong"),Rr=f("Circular Dependency"),$r=f("."),Dr=m(),Hr=d("p"),Gr=f("Here's my input files that I've tweaked:"),Br=m(),Fr=d("pre"),Jr=m(),Ur=d("pre"),Wr=m(),_r=d("p"),Vr=f("When I ran it through my module bunlder, immediately it ran into a stack overflow:"),zr=m(),Yr=d("pre"),Kr=m(),Zr=d("section"),Qr=d("h3"),Xr=d("a"),ni=f("Circular dependency"),ai=m(),si=d("p"),ti=f("There were 2 junctures that the code did recursive traversal which have led to the endless loop:"),ei=m(),oi=d("ul"),pi=d("li"),ci=f("Generating dependency graphs"),li=m(),ui=d("li"),ri=f("Traversing module graph for bundling"),ii=m(),ki=d("pre"),di=m(),hi=d("p"),fi=f("Bundle with the latest code, the stack overflow is gone. However when I executed the output bundle, I saw"),mi=m(),gi=d("pre"),wi=m(),vi=d("p"),yi=f("So I took a look at the output bundle:"),Ei=m(),bi=d("pre"),Ii=m(),xi=d("p"),Pi=f("So, the problem is that I destructed "),ji=d("code"),Ai=f("PI"),Ti=f(" from the exports of "),Si=d("code"),Li=f("index.js"),Oi=f(" before it is defined, so naturally "),Mi=d("code"),Ci=f("PI"),qi=f(" within "),Ni=d("code"),Ri=f("circle.js"),$i=f(" would stay as "),Di=d("code"),Hi=f("undefined"),Gi=f(" throughout the application. However before I called "),Bi=d("code"),Fi=f("circleArea"),Ji=f(", we defined "),Ui=d("code"),Wi=f("PI"),_i=f(" on the "),Vi=d("code"),zi=f("index.js"),Yi=f("'s export, I am expecting it to be available."),Ki=m(),Zi=d("p"),Qi=f("So I built my application with webpack and took a look at how webpack solved this problem."),Xi=m(),nk=d("pre"),ak=m(),sk=d("p"),tk=f("Brilliant! The key is to lazily get the value of "),ek=d("code"),ok=f("PI"),pk=f(" when needed!"),ck=m(),lk=d("p"),uk=f("I changed my babel transformation code, which I am not showing it here. If you are curious enough, you can check out "),rk=d("a"),ik=f("the changes I made from Github"),kk=f("."),dk=m(),hk=d("section"),fk=d("h2"),mk=d("a"),gk=f("Summary"),wk=m(),vk=d("p"),yk=f("There's two phases in module bundling: "),Ek=d("strong"),bk=f("Dependency Resolution"),Ik=f(" and "),xk=d("strong"),Pk=f("Bundling"),jk=f("."),Ak=m(),Tk=d("p"),Sk=f("I showed you how I constructed the dependency graph, by finding import statements and resolving modules. I shared how I created module maps and transformed the imports / exports syntax during "),Lk=d("strong"),Ok=f("bundling"),Mk=f(". Lastly, I fixed the circular dependency bug that was in the first version of my module bundler."),Ck=m(),qk=d("section"),Nk=d("h3"),Rk=d("a"),$k=f("Whats next?"),Dk=m(),Hk=d("p"),Gk=f("I have a few ideas that I will add to my module bundler, such as:"),Bk=m(),Fk=d("ul"),Jk=d("li"),Uk=f("code spliting"),Wk=m(),_k=d("li"),Vk=f("watch mode and reloading"),zk=m(),Yk=d("p"),Kk=f("which I will cover them in my next article when they are ready."),Zk=m(),Qk=d("p"),Xk=f("Till then. Cheers. üòé"),nd=m(),ad=d("section"),sd=d("h2"),td=d("a"),ed=f("Further Readings"),od=m(),pd=d("ul"),cd=d("li"),ld=d("a"),ud=f("Ronen Amiel, Build Your Own Webpack - You Gotta Love Frontend 2018"),rd=m(),id=d("li"),kd=d("a"),dd=f("Luciano Mammino, Unbundling the JavaScript module bundler - DublinJS July 2018"),hd=m(),fd=d("li"),md=d("a"),gd=f("Adam Kelly, Let‚Äôs learn how module bundlers work and then write one ourselves"),wd=m(),vd=d("li"),yd=d("a"),Ed=f("Webpack founder Tobias Koppers demos bundling live by hand"),this.h()},l(n){s=y(n,"SECTION",{});var a=v(s);t=y(a,"UL",{class:!0,id:!0,role:!0,"aria-label":!0});var u=v(t);e=y(u,"LI",{});var r=v(e);o=y(r,"A",{href:!0});var d=v(o);p=E(d,"Getting Started"),d.forEach(i),r.forEach(i),c=y(u,"UL",{});var f=v(c);l=y(f,"LI",{});var m=v(l);k=y(m,"A",{href:!0});var w=v(k);h=E(w,"The Input"),w.forEach(i),m.forEach(i),f.forEach(i),g=y(u,"LI",{});var ut=v(g);I=y(ut,"A",{href:!0});var bd=v(I);x=E(bd,"Writing"),bd.forEach(i),ut.forEach(i),P=y(u,"LI",{});var Id=v(P);j=y(Id,"A",{href:!0});var xd=v(j);A=E(xd,"Resolving"),xd.forEach(i),Id.forEach(i),T=y(u,"LI",{});var Pd=v(T);S=y(Pd,"A",{href:!0});var jd=v(S);L=E(jd,"Bundling"),jd.forEach(i),Pd.forEach(i),O=y(u,"UL",{});var Ad=v(O);M=y(Ad,"LI",{});var Td=v(M);C=y(Td,"A",{href:!0});var Sd=v(C);q=E(Sd,"Grouping modules into files"),Sd.forEach(i),Td.forEach(i),N=y(Ad,"LI",{});var Ld=v(N);R=y(Ld,"A",{href:!0});var Od=v(R);$=E(Od,"Creating module map"),Od.forEach(i),Ld.forEach(i),D=y(Ad,"LI",{});var Md=v(D);H=y(Md,"A",{href:!0}),v(H).forEach(i),Md.forEach(i),Ad.forEach(i),G=y(u,"LI",{});var Cd=v(G);B=y(Cd,"A",{href:!0});var qd=v(B);F=E(qd,"Optimisation"),qd.forEach(i),Cd.forEach(i),J=y(u,"UL",{});var Nd=v(J);U=y(Nd,"LI",{});var Rd=v(U);W=y(Rd,"A",{href:!0});var $d=v(W);_=E($d,"Circular dependency"),$d.forEach(i),Rd.forEach(i),Nd.forEach(i),V=y(u,"LI",{});var Dd=v(V);z=y(Dd,"A",{href:!0});var Hd=v(z);Y=E(Hd,"Summary"),Hd.forEach(i),Dd.forEach(i),K=y(u,"UL",{});var Gd=v(K);Z=y(Gd,"LI",{});var Bd=v(Z);Q=y(Bd,"A",{href:!0});var Fd=v(Q);X=E(Fd,"Whats next?"),Fd.forEach(i),Bd.forEach(i),Gd.forEach(i),nn=y(u,"LI",{});var Jd=v(nn);an=y(Jd,"A",{href:!0});var Ud=v(an);sn=E(Ud,"Further Readings"),Ud.forEach(i),Jd.forEach(i),u.forEach(i),a.forEach(i),tn=b(n),en=y(n,"P",{});var Wd=v(en);on=E(Wd,"In my "),pn=y(Wd,"A",{href:!0});var _d=v(pn);cn=E(_d,"previous article"),_d.forEach(i),ln=E(Wd,", I explained how module bundler works. I used "),un=y(Wd,"A",{href:!0,rel:!0});var Vd=v(un);rn=E(Vd,"webpack"),Vd.forEach(i),kn=E(Wd," and "),dn=y(Wd,"A",{href:!0,rel:!0});var zd=v(dn);hn=E(zd,"rollup"),zd.forEach(i),fn=E(Wd," as example, how each of them gave us a different perspective on how we can bundle our JavaScript application."),Wd.forEach(i),mn=b(n),gn=y(n,"P",{});var Yd=v(gn);wn=E(Yd,"In this article, I am going to show you how I wrote my module bundler. The module bundler itself is not production-ready, yet I learned a ton through the exercise, and I am ever more appreciative of what modern module bundlers have provided."),Yd.forEach(i),vn=b(n),yn=y(n,"HR",{}),En=b(n),bn=y(n,"P",{});var Kd=v(bn);In=E(Kd,"‚ö†Ô∏è "),xn=y(Kd,"STRONG",{});var Zd=v(xn);Pn=E(Zd,"Warning: Tons of JavaScript code ahead. üôàüò±üò®"),Zd.forEach(i),jn=E(Kd," ‚ö†Ô∏è"),Kd.forEach(i),An=b(n),Tn=y(n,"HR",{}),Sn=b(n),Ln=y(n,"SECTION",{});var Qd=v(Ln);On=y(Qd,"H2",{});var Xd=v(On);Mn=y(Xd,"A",{href:!0,id:!0});var nh=v(Mn);Cn=E(nh,"Getting Started"),nh.forEach(i),Xd.forEach(i),qn=b(Qd),Nn=y(Qd,"P",{});var ah=v(Nn);Rn=E(ah,"I talked about the input (the JavaScript modules) and the output (the bundled JavaScript file) of a module bundler in "),$n=y(ah,"A",{href:!0});var sh=v($n);Dn=E(sh,"my previous article"),sh.forEach(i),Hn=E(ah,". Now it's time to write a module bundler that takes in the input and produces the output."),ah.forEach(i),Gn=b(Qd),Bn=y(Qd,"P",{});var th=v(Bn);Fn=E(th,"A "),Jn=y(th,"EM",{});var eh=v(Jn);Un=E(eh,"basic"),eh.forEach(i),Wn=E(th," module bundler can be broken down into 2 parts:"),th.forEach(i),_n=b(Qd),Vn=y(Qd,"UL",{});var oh=v(Vn);zn=y(oh,"LI",{});var ph=v(zn);Yn=E(ph,"Understands the code and constructs the dependency graph "),Kn=y(ph,"STRONG",{});var ch=v(Kn);Zn=E(ch,"(Dependency Resolution)"),ch.forEach(i),ph.forEach(i),Qn=b(oh),Xn=y(oh,"LI",{});var lh=v(Xn);na=E(lh,"Assembles the module into a single (or multiple) JavaScript file "),aa=y(lh,"STRONG",{});var uh=v(aa);sa=E(uh,"(Bundle)"),uh.forEach(i),lh.forEach(i),oh.forEach(i),ta=b(Qd),ea=y(Qd,"BLOCKQUOTE",{});var rh=v(ea);oa=y(rh,"P",{});var ih=v(oa);pa=E(ih,"A "),ca=y(ih,"STRONG",{});var kh=v(ca);la=E(kh,"dependency graph"),kh.forEach(i),ua=E(ih," is a graph representation of the dependency relationship between modules."),ih.forEach(i),rh.forEach(i),Qd.forEach(i),ra=b(n),ia=y(n,"SECTION",{});var dh=v(ia);ka=y(dh,"H3",{});var hh=v(ka);da=y(hh,"A",{href:!0,id:!0});var fh=v(da);ha=E(fh,"The Input"),fh.forEach(i),hh.forEach(i),fa=b(dh),ma=y(dh,"P",{});var mh=v(ma);ga=E(mh,"In this article, I will be using following files as my input to the bundler:"),mh.forEach(i),wa=b(dh),va=y(dh,"PRE",{class:!0}),v(va).forEach(i),ya=b(dh),Ea=y(dh,"PRE",{class:!0}),v(Ea).forEach(i),ba=b(dh),Ia=y(dh,"PRE",{class:!0}),v(Ia).forEach(i),xa=b(dh),Pa=y(dh,"P",{});var gh=v(Pa);ja=E(gh,"I've created the project on "),Aa=y(gh,"A",{href:!0,rel:!0});var wh=v(Aa);Ta=E(wh,"Github"),wh.forEach(i),Sa=E(gh,", so if you are interested to try out yourself, you can clone it and checkout the "),La=y(gh,"CODE",{});var vh=v(La);Oa=E(vh,"fixture-1"),vh.forEach(i),Ma=E(gh," tag. The input files are in the "),Ca=y(gh,"CODE",{});var yh=v(Ca);qa=E(yh,"fixture/"),yh.forEach(i),Na=E(gh," folder."),gh.forEach(i),dh.forEach(i),Ra=b(n),$a=y(n,"SECTION",{});var Eh=v($a);Da=y(Eh,"H2",{});var bh=v(Da);Ha=y(bh,"A",{href:!0,id:!0});var Ih=v(Ha);Ga=E(Ih,"Writing"),Ih.forEach(i),bh.forEach(i),Ba=b(Eh),Fa=y(Eh,"P",{});var xh=v(Fa);Ja=E(xh,"I started with the main structure of the module bundler:"),xh.forEach(i),Ua=b(Eh),Wa=y(Eh,"PRE",{class:!0}),v(Wa).forEach(i),_a=b(Eh),Va=y(Eh,"BLOCKQUOTE",{});var Ph=v(Va);za=y(Ph,"P",{});var jh=v(za);Ya=E(jh,"The "),Ka=y(jh,"STRONG",{});var Ah=v(Ka);Za=E(Ah,"dependency graph"),Ah.forEach(i),Qa=E(jh," is a "),Xa=y(jh,"A",{href:!0,rel:!0});var Th=v(Xa);ns=E(Th,"directed graph"),Th.forEach(i),as=E(jh,", where the vertex is the module, and the directed edge is the dependency relationship between the modules."),jh.forEach(i),Ph.forEach(i),ss=b(Eh),ts=y(Eh,"PRE",{class:!0}),v(ts).forEach(i),es=b(Eh),os=y(Eh,"P",{});var Sh=v(os);ps=E(Sh,'So, the entry module is "the root" of the graph.'),Sh.forEach(i),cs=b(Eh),ls=y(Eh,"P",{});var Lh=v(ls);us=E(Lh,"In "),rs=y(Lh,"CODE",{});var Oh=v(rs);is=E(Oh,"createModule"),Oh.forEach(i),ks=E(Lh,", I instantiate a new "),ds=y(Lh,"CODE",{});var Mh=v(ds);hs=E(Mh,"Module"),Mh.forEach(i),fs=E(Lh," instance:"),Lh.forEach(i),ms=b(Eh),gs=y(Eh,"PRE",{class:!0}),v(gs).forEach(i),ws=b(Eh),vs=y(Eh,"P",{});var Ch=v(vs);ys=E(Ch,"The class "),Es=y(Ch,"CODE",{});var qh=v(Es);bs=E(qh,"Module"),qh.forEach(i),Is=E(Ch," will be used to record module properties, such as the content, the dependencies, exported keys, etc."),Ch.forEach(i),xs=b(Eh),Ps=y(Eh,"PRE",{class:!0}),v(Ps).forEach(i),js=b(Eh),As=y(Eh,"P",{});var Nh=v(As);Ts=E(Nh,"While the "),Ss=y(Nh,"CODE",{});var Rh=v(Ss);Ls=E(Rh,"content"),Rh.forEach(i),Os=E(Nh," is the string content of the module, to understand what it actually means, I used "),Ms=y(Nh,"A",{href:!0,rel:!0});var $h=v(Ms);Cs=E($h,"babel"),$h.forEach(i),qs=E(Nh," to "),Ns=y(Nh,"EM",{});var Dh=v(Ns);Rs=E(Dh,"parse the content"),Dh.forEach(i),$s=E(Nh," into AST (Abstract Syntax Tree):"),Nh.forEach(i),Ds=b(Eh),Hs=y(Eh,"PRE",{class:!0}),v(Hs).forEach(i),Gs=b(Eh),Bs=y(Eh,"P",{});var Hh=v(Bs);Fs=E(Hh,"Next, I need to find out the dependency of this module:"),Hh.forEach(i),Js=b(Eh),Us=y(Eh,"PRE",{class:!0}),v(Us).forEach(i),Ws=b(Eh),_s=y(Eh,"P",{});var Gh=v(_s);Vs=E(Gh,"So, how can I know what are the dependencies of this module?"),Gh.forEach(i),zs=b(Eh),Ys=y(Eh,"P",{});var Bh=v(Ys);Ks=E(Bh,"I can look for the "),Zs=y(Bh,"CODE",{});var Fh=v(Zs);Qs=E(Fh,"import"),Fh.forEach(i),Xs=E(Bh," statement from the AST with the help of the\n"),nt=y(Bh,"A",{href:!0,rel:!0});var Jh=v(nt);at=E(Jh,"babel-ast-explorer"),Jh.forEach(i),st=E(Bh,"."),Bh.forEach(i),tt=b(Eh),et=y(Eh,"P",{});var Uh=v(et);ot=y(Uh,"PICTURE",{});var Wh=v(ot);pt=y(Wh,"SOURCE",{type:!0,srcset:!0}),ct=y(Wh,"SOURCE",{type:!0,srcset:!0}),lt=y(Wh,"IMG",{alt:!0,src:!0}),Wh.forEach(i),Uh.forEach(i),rt=b(Eh),it=y(Eh,"P",{});var _h=v(it);kt=E(_h,"I found out that the "),dt=y(_h,"CODE",{});var Vh=v(dt);ht=E(Vh,"import"),Vh.forEach(i),ft=E(_h," statement in the AST is called the "),mt=y(_h,"CODE",{});var zh=v(mt);gt=E(zh,"ImportDeclaration"),zh.forEach(i),wt=E(_h,". It has "),vt=y(_h,"CODE",{});var Yh=v(vt);yt=E(Yh,"specifiers"),Yh.forEach(i),Et=E(_h," and "),bt=y(_h,"CODE",{});var Kh=v(bt);It=E(Kh,"source"),Kh.forEach(i),xt=E(_h,", which the "),Pt=y(_h,"CODE",{});var Zh=v(Pt);jt=E(Zh,"source.value"),Zh.forEach(i),At=E(_h," tells us what this module is importing from:"),_h.forEach(i),Tt=b(Eh),St=y(Eh,"PRE",{class:!0}),v(St).forEach(i),Lt=b(Eh),Ot=y(Eh,"P",{});var Qh=v(Ot);Mt=E(Qh,"So I had the path that the module is requesting, but it could be relative to the current file, eg "),Ct=y(Qh,"CODE",{});var Xh=v(Ct);qt=E(Xh,'"./foo/bar"'),Xh.forEach(i),Nt=E(Qh,", or from the "),Rt=y(Qh,"CODE",{});var nf=v(Rt);$t=E(nf,"node_modules"),nf.forEach(i),Dt=E(Qh,", eg: "),Ht=y(Qh,"CODE",{});var af=v(Ht);Gt=E(af,'"lodash"'),af.forEach(i),Bt=E(Qh,". How do I know what is the "),Ft=y(Qh,"STRONG",{});var sf=v(Ft);Jt=E(sf,"actual file path"),sf.forEach(i),Ut=E(Qh," that the module is requesting?"),Qh.forEach(i),Wt=b(Eh),_t=y(Eh,"P",{});var tf=v(_t);Vt=E(tf,"The step of figuring out the actual path based on the requested path, is called "),zt=y(tf,"STRONG",{});var ef=v(zt);Yt=E(ef,'"Resolving"'),ef.forEach(i),Kt=E(tf,":"),tf.forEach(i),Zt=b(Eh),Qt=y(Eh,"PRE",{class:!0}),v(Qt).forEach(i),Xt=b(Eh),ne=y(Eh,"P",{});var of=v(ne);ae=y(of,"EM",{});var pf=v(ae);se=E(pf,"Resolving path to the actual file path"),pf.forEach(i),of.forEach(i),Eh.forEach(i),te=b(n),ee=y(n,"SECTION",{});var cf=v(ee);oe=y(cf,"H2",{});var lf=v(oe);pe=y(lf,"A",{href:!0,id:!0});var uf=v(pe);ce=E(uf,"Resolving"),uf.forEach(i),lf.forEach(i),le=b(cf),ue=y(cf,"P",{});var rf=v(ue);re=E(rf,'Let\'s talk about resolving. We know that "import"ing '),ie=y(rf,"CODE",{});var kf=v(ie);ke=E(kf,"./b.js"),kf.forEach(i),de=E(rf," in the following examples will result in getting a different file, because when we specify "),he=y(rf,"CODE",{});var df=v(he);fe=E(df,"./"),df.forEach(i),me=E(rf,', we are "import"ing relative to the current file.'),rf.forEach(i),ge=b(cf),we=y(cf,"PRE",{class:!0}),v(we).forEach(i),ve=b(cf),ye=y(cf,"PRE",{class:!0}),v(ye).forEach(i),Ee=b(cf),be=y(cf,"P",{});var hf=v(be);Ie=E(hf,"So, what are the rules of resolving a module?"),hf.forEach(i),xe=b(cf),Pe=y(cf,"P",{});var ff=v(Pe);je=E(ff,"The Node.js documentation has listed out the "),Ae=y(ff,"A",{href:!0,rel:!0});var mf=v(Ae);Te=E(mf,"detailed step of the module resolving algorithm"),mf.forEach(i),Se=E(ff,":"),ff.forEach(i),Le=b(cf),Oe=y(cf,"P",{});var gf=v(Oe);Me=E(gf,"When we specify a relative path, "),Ce=y(gf,"CODE",{});var wf=v(Ce);qe=E(wf,"./b"),wf.forEach(i),Ne=E(gf,", Node.js will first assume that "),Re=y(gf,"CODE",{});var vf=v(Re);$e=E(vf,"./b"),vf.forEach(i),De=E(gf," is a file, and tries the following extension if it doesn't exactly match the file name:"),gf.forEach(i),He=b(cf),Ge=y(cf,"PRE",{class:!0}),v(Ge).forEach(i),Be=b(cf),Fe=y(cf,"P",{});var yf=v(Fe);Je=E(yf,"If the file does not exist, Node.js will then try to treat "),Ue=y(yf,"CODE",{});var Ef=v(Ue);We=E(Ef,"./b"),Ef.forEach(i),_e=E(yf," as a directory, and try the following:"),yf.forEach(i),Ve=b(cf),ze=y(cf,"PRE",{class:!0}),v(ze).forEach(i),Ye=b(cf),Ke=y(cf,"P",{});var bf=v(Ke);Ze=E(bf,"If we specify "),Qe=y(bf,"CODE",{});var If=v(Qe);Xe=E(If,"import 'b'"),If.forEach(i),no=E(bf," instead, Node.js will treat it as a package within "),ao=y(bf,"CODE",{});var xf=v(ao);so=E(xf,"node_modules/"),xf.forEach(i),to=E(bf,", and have a different resolving strategy."),bf.forEach(i),eo=b(cf),oo=y(cf,"P",{});var Pf=v(oo);po=E(Pf,"Through the above illustration, we can see that resolving "),co=y(Pf,"CODE",{});var jf=v(co);lo=E(jf,"import './b'"),jf.forEach(i),uo=E(Pf," is not as simple as it seems. Besides the default Node.js resolving behaviour, "),ro=y(Pf,"A",{href:!0,rel:!0});var Af=v(ro);io=E(Af,"webpack provides a lot more customisation options"),Af.forEach(i),ko=E(Pf,", such as custom extensions, alias, modules folders, etc."),Pf.forEach(i),ho=b(cf),fo=y(cf,"P",{});var Tf=v(fo);mo=E(Tf,"Here, I am showing you the "),go=y(Tf,"EM",{});var Sf=v(go);wo=E(Sf,'"simplest"'),Sf.forEach(i),vo=E(Tf," resolver, which is to resolve relative path only:"),Tf.forEach(i),yo=b(cf),Eo=y(cf,"PRE",{class:!0}),v(Eo).forEach(i),bo=b(cf),Io=y(cf,"BLOCKQUOTE",{});var Lf=v(Io);xo=y(Lf,"SMALL",{});var Of=v(xo);Po=E(Of,"**Note:** You should try out writing a full node resolvers that resolve relatively as well as absolutely from `node_modules/`"),Of.forEach(i),Lf.forEach(i),jo=b(cf),Ao=y(cf,"P",{});var Mf=v(Ao);To=E(Mf,"Now I know the actual requested file paths, I then create modules out of them."),Mf.forEach(i),So=b(cf),Lo=y(cf,"PRE",{class:!0}),v(Lo).forEach(i),Oo=b(cf),Mo=y(cf,"P",{});var Cf=v(Mo);Co=E(Cf,"So, for each module, I find their dependencies, parse them, and find each dependency's dependencies, parse them as well, and find their dependencies, and so forth recursively. At the end of the process, I get a module dependency graph that looks something like this:"),Cf.forEach(i),qo=b(cf),No=y(cf,"PRE",{class:!0}),v(No).forEach(i),Ro=b(cf),$o=y(cf,"P",{});var qf=v($o);Do=E(qf,"The root of the graph is our entry module, and you can traverse the graph through the "),Ho=y(qf,"CODE",{});var Nf=v(Ho);Go=E(Nf,"dependencies"),Nf.forEach(i),Bo=E(qf," of the module. As you can see, the "),Fo=y(qf,"CODE",{});var Rf=v(Fo);Jo=E(Rf,"index.js"),Rf.forEach(i),Uo=E(qf," has 2 dependencies, the "),Wo=y(qf,"CODE",{});var $f=v(Wo);_o=E($f,"square.js"),$f.forEach(i),Vo=E(qf," and the "),zo=y(qf,"CODE",{});var Df=v(zo);Yo=E(Df,"circle.js"),Df.forEach(i),Ko=E(qf,"."),qf.forEach(i),Zo=b(cf),Qo=y(cf,"BLOCKQUOTE",{});var Hf=v(Qo);Xo=y(Hf,"SMALL",{});var Gf=v(Xo);np=E(Gf,"**Note:** If you are following along, you can checkout the tag `feat-1-module-dependency-graph`, to see the code that I had written up till this point."),Gf.forEach(i),Hf.forEach(i),cf.forEach(i),ap=b(n),sp=y(n,"SECTION",{});var Bf=v(sp);tp=y(Bf,"H2",{});var Ff=v(tp);ep=y(Ff,"A",{href:!0,id:!0});var Jf=v(ep);op=E(Jf,"Bundling"),Jf.forEach(i),Ff.forEach(i),pp=b(Bf),cp=y(Bf,"P",{});var Uf=v(cp);lp=E(Uf,"With the module dependency graph, it's time to bundle them into a file!"),Uf.forEach(i),up=b(Bf),rp=y(Bf,"P",{});var Wf=v(rp);ip=E(Wf,"At this point in time, we can choose whether we want to bundle it in the "),kp=y(Wf,"STRONG",{});var _f=v(kp);dp=E(_f,'"webpack way"'),_f.forEach(i),hp=E(Wf," or the "),fp=y(Wf,"STRONG",{});var Vf=v(fp);mp=E(Vf,'"rollup way"'),Vf.forEach(i),gp=E(Wf,". In this article I am showing you how I did it the "),wp=y(Wf,"STRONG",{});var zf=v(wp);vp=E(zf,'"webpack way"'),zf.forEach(i),yp=E(Wf,". I'll write about bundling in the "),Ep=y(Wf,"STRONG",{});var Yf=v(Ep);bp=E(Yf,'"rollup way"'),Yf.forEach(i),Ip=E(Wf," in the coming article."),Wf.forEach(i),xp=b(Bf),Pp=y(Bf,"BLOCKQUOTE",{});var Kf=v(Pp);jp=y(Kf,"P",{});var Zf=v(jp);Ap=E(Zf,"If you have no idea about what is the "),Tp=y(Zf,"STRONG",{});var Qf=v(Tp);Sp=E(Qf,'"webpack way"'),Qf.forEach(i),Lp=E(Zf," or "),Op=y(Zf,"STRONG",{});var Xf=v(Op);Mp=E(Xf,'"rollup way"'),Xf.forEach(i),Cp=E(Zf,', I have "coined" the term in my '),qp=y(Zf,"A",{href:!0});var nm=v(qp);Np=E(nm,"previous article"),nm.forEach(i),Rp=E(Zf," and have detailed explanation about them!"),Zf.forEach(i),Kf.forEach(i),$p=b(Bf),Dp=y(Bf,"P",{});var am=v(Dp);Hp=E(am,"Let's take a look how the final bundled file would look like:"),am.forEach(i),Gp=b(Bf),Bp=y(Bf,"PRE",{class:!0}),v(Bp).forEach(i),Fp=b(Bf),Jp=y(Bf,"P",{});var sm=v(Jp);Up=E(sm,"Let's break it down to a few steps:"),sm.forEach(i),Wp=b(Bf),_p=y(Bf,"UL",{});var tm=v(_p);Vp=y(tm,"LI",{});var em=v(Vp);zp=y(em,"STRONG",{});var om=v(zp);Yp=E(om,"Group modules into files"),om.forEach(i),em.forEach(i),Kp=b(tm),Zp=y(tm,"LI",{});var pm=v(Zp);Qp=y(pm,"STRONG",{});var cm=v(Qp);Xp=E(cm,"Create the module map"),cm.forEach(i),nc=E(pm,' and wrapping each module in a "special" module factory function'),pm.forEach(i),ac=b(tm),sc=y(tm,"LI",{});var lm=v(sc);tc=y(lm,"STRONG",{});var um=v(tc);ec=E(um,'Create the "runtime"'),um.forEach(i),oc=E(lm,", the glue that links each module together."),lm.forEach(i),tm.forEach(i),Bf.forEach(i),pc=b(n),cc=y(n,"SECTION",{});var rm=v(cc);lc=y(rm,"H3",{});var im=v(lc);uc=y(im,"A",{href:!0,id:!0});var km=v(uc);rc=E(km,"Grouping modules into files"),km.forEach(i),im.forEach(i),ic=b(rm),kc=y(rm,"P",{});var dm=v(kc);dc=E(dm,"This step is to decide which modules goes to which file. We can split modules into different files because of "),hc=y(dm,"A",{href:!0,rel:!0});var hm=v(hc);fc=E(hm,"code splitting"),hm.forEach(i),mc=E(dm," due to dynamic import as well as optimisation, such as the webpack's "),gc=y(dm,"A",{href:!0,rel:!0});var fm=v(gc);wc=E(fm,"Chunk Splitting"),fm.forEach(i),vc=E(dm,"."),dm.forEach(i),yc=b(rm),Ec=y(rm,"P",{});var mm=v(Ec);bc=E(mm,"I will support code splitting in the future. For now, I grouped all modules into 1 file."),mm.forEach(i),Ic=b(rm),xc=y(rm,"P",{});var gm=v(xc);Pc=E(gm,"To collect all the modules from module graph into a list of modules, I did a graph traversal:"),gm.forEach(i),jc=b(rm),Ac=y(rm,"PRE",{class:!0}),v(Ac).forEach(i),Tc=b(rm),Sc=y(rm,"P",{});var wm=v(Sc);Lc=E(wm,"...and I used the list of modules to create a module map."),wm.forEach(i),rm.forEach(i),Oc=b(n),Mc=y(n,"SECTION",{});var vm=v(Mc);Cc=y(vm,"H3",{});var ym=v(Cc);qc=y(ym,"A",{href:!0,id:!0});var Em=v(qc);Nc=E(Em,"Creating module map"),Em.forEach(i),ym.forEach(i),Rc=b(vm),$c=y(vm,"P",{});var bm=v($c);Dc=E(bm,"The module map I created is a string, that would be inlined into the final bundle file."),bm.forEach(i),Hc=b(vm),Gc=y(vm,"P",{});var Im=v(Gc);Bc=E(Im,"I looped through each module, and used "),Fc=y(Im,"CODE",{});var xm=v(Fc);Jc=E(xm,"module.filePath"),xm.forEach(i),Uc=E(Im," as the key, and "),Wc=y(Im,"CODE",{});var Pm=v(Wc);_c=E(Pm,"module.content"),Pm.forEach(i),Vc=E(Im," as the value."),Im.forEach(i),zc=b(vm),Yc=y(vm,"P",{});var jm=v(Yc);Kc=E(jm,"The reason I dont use "),Zc=y(jm,"CODE",{});var Am=v(Zc);Qc=E(Am,"JSON.stringify(moduleMap)"),Am.forEach(i),Xc=E(jm," instead of manually concatenating to build up the module map, is because JSON can only takes in "),nl=y(jm,"A",{href:!0,rel:!0});var Tm=v(nl);al=E(Tm,"JSON primitive data type"),Tm.forEach(i),sl=E(jm," as value, but what I built here is a JavaScript map, with "),tl=y(jm,"CODE",{});var Sm=v(tl);el=E(Sm,"function"),Sm.forEach(i),ol=E(jm," as value, but in string."),jm.forEach(i),pl=b(vm),cl=y(vm,"PRE",{class:!0}),v(cl).forEach(i),ll=b(vm),ul=y(vm,"P",{});var Lm=v(ul);rl=E(Lm,"The function that wraps around the "),il=y(Lm,"CODE",{});var Om=v(il);kl=E(Om,"module.content"),Om.forEach(i),dl=E(Lm," is called the module factory function. It provides 2 parameter to the module:"),Lm.forEach(i),hl=b(vm),fl=y(vm,"UL",{});var Mm=v(fl);ml=y(Mm,"LI",{});var Cm=v(ml);gl=y(Cm,"CODE",{});var qm=v(gl);wl=E(qm,"exports"),qm.forEach(i),vl=E(Cm,", an object that the module can assign its exported value onto"),Cm.forEach(i),yl=b(Mm),El=y(Mm,"LI",{});var Nm=v(El);bl=y(Nm,"CODE",{});var Rm=v(bl);Il=E(Rm,"require"),Rm.forEach(i),xl=E(Nm,", a function that the module can invoke with module path to import exported value from another module"),Nm.forEach(i),Mm.forEach(i),Pl=b(vm),jl=y(vm,"P",{});var $m=v(jl);Al=E($m,"The module map right now is not something that can be executed:"),$m.forEach(i),Tl=b(vm),Sl=y(vm,"PRE",{class:!0}),v(Sl).forEach(i),Ll=b(vm),Ol=y(vm,"P",{});var Dm=v(Ol);Ml=E(Dm,"because it still uses "),Cl=y(Dm,"CODE",{});var Hm=v(Cl);ql=E(Hm,"import"),Hm.forEach(i),Nl=E(Dm," and "),Rl=y(Dm,"CODE",{});var Gm=v(Rl);$l=E(Gm,"export"),Gm.forEach(i),Dl=E(Dm,". I had to transform them to use the "),Hl=y(Dm,"CODE",{});var Bm=v(Hl);Gl=E(Bm,"exports"),Bm.forEach(i),Bl=E(Dm," and "),Fl=y(Dm,"CODE",{});var Fm=v(Fl);Jl=E(Fm,"require"),Fm.forEach(i),Ul=E(Dm," that we pass in."),Dm.forEach(i),Wl=b(vm),_l=y(vm,"P",{});var Jm=v(_l);Vl=E(Jm,"To transform the code, I used the AST of the module again: trasform the ast and generate the new code from the transformed ast."),Jm.forEach(i),zl=b(vm),Yl=y(vm,"P",{});var Um=v(Yl);Kl=E(Um,'What I need is to trasform the "from" to "to" of the following:'),Um.forEach(i),Zl=b(vm),Ql=y(vm,"PRE",{class:!0}),v(Ql).forEach(i),Xl=b(vm),nu=y(vm,"BLOCKQUOTE",{});var Wm=v(nu);au=y(Wm,"P",{});var _m=v(au);su=E(_m,"I wrote a "),tu=y(_m,"A",{href:!0});var Vm=v(tu);eu=E(Vm,"step by step guide"),Vm.forEach(i),ou=E(_m," on how to write babel transformation, please do check it out."),_m.forEach(i),Wm.forEach(i),pu=b(vm),cu=y(vm,"P",{});var zm=v(cu);lu=E(zm,"Knowing "),uu=y(zm,"STRONG",{});var Ym=v(uu);ru=E(Ym,"what to target on AST"),Ym.forEach(i),iu=E(zm," and "),ku=y(zm,"STRONG",{});var Km=v(ku);du=E(Km,"how the transformed AST look like"),Km.forEach(i),hu=E(zm,", I wrote my transformation code:"),zm.forEach(i),fu=b(vm),mu=y(vm,"PRE",{class:!0}),v(mu).forEach(i),gu=b(vm),wu=y(vm,"P",{});var Zm=v(wu);vu=E(Zm,"I omitted the actual babel transformation code, because it is lengthy. If you are interested to read about it, you can check out "),yu=y(Zm,"A",{href:!0,rel:!0});var Qm=v(yu);Eu=E(Qm,"from my Github repo"),Qm.forEach(i),Zm.forEach(i),bu=b(vm),Iu=y(vm,"P",{});var Xm=v(Iu);xu=E(Xm,"So, now the module map looks ready:"),Xm.forEach(i),Pu=b(vm),ju=y(vm,"PRE",{class:!0}),v(ju).forEach(i),Au=b(vm),Tu=y(vm,"P",{});var ng=v(Tu);Su=E(ng,"One thing to take note is that, for the "),Lu=y(ng,"CODE",{});var ag=v(Lu);Ou=E(ag,"require"),ag.forEach(i),Mu=E(ng," statements, I replaced the requested path to the actual resolved path, because I used the actual resolved path as the key to the module map."),ng.forEach(i),vm.forEach(i),Cu=b(n),qu=y(n,"SECTION",{});var sg=v(qu);Nu=y(sg,"H3",{});var tg=v(Nu);Ru=y(tg,"A",{href:!0,id:!0});var eg=v(Ru);$u=y(eg,"STRONG",{});var og=v($u);Du=E(og,'Create the "runtime"'),og.forEach(i),eg.forEach(i),tg.forEach(i),Hu=b(sg),Gu=y(sg,"P",{});var pg=v(Gu);Bu=E(pg,"Now it's time to create the runtime. The runtime is a piece of code that is part of the output bundle, that runs when the application code is running, therefore, the runtime."),pg.forEach(i),Fu=b(sg),Ju=y(sg,"P",{});var cg=v(Ju);Uu=E(cg,"The runtime code can be from a template file, but for simplicity sake, I kept the runtime code as a string:"),cg.forEach(i),Wu=b(sg),_u=y(sg,"PRE",{class:!0}),v(_u).forEach(i),Vu=b(sg),zu=y(sg,"P",{});var lg=v(zu);Yu=E(lg,"The code above is self explanatory, except if you have no idea what does the "),Ku=y(lg,"CODE",{});var ug=v(Ku);Zu=E(ug,"webpackStart()"),ug.forEach(i),Qu=E(lg," do, you can read more about it in "),Xu=y(lg,"A",{href:!0});var rg=v(Xu);nr=E(rg,"my previous post"),rg.forEach(i),ar=E(lg,"."),lg.forEach(i),sr=b(sg),tr=y(sg,"P",{});var ig=v(tr);er=E(ig,"Finally, I returned the module code from the "),or=y(ig,"CODE",{});var kg=v(or);pr=E(kg,"bundle"),kg.forEach(i),cr=E(ig," function:"),ig.forEach(i),lr=b(sg),ur=y(sg,"PRE",{class:!0}),v(ur).forEach(i),rr=b(sg),ir=y(sg,"P",{});var dg=v(ir);kr=E(dg,"Now I run my bundler, it generates a "),dr=y(dg,"CODE",{});var hg=v(dr);hr=E(hg,"output/bundle.js"),hg.forEach(i),fr=E(dg," file. I run the generated file with node and I see:"),dg.forEach(i),mr=b(sg),gr=y(sg,"PRE",{class:!0}),v(gr).forEach(i),wr=b(sg),vr=y(sg,"P",{});var fg=v(vr);yr=E(fg,"That's it! A working module bundler!"),fg.forEach(i),Er=b(sg),br=y(sg,"P",{});var mg=v(br);Ir=E(mg,"Of course, the module bundler I've shown here is "),xr=y(mg,"STRONG",{});var gg=v(xr);Pr=E(gg,"nowhere near webpack"),gg.forEach(i),jr=E(mg,". Webpack supports more module system, resolving strategies, loading strategies, plugin system, optimisation, and many many more."),mg.forEach(i),sg.forEach(i),Ar=b(n),Tr=y(n,"SECTION",{});var wg=v(Tr);Sr=y(wg,"H2",{});var vg=v(Sr);Lr=y(vg,"A",{href:!0,id:!0});var yg=v(Lr);Or=E(yg,"Optimisation"),yg.forEach(i),vg.forEach(i),Mr=b(wg),Cr=y(wg,"P",{});var Eg=v(Cr);qr=E(Eg,"I played around my module bundler, and I quickly noticed a bug: "),Nr=y(Eg,"STRONG",{});var bg=v(Nr);Rr=E(bg,"Circular Dependency"),bg.forEach(i),$r=E(Eg,"."),Eg.forEach(i),Dr=b(wg),Hr=y(wg,"P",{});var Ig=v(Hr);Gr=E(Ig,"Here's my input files that I've tweaked:"),Ig.forEach(i),Br=b(wg),Fr=y(wg,"PRE",{class:!0}),v(Fr).forEach(i),Jr=b(wg),Ur=y(wg,"PRE",{class:!0}),v(Ur).forEach(i),Wr=b(wg),_r=y(wg,"P",{});var xg=v(_r);Vr=E(xg,"When I ran it through my module bunlder, immediately it ran into a stack overflow:"),xg.forEach(i),zr=b(wg),Yr=y(wg,"PRE",{class:!0}),v(Yr).forEach(i),wg.forEach(i),Kr=b(n),Zr=y(n,"SECTION",{});var Pg=v(Zr);Qr=y(Pg,"H3",{});var jg=v(Qr);Xr=y(jg,"A",{href:!0,id:!0});var Ag=v(Xr);ni=E(Ag,"Circular dependency"),Ag.forEach(i),jg.forEach(i),ai=b(Pg),si=y(Pg,"P",{});var Tg=v(si);ti=E(Tg,"There were 2 junctures that the code did recursive traversal which have led to the endless loop:"),Tg.forEach(i),ei=b(Pg),oi=y(Pg,"UL",{});var Sg=v(oi);pi=y(Sg,"LI",{});var Lg=v(pi);ci=E(Lg,"Generating dependency graphs"),Lg.forEach(i),li=b(Sg),ui=y(Sg,"LI",{});var Og=v(ui);ri=E(Og,"Traversing module graph for bundling"),Og.forEach(i),Sg.forEach(i),ii=b(Pg),ki=y(Pg,"PRE",{class:!0}),v(ki).forEach(i),di=b(Pg),hi=y(Pg,"P",{});var Mg=v(hi);fi=E(Mg,"Bundle with the latest code, the stack overflow is gone. However when I executed the output bundle, I saw"),Mg.forEach(i),mi=b(Pg),gi=y(Pg,"PRE",{class:!0}),v(gi).forEach(i),wi=b(Pg),vi=y(Pg,"P",{});var Cg=v(vi);yi=E(Cg,"So I took a look at the output bundle:"),Cg.forEach(i),Ei=b(Pg),bi=y(Pg,"PRE",{class:!0}),v(bi).forEach(i),Ii=b(Pg),xi=y(Pg,"P",{});var qg=v(xi);Pi=E(qg,"So, the problem is that I destructed "),ji=y(qg,"CODE",{});var Ng=v(ji);Ai=E(Ng,"PI"),Ng.forEach(i),Ti=E(qg," from the exports of "),Si=y(qg,"CODE",{});var Rg=v(Si);Li=E(Rg,"index.js"),Rg.forEach(i),Oi=E(qg," before it is defined, so naturally "),Mi=y(qg,"CODE",{});var $g=v(Mi);Ci=E($g,"PI"),$g.forEach(i),qi=E(qg," within "),Ni=y(qg,"CODE",{});var Dg=v(Ni);Ri=E(Dg,"circle.js"),Dg.forEach(i),$i=E(qg," would stay as "),Di=y(qg,"CODE",{});var Hg=v(Di);Hi=E(Hg,"undefined"),Hg.forEach(i),Gi=E(qg," throughout the application. However before I called "),Bi=y(qg,"CODE",{});var Gg=v(Bi);Fi=E(Gg,"circleArea"),Gg.forEach(i),Ji=E(qg,", we defined "),Ui=y(qg,"CODE",{});var Bg=v(Ui);Wi=E(Bg,"PI"),Bg.forEach(i),_i=E(qg," on the "),Vi=y(qg,"CODE",{});var Fg=v(Vi);zi=E(Fg,"index.js"),Fg.forEach(i),Yi=E(qg,"'s export, I am expecting it to be available."),qg.forEach(i),Ki=b(Pg),Zi=y(Pg,"P",{});var Jg=v(Zi);Qi=E(Jg,"So I built my application with webpack and took a look at how webpack solved this problem."),Jg.forEach(i),Xi=b(Pg),nk=y(Pg,"PRE",{class:!0}),v(nk).forEach(i),ak=b(Pg),sk=y(Pg,"P",{});var Ug=v(sk);tk=E(Ug,"Brilliant! The key is to lazily get the value of "),ek=y(Ug,"CODE",{});var Wg=v(ek);ok=E(Wg,"PI"),Wg.forEach(i),pk=E(Ug," when needed!"),Ug.forEach(i),ck=b(Pg),lk=y(Pg,"P",{});var _g=v(lk);uk=E(_g,"I changed my babel transformation code, which I am not showing it here. If you are curious enough, you can check out "),rk=y(_g,"A",{href:!0,rel:!0});var Vg=v(rk);ik=E(Vg,"the changes I made from Github"),Vg.forEach(i),kk=E(_g,"."),_g.forEach(i),Pg.forEach(i),dk=b(n),hk=y(n,"SECTION",{});var zg=v(hk);fk=y(zg,"H2",{});var Yg=v(fk);mk=y(Yg,"A",{href:!0,id:!0});var Kg=v(mk);gk=E(Kg,"Summary"),Kg.forEach(i),Yg.forEach(i),wk=b(zg),vk=y(zg,"P",{});var Zg=v(vk);yk=E(Zg,"There's two phases in module bundling: "),Ek=y(Zg,"STRONG",{});var Qg=v(Ek);bk=E(Qg,"Dependency Resolution"),Qg.forEach(i),Ik=E(Zg," and "),xk=y(Zg,"STRONG",{});var Xg=v(xk);Pk=E(Xg,"Bundling"),Xg.forEach(i),jk=E(Zg,"."),Zg.forEach(i),Ak=b(zg),Tk=y(zg,"P",{});var nw=v(Tk);Sk=E(nw,"I showed you how I constructed the dependency graph, by finding import statements and resolving modules. I shared how I created module maps and transformed the imports / exports syntax during "),Lk=y(nw,"STRONG",{});var aw=v(Lk);Ok=E(aw,"bundling"),aw.forEach(i),Mk=E(nw,". Lastly, I fixed the circular dependency bug that was in the first version of my module bundler."),nw.forEach(i),zg.forEach(i),Ck=b(n),qk=y(n,"SECTION",{});var sw=v(qk);Nk=y(sw,"H3",{});var tw=v(Nk);Rk=y(tw,"A",{href:!0,id:!0});var ew=v(Rk);$k=E(ew,"Whats next?"),ew.forEach(i),tw.forEach(i),Dk=b(sw),Hk=y(sw,"P",{});var ow=v(Hk);Gk=E(ow,"I have a few ideas that I will add to my module bundler, such as:"),ow.forEach(i),Bk=b(sw),Fk=y(sw,"UL",{});var pw=v(Fk);Jk=y(pw,"LI",{});var cw=v(Jk);Uk=E(cw,"code spliting"),cw.forEach(i),Wk=b(pw),_k=y(pw,"LI",{});var lw=v(_k);Vk=E(lw,"watch mode and reloading"),lw.forEach(i),pw.forEach(i),zk=b(sw),Yk=y(sw,"P",{});var uw=v(Yk);Kk=E(uw,"which I will cover them in my next article when they are ready."),uw.forEach(i),Zk=b(sw),Qk=y(sw,"P",{});var rw=v(Qk);Xk=E(rw,"Till then. Cheers. üòé"),rw.forEach(i),sw.forEach(i),nd=b(n),ad=y(n,"SECTION",{});var iw=v(ad);sd=y(iw,"H2",{});var kw=v(sd);td=y(kw,"A",{href:!0,id:!0});var dw=v(td);ed=E(dw,"Further Readings"),dw.forEach(i),kw.forEach(i),od=b(iw),pd=y(iw,"UL",{});var hw=v(pd);cd=y(hw,"LI",{});var fw=v(cd);ld=y(fw,"A",{href:!0,rel:!0});var mw=v(ld);ud=E(mw,"Ronen Amiel, Build Your Own Webpack - You Gotta Love Frontend 2018"),mw.forEach(i),fw.forEach(i),rd=b(hw),id=y(hw,"LI",{});var gw=v(id);kd=y(gw,"A",{href:!0,rel:!0});var ww=v(kd);dd=E(ww,"Luciano Mammino, Unbundling the JavaScript module bundler - DublinJS July 2018"),ww.forEach(i),gw.forEach(i),hd=b(hw),fd=y(hw,"LI",{});var vw=v(fd);md=y(vw,"A",{href:!0,rel:!0});var yw=v(md);gd=E(yw,"Adam Kelly, Let‚Äôs learn how module bundlers work and then write one ourselves"),yw.forEach(i),vw.forEach(i),wd=b(hw),vd=y(hw,"LI",{});var Ew=v(vd);yd=y(Ew,"A",{href:!0,rel:!0});var bw=v(yd);Ed=E(bw,"Webpack founder Tobias Koppers demos bundling live by hand"),bw.forEach(i),Ew.forEach(i),hw.forEach(i),iw.forEach(i),this.h()},h(){w(o,"href","#getting-started"),w(k,"href","#the-input"),w(I,"href","#writing"),w(j,"href","#resolving"),w(S,"href","#bundling"),w(C,"href","#grouping-modules-into-files"),w(R,"href","#creating-module-map"),w(H,"href","#"),w(B,"href","#optimisation"),w(W,"href","#circular-dependency"),w(z,"href","#summary"),w(Q,"href","#whats-next"),w(an,"href","#further-readings"),w(t,"class","sitemap"),w(t,"id","sitemap"),w(t,"role","navigation"),w(t,"aria-label","Table of Contents"),w(pn,"href","/what-is-module-bundler-and-how-does-it-work/"),w(un,"href","https://webpack.js.org"),w(un,"rel","nofollow"),w(dn,"href","https://rollupjs.org"),w(dn,"rel","nofollow"),w(Mn,"href","#getting-started"),w(Mn,"id","getting-started"),w($n,"href","/what-is-module-bundler-and-how-does-it-work/"),w(da,"href","#the-input"),w(da,"id","the-input"),w(va,"class","language-js"),w(Ea,"class","language-js"),w(Ia,"class","language-js"),w(Aa,"href","https://github.com/tanhauhau/byo-bundler/tree/master/fixture"),w(Aa,"rel","nofollow"),w(Ha,"href","#writing"),w(Ha,"id","writing"),w(Wa,"class","language-js"),w(Xa,"href","https://en.wikipedia.org/wiki/Directed_graph"),w(Xa,"rel","nofollow"),w(ts,"class","language-js"),w(gs,"class","language-js"),w(Ps,"class","language-js"),w(Ms,"href","http://babeljs.io"),w(Ms,"rel","nofollow"),w(Hs,"class","language-js"),w(Us,"class","language-js"),w(nt,"href","https://lihautan.com/babel-ast-explorer/#?eyJiYWJlbFNldHRpbmdzIjp7InZlcnNpb24iOiI3LjQuNSJ9LCJ0cmVlU2V0dGluZ3MiOnsiaGlkZUVtcHR5Ijp0cnVlLCJoaWRlTG9jYXRpb24iOnRydWUsImhpZGVUeXBlIjp0cnVlfSwiY29kZSI6ImltcG9ydCBzcXVhcmVBcmVhIGZyb20gJy4vc3F1YXJlLmpzJztcbmltcG9ydCBjaXJjbGVBcmVhIGZyb20gJy4vY2lyY2xlLmpzJztcblxuY29uc29sZS5sb2coJ0FyZWEgb2Ygc3F1YXJlOiAnLCBzcXVhcmVBcmVhKDUpKTtcbmNvbnNvbGUubG9nKCdBcmVhIG9mIGNpcmNsZScsIGNpcmNsZUFyZWEoNSkpO1xuIn0="),w(nt,"rel","nofollow"),w(pt,"type","image/webp"),w(pt,"srcset","f635154d6a84f142.webp"),w(ct,"type","image/jpeg"),w(ct,"srcset","f635154d6a84f142.png"),w(lt,"alt","babel-ast-explorer"),lt.src!==(ut="f635154d6a84f142.png")&&w(lt,"src","f635154d6a84f142.png"),w(St,"class","language-js"),w(Qt,"class","language-js"),w(pe,"href","#resolving"),w(pe,"id","resolving"),w(we,"class","language-js"),w(ye,"class","language-js"),w(Ae,"href","http://nodejs.org/api/modules.html#modules_all_together"),w(Ae,"rel","nofollow"),w(Ge,"class","language-null"),w(ze,"class","language-null"),w(ro,"href","https://webpack.js.org/configuration/resolve/"),w(ro,"rel","nofollow"),w(Eo,"class","language-js"),w(Lo,"class","language-js"),w(No,"class","language-js"),w(ep,"href","#bundling"),w(ep,"id","bundling"),w(qp,"href","/what-is-module-bundler-and-how-does-it-work/"),w(Bp,"class","language-js"),w(uc,"href","#grouping-modules-into-files"),w(uc,"id","grouping-modules-into-files"),w(hc,"href","https://webpack.js.org/guides/code-splitting/"),w(hc,"rel","nofollow"),w(gc,"href","https://webpack.js.org/plugins/split-chunks-plugin/"),w(gc,"rel","nofollow"),w(Ac,"class","language-js"),w(qc,"href","#creating-module-map"),w(qc,"id","creating-module-map"),w(nl,"href","https://documentation.progress.com/output/ua/OpenEdge_latest/index.html#page/dvjsn/json-data-types.html"),w(nl,"rel","nofollow"),w(cl,"class","language-js"),w(Sl,"class","language-js"),w(Ql,"class","language-js"),w(tu,"href","/step-by-step-guide-for-writing-a-babel-transformation"),w(mu,"class","language-js"),w(yu,"href","https://github.com/tanhauhau/byo-bundler/blob/feat-2-bundling/src/index.js#L46-L138"),w(yu,"rel","nofollow"),w(ju,"class","language-js"),w(Ru,"href","#"),w(Ru,"id",""),w(_u,"class","language-js"),w(Xu,"href","/what-is-module-bundler-and-how-does-it-work/"),w(ur,"class","language-js"),w(gr,"class","language-null"),w(Lr,"href","#optimisation"),w(Lr,"id","optimisation"),w(Fr,"class","language-js"),w(Ur,"class","language-js"),w(Yr,"class","language-null"),w(Xr,"href","#circular-dependency"),w(Xr,"id","circular-dependency"),w(ki,"class","language-js"),w(gi,"class","language-sh"),w(bi,"class","language-js"),w(nk,"class","language-js"),w(rk,"href","https://github.com/tanhauhau/byo-bundler/compare/feat-2-bundling...feat-3-circular-dependency"),w(rk,"rel","nofollow"),w(mk,"href","#summary"),w(mk,"id","summary"),w(Rk,"href","#whats-next"),w(Rk,"id","whats-next"),w(td,"href","#further-readings"),w(td,"id","further-readings"),w(ld,"href","https://www.youtube.com/watch?v=Gc9-7PBqOC8"),w(ld,"rel","nofollow"),w(kd,"href","https://slides.com/lucianomammino/unbundling-the-javascript-module-bundler-dublinjs"),w(kd,"rel","nofollow"),w(md,"href","https://www.freecodecamp.org/news/lets-learn-how-module-bundlers-work-and-then-write-one-ourselves-b2e3fe6c88ae/"),w(md,"rel","nofollow"),w(yd,"href","https://www.youtube.com/watch?v=UNMkLHzofQI"),w(yd,"rel","nofollow")},m(n,a){r(n,s,a),u(s,t),u(t,e),u(e,o),u(o,p),u(t,c),u(c,l),u(l,k),u(k,h),u(t,g),u(g,I),u(I,x),u(t,P),u(P,j),u(j,A),u(t,T),u(T,S),u(S,L),u(t,O),u(O,M),u(M,C),u(C,q),u(O,N),u(N,R),u(R,$),u(O,D),u(D,H),u(t,G),u(G,B),u(B,F),u(t,J),u(J,U),u(U,W),u(W,_),u(t,V),u(V,z),u(z,Y),u(t,K),u(K,Z),u(Z,Q),u(Q,X),u(t,nn),u(nn,an),u(an,sn),r(n,tn,a),r(n,en,a),u(en,on),u(en,pn),u(pn,cn),u(en,ln),u(en,un),u(un,rn),u(en,kn),u(en,dn),u(dn,hn),u(en,fn),r(n,mn,a),r(n,gn,a),u(gn,wn),r(n,vn,a),r(n,yn,a),r(n,En,a),r(n,bn,a),u(bn,In),u(bn,xn),u(xn,Pn),u(bn,jn),r(n,An,a),r(n,Tn,a),r(n,Sn,a),r(n,Ln,a),u(Ln,On),u(On,Mn),u(Mn,Cn),u(Ln,qn),u(Ln,Nn),u(Nn,Rn),u(Nn,$n),u($n,Dn),u(Nn,Hn),u(Ln,Gn),u(Ln,Bn),u(Bn,Fn),u(Bn,Jn),u(Jn,Un),u(Bn,Wn),u(Ln,_n),u(Ln,Vn),u(Vn,zn),u(zn,Yn),u(zn,Kn),u(Kn,Zn),u(Vn,Qn),u(Vn,Xn),u(Xn,na),u(Xn,aa),u(aa,sa),u(Ln,ta),u(Ln,ea),u(ea,oa),u(oa,pa),u(oa,ca),u(ca,la),u(oa,ua),r(n,ra,a),r(n,ia,a),u(ia,ka),u(ka,da),u(da,ha),u(ia,fa),u(ia,ma),u(ma,ga),u(ia,wa),u(ia,va),va.innerHTML='<code class="language-js"><span class="token comment">// filename: index.js</span>\n<span class="token keyword">import</span> squareArea <span class="token keyword">from</span> <span class="token string">\'./square.js\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> circleArea <span class="token keyword">from</span> <span class="token string">\'./circle.js\'</span><span class="token punctuation">;</span>\n\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',u(ia,ya),u(ia,Ea),Ea.innerHTML='<code class="language-js"><span class="token comment">// filename: square.js</span>\n<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">side</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> side <span class="token operator">*</span> side<span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span></code>',u(ia,ba),u(ia,Ia),Ia.innerHTML='<code class="language-js"><span class="token comment">// filename: circle.js</span>\n<span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span></code>',u(ia,xa),u(ia,Pa),u(Pa,ja),u(Pa,Aa),u(Aa,Ta),u(Pa,Sa),u(Pa,La),u(La,Oa),u(Pa,Ma),u(Pa,Ca),u(Ca,qa),u(Pa,Na),r(n,Ra,a),r(n,$a,a),u($a,Da),u(Da,Ha),u(Ha,Ga),u($a,Ba),u($a,Fa),u(Fa,Ja),u($a,Ua),u($a,Wa),Wa.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> entryFile<span class="token punctuation">,</span> outputFolder <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// build dependency graph</span>\n  <span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token function">createDependencyGraph</span><span class="token punctuation">(</span>entryFile<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// bundle the asset</span>\n  <span class="token keyword">const</span> outputFiles <span class="token operator">=</span> <span class="token function">bundle</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// write to output folder</span>\n  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> outputFile <span class="token keyword">of</span> outputFiles<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>\n      path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>outputFolder<span class="token punctuation">,</span> outputFile<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>\n      outputFile<span class="token punctuation">.</span>content<span class="token punctuation">,</span>\n      <span class="token string">\'utf-8\'</span>\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',u($a,_a),u($a,Va),u(Va,za),u(za,Ya),u(za,Ka),u(Ka,Za),u(za,Qa),u(za,Xa),u(Xa,ns),u(za,as),u($a,ss),u($a,ts),ts.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">createDependencyGraph</span><span class="token punctuation">(</span><span class="token parameter">entryFile</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> rootModule <span class="token operator">=</span> <span class="token function">createModule</span><span class="token punctuation">(</span>entryFile<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> rootModule<span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',u($a,es),u($a,os),u(os,ps),u($a,cs),u($a,ls),u(ls,us),u(ls,rs),u(rs,is),u(ls,ks),u(ls,ds),u(ds,hs),u(ls,fs),u($a,ms),u($a,gs),gs.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">createModule</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Module</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',u($a,ws),u($a,vs),u(vs,ys),u(vs,Es),u(Es,bs),u(vs,Is),u($a,xs),u($a,Ps),Ps.innerHTML='<code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>filePath <span class="token operator">=</span> filePath<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">\'utf-8\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>dependencies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',u($a,js),u($a,As),u(As,Ts),u(As,Ss),u(Ss,Ls),u(As,Os),u(As,Ms),u(Ms,Cs),u(As,qs),u(As,Ns),u(Ns,Rs),u(As,$s),u($a,Ds),u($a,Hs),Hs.innerHTML='<code class="language-js"><span class="token comment">// highlight-next-line</span>\n<span class="token keyword">const</span> babel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'@babel/core\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>filePath <span class="token operator">=</span> filePath<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">\'utf-8\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// highlight-next-line</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>ast <span class="token operator">=</span> babel<span class="token punctuation">.</span><span class="token function">parseSync</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',u($a,Gs),u($a,Bs),u(Bs,Fs),u($a,Js),u($a,Us),Us.innerHTML='<code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>filePath <span class="token operator">=</span> filePath<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">\'utf-8\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>ast <span class="token operator">=</span> babel<span class="token punctuation">.</span><span class="token function">parseSync</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// highlight-start</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>dependencies <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n  <span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token comment">//</span>\n  <span class="token punctuation">&#125;</span>\n  <span class="token comment">// highlight-end</span>\n<span class="token punctuation">&#125;</span></code>',u($a,Ws),u($a,_s),u(_s,Vs),u($a,zs),u($a,Ys),u(Ys,Ks),u(Ys,Zs),u(Zs,Qs),u(Ys,Xs),u(Ys,nt),u(nt,at),u(Ys,st),u($a,tt),u($a,et),u(et,ot),u(ot,pt),u(ot,ct),u(ot,lt),u($a,rt),u($a,it),u(it,kt),u(it,dt),u(dt,ht),u(it,ft),u(it,mt),u(mt,gt),u(it,wt),u(it,vt),u(vt,yt),u(it,Et),u(it,bt),u(bt,It),u(it,xt),u(it,Pt),u(Pt,jt),u(it,At),u($a,Tt),u($a,St),St.innerHTML='<code class="language-js"><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// highlight-start</span>\n  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ast<span class="token punctuation">.</span>program<span class="token punctuation">.</span>body\n    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">\'ImportDeclaration\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value<span class="token punctuation">)</span>\n  <span class="token comment">// highlight-end</span>\n<span class="token punctuation">&#125;</span></code>',u($a,Lt),u($a,Ot),u(Ot,Mt),u(Ot,Ct),u(Ct,qt),u(Ot,Nt),u(Ot,Rt),u(Rt,$t),u(Ot,Dt),u(Ot,Ht),u(Ht,Gt),u(Ot,Bt),u(Ot,Ft),u(Ft,Jt),u(Ot,Ut),u($a,Wt),u($a,_t),u(_t,Vt),u(_t,zt),u(zt,Yt),u(_t,Kt),u($a,Zt),u($a,Qt),Qt.innerHTML='<code class="language-js"><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ast<span class="token punctuation">.</span>program<span class="token punctuation">.</span>body\n    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">\'ImportDeclaration\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value<span class="token punctuation">)</span>\n  <span class="token comment">// highlight-next-line</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">relativePath</span> <span class="token operator">=></span> <span class="token function">resolveRequest</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>filePath<span class="token punctuation">,</span> relativePath<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">&#125;</span>\n\n<span class="token comment">// highlight-start</span>\n<span class="token comment">// resolving</span>\n<span class="token keyword">function</span> <span class="token function">resolveRequest</span><span class="token punctuation">(</span><span class="token parameter">requester<span class="token punctuation">,</span> requestedPath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">//</span>\n<span class="token punctuation">&#125;</span></code>',u($a,Xt),u($a,ne),u(ne,ae),u(ae,se),r(n,te,a),r(n,ee,a),u(ee,oe),u(oe,pe),u(pe,ce),u(ee,le),u(ee,ue),u(ue,re),u(ue,ie),u(ie,ke),u(ue,de),u(ue,he),u(he,fe),u(ue,me),u(ee,ge),u(ee,we),we.innerHTML='<code class="language-js"><span class="token comment">// filename: project/a.js</span>\n<span class="token keyword">import</span> <span class="token string">\'./b.js\'</span><span class="token punctuation">;</span></code>',u(ee,ve),u(ee,ye),ye.innerHTML='<code class="language-js"><span class="token comment">// filename: project/foo/a.js</span>\n<span class="token keyword">import</span> <span class="token string">\'./b.js\'</span><span class="token punctuation">;</span></code>',u(ee,Ee),u(ee,be),u(be,Ie),u(ee,xe),u(ee,Pe),u(Pe,je),u(Pe,Ae),u(Ae,Te),u(Pe,Se),u(ee,Le),u(ee,Oe),u(Oe,Me),u(Oe,Ce),u(Ce,qe),u(Oe,Ne),u(Oe,Re),u(Re,$e),u(Oe,De),u(ee,He),u(ee,Ge),Ge.innerHTML='\n<code class="language-">b\nb.js\nb.json\nb.node</code>',u(ee,Be),u(ee,Fe),u(Fe,Je),u(Fe,Ue),u(Ue,We),u(Fe,_e),u(ee,Ve),u(ee,ze),ze.innerHTML='\n<code class="language-">&quot;main&quot; in b/package.json\nb/index.js\nb/index.json\nb/index.node</code>',u(ee,Ye),u(ee,Ke),u(Ke,Ze),u(Ke,Qe),u(Qe,Xe),u(Ke,no),u(Ke,ao),u(ao,so),u(Ke,to),u(ee,eo),u(ee,oo),u(oo,po),u(oo,co),u(co,lo),u(oo,uo),u(oo,ro),u(ro,io),u(oo,ko),u(ee,ho),u(ee,fo),u(fo,mo),u(fo,go),u(go,wo),u(fo,vo),u(ee,yo),u(ee,Eo),Eo.innerHTML='<code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'path\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// highlight-start</span>\n<span class="token comment">// resolving</span>\n<span class="token keyword">function</span> <span class="token function">resolveRequest</span><span class="token punctuation">(</span><span class="token parameter">requester<span class="token punctuation">,</span> requestedPath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>requester<span class="token punctuation">)</span><span class="token punctuation">,</span> requestedPath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',u(ee,bo),u(ee,Io),u(Io,xo),u(xo,Po),u(ee,jo),u(ee,Ao),u(Ao,To),u(ee,So),u(ee,Lo),Lo.innerHTML='<code class="language-js"><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ast<span class="token punctuation">.</span>program<span class="token punctuation">.</span>body\n    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">\'ImportDeclaration\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value<span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">relativePath</span> <span class="token operator">=></span> <span class="token function">resolveRequest</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>filePath<span class="token punctuation">,</span> relativePath<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token comment">// highlight-next-line</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">absolutePath</span> <span class="token operator">=></span> <span class="token function">createModule</span><span class="token punctuation">(</span>absolutePath<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">&#125;</span></code>',u(ee,Oo),u(ee,Mo),u(Mo,Co),u(ee,qo),u(ee,No),No.innerHTML='<code class="language-js">Module <span class="token punctuation">&#123;</span>\n  filePath<span class="token punctuation">:</span> <span class="token string">\'/Projects/byo-bundler/fixture/index.js\'</span><span class="token punctuation">,</span>\n  content<span class="token punctuation">:</span>\n   <span class="token string">\'import squareArea from \'./square.js\';&#92;nimport circleArea from \'./circle.js\';&#92;n&#92;nconsole.log(\'Area of square: \', squareArea(5));&#92;nconsole.log(\'Area of circle\', circleArea(5));&#92;n\'</span><span class="token punctuation">,</span>\n  ast<span class="token punctuation">:</span>\n   Node <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  dependencies<span class="token punctuation">:</span>\n   <span class="token punctuation">[</span> Module <span class="token punctuation">&#123;</span>\n       filePath<span class="token punctuation">:</span> <span class="token string">\'/Projects/byo-bundler/fixture/square.js\'</span><span class="token punctuation">,</span>\n       content<span class="token punctuation">:</span>\n        <span class="token string">\'function area(side) &#123;&#92;n  return side * side;&#92;n&#125;&#92;nexport default area;&#92;n\'</span><span class="token punctuation">,</span>\n       ast<span class="token punctuation">:</span> Node <span class="token punctuation">&#123;</span><span class="token comment">/* ... */</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n       dependencies<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n     Module <span class="token punctuation">&#123;</span>\n       filePath<span class="token punctuation">:</span> <span class="token string">\'/Projects/byo-bundler/fixture/circle.js\'</span><span class="token punctuation">,</span>\n       content<span class="token punctuation">:</span>\n        <span class="token string">\'const PI = 3.141;&#92;nfunction area(radius) &#123;&#92;n    return PI * radius * radius;&#92;n&#125;&#92;nexport default area;&#92;n\'</span><span class="token punctuation">,</span>\n       ast<span class="token punctuation">:</span> Node <span class="token punctuation">&#123;</span><span class="token comment">/* ... */</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n       dependencies<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n      <span class="token punctuation">&#125;</span>\n   <span class="token punctuation">]</span>\n<span class="token punctuation">&#125;</span></code>',u(ee,Ro),u(ee,$o),u($o,Do),u($o,Ho),u(Ho,Go),u($o,Bo),u($o,Fo),u(Fo,Jo),u($o,Uo),u($o,Wo),u(Wo,_o),u($o,Vo),u($o,zo),u(zo,Yo),u($o,Ko),u(ee,Zo),u(ee,Qo),u(Qo,Xo),u(Xo,np),r(n,ap,a),r(n,sp,a),u(sp,tp),u(tp,ep),u(ep,op),u(sp,pp),u(sp,cp),u(cp,lp),u(sp,up),u(sp,rp),u(rp,ip),u(rp,kp),u(kp,dp),u(rp,hp),u(rp,fp),u(fp,mp),u(rp,gp),u(rp,wp),u(wp,vp),u(rp,yp),u(rp,Ep),u(Ep,bp),u(rp,Ip),u(sp,xp),u(sp,Pp),u(Pp,jp),u(jp,Ap),u(jp,Tp),u(Tp,Sp),u(jp,Lp),u(jp,Op),u(Op,Mp),u(jp,Cp),u(jp,qp),u(qp,Np),u(jp,Rp),u(sp,$p),u(sp,Dp),u(Dp,Hp),u(sp,Gp),u(sp,Bp),Bp.innerHTML='<code class="language-js"><span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token punctuation">&#123;</span>\n  <span class="token string">\'circle.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    exports<span class="token punctuation">.</span><span class="token function-variable function">default</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">\'square.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    exports<span class="token punctuation">.</span><span class="token function-variable function">default</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">side</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> side <span class="token operator">*</span> side<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">\'app.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> squareArea <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'square.js\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>\n    <span class="token keyword">const</span> circleArea <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'circle.js\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>\n\n<span class="token function">webpackStart</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>\n  modules<span class="token punctuation">,</span>\n  entry<span class="token punctuation">:</span> <span class="token string">\'app.js\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',u(sp,Fp),u(sp,Jp),u(Jp,Up),u(sp,Wp),u(sp,_p),u(_p,Vp),u(Vp,zp),u(zp,Yp),u(_p,Kp),u(_p,Zp),u(Zp,Qp),u(Qp,Xp),u(Zp,nc),u(_p,ac),u(_p,sc),u(sc,tc),u(tc,ec),u(sc,oc),r(n,pc,a),r(n,cc,a),u(cc,lc),u(lc,uc),u(uc,rc),u(cc,ic),u(cc,kc),u(kc,dc),u(kc,hc),u(hc,fc),u(kc,mc),u(kc,gc),u(gc,wc),u(kc,vc),u(cc,yc),u(cc,Ec),u(Ec,bc),u(cc,Ic),u(cc,xc),u(xc,Pc),u(cc,jc),u(cc,Ac),Ac.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">bundle</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token function">collectModules</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n\n<span class="token comment">// highlight-start</span>\n<span class="token keyword">function</span> <span class="token function">collectModules</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token function">collect</span><span class="token punctuation">(</span>graph<span class="token punctuation">,</span> modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> modules<span class="token punctuation">;</span>\n\n  <span class="token keyword">function</span> <span class="token function">collect</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> modules</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    modules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    module<span class="token punctuation">.</span>dependencies<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">dependency</span> <span class="token operator">=></span> <span class="token function">collect</span><span class="token punctuation">(</span>dependency<span class="token punctuation">,</span> modules<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',u(cc,Tc),u(cc,Sc),u(Sc,Lc),r(n,Oc,a),r(n,Mc,a),u(Mc,Cc),u(Cc,qc),u(qc,Nc),u(Mc,Rc),u(Mc,$c),u($c,Dc),u(Mc,Hc),u(Mc,Gc),u(Gc,Bc),u(Gc,Fc),u(Fc,Jc),u(Gc,Uc),u(Gc,Wc),u(Wc,_c),u(Gc,Vc),u(Mc,zc),u(Mc,Yc),u(Yc,Kc),u(Yc,Zc),u(Zc,Qc),u(Yc,Xc),u(Yc,nl),u(nl,al),u(Yc,sl),u(Yc,tl),u(tl,el),u(Yc,ol),u(Mc,pl),u(Mc,cl),cl.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">bundle</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token function">collectModules</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token keyword">const</span> moduleMap <span class="token operator">=</span> <span class="token function">toModuleMap</span><span class="token punctuation">(</span>modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n\n<span class="token comment">// highlight-start</span>\n<span class="token keyword">function</span> <span class="token function">toModuleMap</span><span class="token punctuation">(</span><span class="token parameter">modules</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">let</span> moduleMap <span class="token operator">=</span> <span class="token string">\'\'</span><span class="token punctuation">;</span>\n  moduleMap <span class="token operator">+=</span> <span class="token string">\'&#123;\'</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> module <span class="token keyword">of</span> modules<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    moduleMap <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>module<span class="token punctuation">.</span>filePath<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">": </span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>\n    moduleMap <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">function(exports, require) &#123; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>module<span class="token punctuation">.</span>content<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> &#125;,</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n\n  moduleMap <span class="token operator">+=</span> <span class="token string">\'&#125;\'</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> moduleMap<span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',u(Mc,ll),u(Mc,ul),u(ul,rl),u(ul,il),u(il,kl),u(ul,dl),u(Mc,hl),u(Mc,fl),u(fl,ml),u(ml,gl),u(gl,wl),u(ml,vl),u(fl,yl),u(fl,El),u(El,bl),u(bl,Il),u(El,xl),u(Mc,Pl),u(Mc,jl),u(jl,Al),u(Mc,Tl),u(Mc,Sl),Sl.innerHTML='<code class="language-js"><span class="token punctuation">&#123;</span>\n  <span class="token string">"index.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">import</span> squareArea <span class="token keyword">from</span> <span class="token string">\'./square.js\'</span><span class="token punctuation">;</span>\n    <span class="token keyword">import</span> circleArea <span class="token keyword">from</span> <span class="token string">\'./circle.js\'</span><span class="token punctuation">;</span>\n\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">"square.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">side</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> side <span class="token operator">*</span> side<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    <span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">"circle.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    <span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span></code>',u(Mc,Ll),u(Mc,Ol),u(Ol,Ml),u(Ol,Cl),u(Cl,ql),u(Ol,Nl),u(Ol,Rl),u(Rl,$l),u(Ol,Dl),u(Ol,Hl),u(Hl,Gl),u(Ol,Bl),u(Ol,Fl),u(Fl,Jl),u(Ol,Ul),u(Mc,Wl),u(Mc,_l),u(_l,Vl),u(Mc,zl),u(Mc,Yl),u(Yl,Kl),u(Mc,Zl),u(Mc,Ql),Ql.innerHTML='<code class="language-js"><span class="token comment">// #1</span>\n<span class="token comment">// from</span>\n<span class="token keyword">import</span> a<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> b<span class="token punctuation">,</span> c <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">\'foo\'</span><span class="token punctuation">;</span>\n<span class="token comment">// to</span>\n<span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'foo\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// #2</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> a<span class="token punctuation">;</span>\n<span class="token keyword">export</span> <span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n<span class="token keyword">export</span> <span class="token punctuation">&#123;</span> c <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>\n<span class="token comment">// to</span>\nexports<span class="token punctuation">.</span>default <span class="token operator">=</span> a<span class="token punctuation">;</span>\nexports<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>\nexports<span class="token punctuation">.</span>c <span class="token operator">=</span> c<span class="token punctuation">;</span></code>',u(Mc,Xl),u(Mc,nu),u(nu,au),u(au,su),u(au,tu),u(tu,eu),u(au,ou),u(Mc,pu),u(Mc,cu),u(cu,lu),u(cu,uu),u(uu,ru),u(cu,iu),u(cu,ku),u(ku,du),u(cu,hu),u(Mc,fu),u(Mc,mu),mu.innerHTML='<code class="language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> module <span class="token keyword">of</span> modules<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// highlight-next-line</span>\n  module<span class="token punctuation">.</span><span class="token function">transformModuleInterface</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  moduleMap <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>module<span class="token punctuation">.</span>filePath<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">": function(exports, require) &#123; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>module<span class="token punctuation">.</span>content<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> &#125;,</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="token comment">// ...</span>\n<span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// ...</span>\n  <span class="token comment">// highlight-start</span>\n  <span class="token function">transformModuleInterface</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> ast<span class="token punctuation">,</span> code <span class="token punctuation">&#125;</span> <span class="token operator">=</span> babel<span class="token punctuation">.</span><span class="token function">transformFromAstSync</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ast<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>ast <span class="token operator">=</span> ast<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> code<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n  <span class="token comment">// highlight-end</span>\n<span class="token punctuation">&#125;</span></code>',u(Mc,gu),u(Mc,wu),u(wu,vu),u(wu,yu),u(yu,Eu),u(Mc,bu),u(Mc,Iu),u(Iu,xu),u(Mc,Pu),u(Mc,ju),ju.innerHTML='<code class="language-js"><span class="token punctuation">&#123;</span>\n  <span class="token string">"index.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> squareArea <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'square.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> circleArea <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'circle.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">"square.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">side</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> side <span class="token operator">*</span> side<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    exports<span class="token punctuation">.</span>default <span class="token operator">=</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">"circle.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    exports<span class="token punctuation">.</span>default <span class="token operator">=</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span></code>',u(Mc,Au),u(Mc,Tu),u(Tu,Su),u(Tu,Lu),u(Lu,Ou),u(Tu,Mu),r(n,Cu,a),r(n,qu,a),u(qu,Nu),u(Nu,Ru),u(Ru,$u),u($u,Du),u(qu,Hu),u(qu,Gu),u(Gu,Bu),u(qu,Fu),u(qu,Ju),u(Ju,Uu),u(qu,Wu),u(qu,_u),_u.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">bundle</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token function">collectModules</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> moduleMap <span class="token operator">=</span> <span class="token function">toModuleMap</span><span class="token punctuation">(</span>modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token keyword">const</span> moduleCode <span class="token operator">=</span> <span class="token function">addRuntime</span><span class="token punctuation">(</span>moduleMap<span class="token punctuation">,</span> modules<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="token comment">// highlight-start</span>\n<span class="token keyword">function</span> <span class="token function">addRuntime</span><span class="token punctuation">(</span><span class="token parameter">moduleMap<span class="token punctuation">,</span> entryPoint</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">\n    const modules = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>moduleMap<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">;\n    const entry = "</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>entryPoint<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">";\n    function webpackStart(&#123; modules, entry &#125;) &#123;\n      const moduleCache = &#123;&#125;;\n      const require = moduleName => &#123;\n        // if in cache, return the cached version\n        if (moduleCache[moduleName]) &#123;\n          return moduleCache[moduleName];\n        &#125;\n        const exports = &#123;&#125;;\n        // this will prevent infinite "require" loop\n        // from circular dependencies\n        moduleCache[moduleName] = exports;\n    \n        // "require"-ing the module,\n        // exported stuff will assigned to "exports"\n        modules[moduleName](exports, require);\n        return moduleCache[moduleName];\n      &#125;;\n    \n      // start the program\n      require(entry);\n    &#125;\n\n    webpackStart(&#123; modules, entry &#125;);</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n\n<span class="token comment">// trim away spaces before the line</span>\n<span class="token keyword">function</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> lines <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">\'&#92;n\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> padLength <span class="token operator">=</span> lines<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">-</span> lines<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">trimLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>\n  <span class="token keyword">const</span> regex <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">^\\s&#123;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>padLength<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&#125;</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> lines<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">line</span> <span class="token operator">=></span> line<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>regex<span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">\'&#92;n\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',u(qu,Vu),u(qu,zu),u(zu,Yu),u(zu,Ku),u(Ku,Zu),u(zu,Qu),u(zu,Xu),u(Xu,nr),u(zu,ar),u(qu,sr),u(qu,tr),u(tr,er),u(tr,or),u(or,pr),u(tr,cr),u(qu,lr),u(qu,ur),ur.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">bundle</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token function">collectModules</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> moduleMap <span class="token operator">=</span> <span class="token function">toModuleMap</span><span class="token punctuation">(</span>modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> moduleCode <span class="token operator">=</span> <span class="token function">addRuntime</span><span class="token punctuation">(</span>moduleMap<span class="token punctuation">,</span> modules<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span> name<span class="token punctuation">:</span> <span class="token string">\'bundle.js\'</span><span class="token punctuation">,</span> content<span class="token punctuation">:</span> moduleCode <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',u(qu,rr),u(qu,ir),u(ir,kr),u(ir,dr),u(dr,hr),u(ir,fr),u(qu,mr),u(qu,gr),gr.innerHTML='\n<code class="language-">Area of square:  25\nArea of circle 78.525</code>',u(qu,wr),u(qu,vr),u(vr,yr),u(qu,Er),u(qu,br),u(br,Ir),u(br,xr),u(xr,Pr),u(br,jr),r(n,Ar,a),r(n,Tr,a),u(Tr,Sr),u(Sr,Lr),u(Lr,Or),u(Tr,Mr),u(Tr,Cr),u(Cr,qr),u(Cr,Nr),u(Nr,Rr),u(Cr,$r),u(Tr,Dr),u(Tr,Hr),u(Hr,Gr),u(Tr,Br),u(Tr,Fr),Fr.innerHTML='<code class="language-js"><span class="token comment">// filename: index.js</span>\n<span class="token keyword">import</span> squareArea <span class="token keyword">from</span> <span class="token string">\'./square.js\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> circleArea <span class="token keyword">from</span> <span class="token string">\'./circle.js\'</span><span class="token punctuation">;</span>\n\n<span class="token comment">// highlight-next-line</span>\n<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',u(Tr,Jr),u(Tr,Ur),Ur.innerHTML='<code class="language-js"><span class="token comment">// filename: circle.js</span>\n<span class="token comment">// highlight-start</span>\n<span class="token comment">// const PI = 3.141;</span>\n<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> <span class="token constant">PI</span> <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">\'./index.js\'</span><span class="token punctuation">;</span>\n<span class="token comment">// highlight-end</span>\n\n<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span></code>',u(Tr,Wr),u(Tr,_r),u(_r,Vr),u(Tr,zr),u(Tr,Yr),Yr.innerHTML='\n<code class="language-">RangeError: Maximum call stack size exceeded</code>',r(n,Kr,a),r(n,Zr,a),u(Zr,Qr),u(Qr,Xr),u(Xr,ni),u(Zr,ai),u(Zr,si),u(si,ti),u(Zr,ei),u(Zr,oi),u(oi,pi),u(pi,ci),u(oi,li),u(oi,ui),u(ui,ri),u(Zr,ii),u(Zr,ki),ki.innerHTML='<code class="language-js"><span class="token comment">// fixing circular dependencies when generating module graph</span>\n<span class="token comment">// highlight-next-line</span>\n<span class="token keyword">const</span> <span class="token constant">MODULE_CACHE</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">function</span> <span class="token function">createModule</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n <span class="token comment">// highlight-next-line</span>\n <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token constant">MODULE_CACHE</span><span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n   <span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Module</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token comment">// highlight-next-line</span>\n   <span class="token constant">MODULE_CACHE</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> module<span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token comment">// highlight-next-line</span>\n   module<span class="token punctuation">.</span><span class="token function">initDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n <span class="token punctuation">&#125;</span>\n <span class="token comment">// highlight-next-line</span>\n <span class="token keyword">return</span> <span class="token constant">MODULE_CACHE</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token operator">...</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token function">initDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token comment">// highlight-next-line</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>dependencies <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span>\n\n<span class="token comment">// fixing circular dependencies when traversing module graph</span>\n<span class="token keyword">function</span> <span class="token function">collectModules</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">collect</span><span class="token punctuation">(</span>graph<span class="token punctuation">,</span> modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token comment">// highlight-start</span>\n  <span class="token keyword">function</span> <span class="token function">collect</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> modules</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>modules<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      modules<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      module<span class="token punctuation">.</span>dependencies<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">dependency</span> <span class="token operator">=></span> <span class="token function">collect</span><span class="token punctuation">(</span>dependency<span class="token punctuation">,</span> modules<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',u(Zr,di),u(Zr,hi),u(hi,fi),u(Zr,mi),u(Zr,gi),gi.innerHTML='<code class="language-sh">$ node output/bundle.js\nArea of square:  25\nArea of circle NaN</code>',u(Zr,wi),u(Zr,vi),u(vi,yi),u(Zr,Ei),u(Zr,bi),bi.innerHTML='<code class="language-js"><span class="token punctuation">&#123;</span>\n  <span class="token string">\'index.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> squareArea <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'square.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 1. require circle.js</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> circleArea <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'circle.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 3. define PI on exports</span>\n    exports<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 4. call &#96;circleArea&#96;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">\'circle.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token comment">// 2. at the point of executing this, PI is not yet defined</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token constant">PI</span><span class="token punctuation">:</span> <span class="token constant">PI</span> <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'index.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token comment">// 5. PI is undefined</span>\n      <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    exports<span class="token punctuation">.</span>default <span class="token operator">=</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span></code>',u(Zr,Ii),u(Zr,xi),u(xi,Pi),u(xi,ji),u(ji,Ai),u(xi,Ti),u(xi,Si),u(Si,Li),u(xi,Oi),u(xi,Mi),u(Mi,Ci),u(xi,qi),u(xi,Ni),u(Ni,Ri),u(xi,$i),u(xi,Di),u(Di,Hi),u(xi,Gi),u(xi,Bi),u(Bi,Fi),u(xi,Ji),u(xi,Ui),u(Ui,Wi),u(xi,_i),u(xi,Vi),u(Vi,zi),u(xi,Yi),u(Zr,Ki),u(Zr,Zi),u(Zi,Qi),u(Zr,Xi),u(Zr,nk),nk.innerHTML='<code class="language-js"><span class="token punctuation">&#123;</span>\n  <span class="token string">\'index.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> square_import <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'square.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 1. require circle.js</span>\n    <span class="token keyword">const</span> circle_import <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'circle.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 3. define PI on exports</span>\n    exports<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> square_import<span class="token punctuation">[</span><span class="token string">\'default\'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 4. call &#96;circleArea&#96;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> circle_import<span class="token punctuation">[</span><span class="token string">\'default\'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">\'circle.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token comment">// 2. we keep a reference of the &#96;index.js&#96;\'s &#96;exports&#96; object</span>\n    <span class="token keyword">const</span> index_import <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'index.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token comment">// 5. we get PI from the &#96;exports&#96;</span>\n      <span class="token keyword">return</span> index_import<span class="token punctuation">[</span><span class="token string">\'PI\'</span><span class="token punctuation">]</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    exports<span class="token punctuation">.</span>default <span class="token operator">=</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span></code>',u(Zr,ak),u(Zr,sk),u(sk,tk),u(sk,ek),u(ek,ok),u(sk,pk),u(Zr,ck),u(Zr,lk),u(lk,uk),u(lk,rk),u(rk,ik),u(lk,kk),r(n,dk,a),r(n,hk,a),u(hk,fk),u(fk,mk),u(mk,gk),u(hk,wk),u(hk,vk),u(vk,yk),u(vk,Ek),u(Ek,bk),u(vk,Ik),u(vk,xk),u(xk,Pk),u(vk,jk),u(hk,Ak),u(hk,Tk),u(Tk,Sk),u(Tk,Lk),u(Lk,Ok),u(Tk,Mk),r(n,Ck,a),r(n,qk,a),u(qk,Nk),u(Nk,Rk),u(Rk,$k),u(qk,Dk),u(qk,Hk),u(Hk,Gk),u(qk,Bk),u(qk,Fk),u(Fk,Jk),u(Jk,Uk),u(Fk,Wk),u(Fk,_k),u(_k,Vk),u(qk,zk),u(qk,Yk),u(Yk,Kk),u(qk,Zk),u(qk,Qk),u(Qk,Xk),r(n,nd,a),r(n,ad,a),u(ad,sd),u(sd,td),u(td,ed),u(ad,od),u(ad,pd),u(pd,cd),u(cd,ld),u(ld,ud),u(pd,rd),u(pd,id),u(id,kd),u(kd,dd),u(pd,hd),u(pd,fd),u(fd,md),u(md,gd),u(pd,wd),u(pd,vd),u(vd,yd),u(yd,Ed)},p:n,d(n){n&&i(s),n&&i(tn),n&&i(en),n&&i(mn),n&&i(gn),n&&i(vn),n&&i(yn),n&&i(En),n&&i(bn),n&&i(An),n&&i(Tn),n&&i(Sn),n&&i(Ln),n&&i(ra),n&&i(ia),n&&i(Ra),n&&i($a),n&&i(te),n&&i(ee),n&&i(ap),n&&i(sp),n&&i(pc),n&&i(cc),n&&i(Oc),n&&i(Mc),n&&i(Cu),n&&i(qu),n&&i(Ar),n&&i(Tr),n&&i(Kr),n&&i(Zr),n&&i(dk),n&&i(hk),n&&i(Ck),n&&i(qk),n&&i(nd),n&&i(ad)}}}function dn(n){let s,t;const e=[hn];let o={$$slots:{default:[kn]},$$scope:{ctx:n}};for(let n=0;n<e.length;n+=1)o=a(o,e[n]);return s=new rn({props:o}),{c(){J(s.$$.fragment)},l(n){U(s.$$.fragment,n)},m(n,a){W(s,n,a),t=!0},p(n,[a]){const t=0&a?function(n,a){const s={},t={},e={$$scope:1};let o=n.length;for(;o--;){const p=n[o],c=a[o];if(c){for(const n in p)n in c||(t[n]=1);for(const n in c)e[n]||(s[n]=c[n],e[n]=1);n[o]=c}else for(const n in p)e[n]=1}for(const n in t)n in s||(s[n]=void 0);return s}(e,[(o=hn,"object"==typeof o&&null!==o?o:{})]):{};var o;1&a&&(t.$$scope={dirty:a,ctx:n}),s.$set(t)},i(n){t||(B(s.$$.fragment,n),t=!0)},o(n){F(s.$$.fragment,n),t=!1},d(n){_(s,n)}}}const hn={title:"I wrote my module bundler",date:"2019-09-18T08:00:00Z",tags:["JavaScript","module bundler","dev tool","webpack"],description:"In my previous article, I explained how module bundler works. In this article, I am going to show you how I wrote my module bundler...",series:"Write a module bundler",slug:"i-wrote-my-module-bundler",type:"blog"};class fn extends Y{constructor(n){super(),z(this,n,null,dn,p,{})}}setTimeout(()=>{new fn({target:document.querySelector("#app"),hydrate:!0})},3e3);
