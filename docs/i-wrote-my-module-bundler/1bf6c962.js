function n(){}function a(n,a){for(const s in a)n[s]=a[s];return n}function s(n){return n()}function t(){return Object.create(null)}function e(n){n.forEach(s)}function o(n){return"function"==typeof n}function p(n,a){return n!=n?a==a:n!==a||n&&"object"==typeof n||"function"==typeof n}function c(n,s,t,e){return n[1]&&e?a(t.ctx.slice(),n[1](e(s))):t.ctx}function l(n,a,s,t,e,o,p){const l=function(n,a,s,t){if(n[2]&&t){const e=n[2](t(s));if(void 0===a.dirty)return e;if("object"==typeof e){const n=[],s=Math.max(a.dirty.length,e.length);for(let t=0;t<s;t+=1)n[t]=a.dirty[t]|e[t];return n}return a.dirty|e}return a.dirty}(a,t,e,o);if(l){const e=c(a,s,t,p);n.p(e,l)}}function u(n,a){n.appendChild(a)}function r(n,a,s){n.insertBefore(a,s||null)}function i(n){n.parentNode.removeChild(n)}function k(n,a){for(let s=0;s<n.length;s+=1)n[s]&&n[s].d(a)}function d(n){return document.createElement(n)}function h(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function f(n){return document.createTextNode(n)}function m(){return f(" ")}function g(){return f("")}function w(n,a,s){null==s?n.removeAttribute(a):n.getAttribute(a)!==s&&n.setAttribute(a,s)}function v(n){return Array.from(n.childNodes)}function y(n,a,s,t){for(let t=0;t<n.length;t+=1){const e=n[t];if(e.nodeName===a){let a=0;const o=[];for(;a<e.attributes.length;){const n=e.attributes[a++];s[n.name]||o.push(n.name)}for(let n=0;n<o.length;n++)e.removeAttribute(o[n]);return n.splice(t,1)[0]}}return t?h(a):d(a)}function E(n,a){for(let s=0;s<n.length;s+=1){const t=n[s];if(3===t.nodeType)return t.data=""+a,n.splice(s,1)[0]}return f(a)}function b(n){return E(n," ")}function I(n,a){a=""+a,n.wholeText!==a&&(n.data=a)}function x(n,a){n.value=null==a?"":a}class P{constructor(n=null){this.a=n,this.e=this.n=null}m(n,a,s=null){this.e||(this.e=d(a.nodeName),this.t=a,this.h(n)),this.i(s)}h(n){this.e.innerHTML=n,this.n=Array.from(this.e.childNodes)}i(n){for(let a=0;a<this.n.length;a+=1)r(this.t,this.n[a],n)}p(n){this.d(),this.h(n),this.i(this.a)}d(){this.n.forEach(i)}}let j;function A(n){j=n}function T(n){(function(){if(!j)throw new Error("Function called outside component initialization");return j})().$$.on_mount.push(n)}const S=[],L=[],O=[],M=[],C=Promise.resolve();let q=!1;function N(n){O.push(n)}let R=!1;const $=new Set;function D(){if(!R){R=!0;do{for(let n=0;n<S.length;n+=1){const a=S[n];A(a),H(a.$$)}for(S.length=0;L.length;)L.pop()();for(let n=0;n<O.length;n+=1){const a=O[n];$.has(a)||($.add(a),a())}O.length=0}while(S.length);for(;M.length;)M.pop()();q=!1,R=!1,$.clear()}}function H(n){if(null!==n.fragment){n.update(),e(n.before_update);const a=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,a),n.after_update.forEach(N)}}const G=new Set;function B(n,a){n&&n.i&&(G.delete(n),n.i(a))}function F(n,a,s,t){if(n&&n.o){if(G.has(n))return;G.add(n),(void 0).c.push(()=>{G.delete(n),t&&(s&&n.d(1),t())}),n.o(a)}}function J(n){n&&n.c()}function U(n,a){n&&n.l(a)}function W(n,a,t){const{fragment:p,on_mount:c,on_destroy:l,after_update:u}=n.$$;p&&p.m(a,t),N(()=>{const a=c.map(s).filter(o);l?l.push(...a):e(a),n.$$.on_mount=[]}),u.forEach(N)}function _(n,a){const s=n.$$;null!==s.fragment&&(e(s.on_destroy),s.fragment&&s.fragment.d(a),s.on_destroy=s.fragment=null,s.ctx=[])}function V(n,a){-1===n.$$.dirty[0]&&(S.push(n),q||(q=!0,C.then(D)),n.$$.dirty.fill(0)),n.$$.dirty[a/31|0]|=1<<a%31}function z(a,s,o,p,c,l,u=[-1]){const r=j;A(a);const k=s.props||{},d=a.$$={fragment:null,ctx:null,props:l,update:n,not_equal:c,bound:t(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(r?r.$$.context:[]),callbacks:t(),dirty:u};let h=!1;if(d.ctx=o?o(a,k,(n,s,...t)=>{const e=t.length?t[0]:s;return d.ctx&&c(d.ctx[n],d.ctx[n]=e)&&(d.bound[n]&&d.bound[n](e),h&&V(a,n)),s}):[],d.update(),h=!0,e(d.before_update),d.fragment=!!p&&p(d.ctx),s.target){if(s.hydrate){const n=v(s.target);d.fragment&&d.fragment.l(n),n.forEach(i)}else d.fragment&&d.fragment.c();s.intro&&B(a.$$.fragment),W(a,s.target,s.anchor),D()}A(r)}class Y{$destroy(){_(this,1),this.$destroy=n}$on(n,a){const s=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return s.push(a),()=>{const n=s.indexOf(a);-1!==n&&s.splice(n,1)}}$set(){}}function K(a){let s,t,e,o,p,c,l,k,g,I,x,P,j,A,T,S,L,O,M,C,q,N,R,$,D,H,G,B,F,J,U,W,_,V,z;return{c(){s=d("header"),t=d("nav"),e=d("ul"),o=d("li"),p=d("a"),c=f("Tan Li Hau"),l=m(),k=d("li"),g=d("a"),I=f("About"),x=m(),P=d("li"),j=d("a"),A=f("Writings"),T=m(),S=d("li"),L=d("a"),O=f("Talks"),M=m(),C=d("li"),q=d("a"),N=f("Notes"),R=m(),$=d("li"),D=d("a"),H=f("Newsletter"),G=m(),B=d("li"),F=d("a"),J=h("svg"),U=h("path"),W=m(),_=d("a"),V=h("svg"),z=h("path"),this.h()},l(n){s=y(n,"HEADER",{class:!0});var a=v(s);t=y(a,"NAV",{});var u=v(t);e=y(u,"UL",{class:!0});var r=v(e);o=y(r,"LI",{class:!0});var d=v(o);p=y(d,"A",{href:!0,class:!0});var h=v(p);c=E(h,"Tan Li Hau"),h.forEach(i),d.forEach(i),l=b(r),k=y(r,"LI",{class:!0});var f=v(k);g=y(f,"A",{href:!0,class:!0});var m=v(g);I=E(m,"About"),m.forEach(i),f.forEach(i),x=b(r),P=y(r,"LI",{class:!0});var w=v(P);j=y(w,"A",{href:!0,class:!0});var Y=v(j);A=E(Y,"Writings"),Y.forEach(i),w.forEach(i),T=b(r),S=y(r,"LI",{class:!0});var K=v(S);L=y(K,"A",{href:!0,class:!0});var Z=v(L);O=E(Z,"Talks"),Z.forEach(i),K.forEach(i),M=b(r),C=y(r,"LI",{class:!0});var Q=v(C);q=y(Q,"A",{href:!0,class:!0});var X=v(q);N=E(X,"Notes"),X.forEach(i),Q.forEach(i),R=b(r),$=y(r,"LI",{class:!0});var nn=v($);D=y(nn,"A",{href:!0,class:!0});var an=v(D);H=E(an,"Newsletter"),an.forEach(i),nn.forEach(i),G=b(r),B=y(r,"LI",{class:!0});var sn=v(B);F=y(sn,"A",{"aria-label":!0,href:!0,class:!0});var tn=v(F);J=y(tn,"svg",{viewBox:!0,width:!0,height:!0,class:!0},1);var en=v(J);U=y(en,"path",{d:!0},1),v(U).forEach(i),en.forEach(i),tn.forEach(i),W=b(sn),_=y(sn,"A",{"aria-label":!0,href:!0,class:!0});var on=v(_);V=y(on,"svg",{viewBox:!0,width:!0,height:!0,class:!0},1);var pn=v(V);z=y(pn,"path",{d:!0},1),v(z).forEach(i),pn.forEach(i),on.forEach(i),sn.forEach(i),r.forEach(i),u.forEach(i),a.forEach(i),this.h()},h(){w(p,"href","/"),w(p,"class","svelte-f3e4uo"),w(o,"class","svelte-f3e4uo"),w(g,"href","/about"),w(g,"class","svelte-f3e4uo"),w(k,"class","svelte-f3e4uo"),w(j,"href","/blogs"),w(j,"class","svelte-f3e4uo"),w(P,"class","svelte-f3e4uo"),w(L,"href","/talks"),w(L,"class","svelte-f3e4uo"),w(S,"class","svelte-f3e4uo"),w(q,"href","/notes"),w(q,"class","svelte-f3e4uo"),w(C,"class","svelte-f3e4uo"),w(D,"href","/newsletter"),w(D,"class","svelte-f3e4uo"),w($,"class","svelte-f3e4uo"),w(U,"d","M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66\n    10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5\n    4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"),w(J,"viewBox","0 0 24 24"),w(J,"width","1em"),w(J,"height","1em"),w(J,"class","svelte-f3e4uo"),w(F,"aria-label","Twitter account"),w(F,"href","https://twitter.com/lihautan"),w(F,"class","svelte-f3e4uo"),w(z,"d","M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0\n    0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07\n    5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65\n    5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42\n    3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"),w(V,"viewBox","0 0 24 24"),w(V,"width","1em"),w(V,"height","1em"),w(V,"class","svelte-f3e4uo"),w(_,"aria-label","Github account"),w(_,"href","https://github.com/tanhauhau"),w(_,"class","svelte-f3e4uo"),w(B,"class","social svelte-f3e4uo"),w(e,"class","svelte-f3e4uo"),w(s,"class","svelte-f3e4uo")},m(n,a){r(n,s,a),u(s,t),u(t,e),u(e,o),u(o,p),u(p,c),u(e,l),u(e,k),u(k,g),u(g,I),u(e,x),u(e,P),u(P,j),u(j,A),u(e,T),u(e,S),u(S,L),u(L,O),u(e,M),u(e,C),u(C,q),u(q,N),u(e,R),u(e,$),u($,D),u(D,H),u(e,G),u(e,B),u(B,F),u(F,J),u(J,U),u(B,W),u(B,_),u(_,V),u(V,z)},p:n,i:n,o:n,d(n){n&&i(s)}}}class Z extends Y{constructor(n){super(),z(this,n,null,K,p,{})}}function Q(a){let s,t,e,o,p,c,l,k,h,g,I,P,j,A,T,S,L,O,M,C;return{c(){s=d("div"),t=d("h1"),e=f("Subscribe to my newsletter"),o=m(),p=d("h2"),c=f("Get the latest blog posts and project updates delivered right to your inbox"),l=m(),k=d("form"),h=d("div"),g=d("input"),I=m(),P=d("input"),A=m(),T=d("input"),S=m(),L=d("p"),O=f("Powered by Buttondown."),this.h()},l(n){s=y(n,"DIV",{class:!0});var a=v(s);t=y(a,"H1",{});var u=v(t);e=E(u,"Subscribe to my newsletter"),u.forEach(i),o=b(a),p=y(a,"H2",{class:!0});var r=v(p);c=E(r,"Get the latest blog posts and project updates delivered right to your inbox"),r.forEach(i),l=b(a),k=y(a,"FORM",{action:!0,method:!0,target:!0,onsubmit:!0,class:!0});var d=v(k);h=y(d,"DIV",{class:!0});var f=v(h);g=y(f,"INPUT",{type:!0,name:!0,id:!0,"aria-label":!0,placeholder:!0,class:!0}),I=b(f),P=y(f,"INPUT",{type:!0,value:!0,disabled:!0,class:!0}),f.forEach(i),A=b(d),T=y(d,"INPUT",{type:!0,value:!0,name:!0,class:!0}),S=b(d),L=y(d,"P",{class:!0});var m=v(L);O=E(m,"Powered by Buttondown."),m.forEach(i),d.forEach(i),a.forEach(i),this.h()},h(){w(p,"class","svelte-1k1s1co"),w(g,"type","email"),w(g,"name","email"),w(g,"id","bd-email"),w(g,"aria-label","email address"),w(g,"placeholder","youremail@example.com"),w(g,"class","svelte-1k1s1co"),w(P,"type","submit"),P.value="Subscribe",P.disabled=j=!a[0],w(P,"class","svelte-1k1s1co"),w(h,"class","form-item svelte-1k1s1co"),w(T,"type","hidden"),T.value="1",w(T,"name","embed"),w(T,"class","svelte-1k1s1co"),w(L,"class","svelte-1k1s1co"),w(k,"action","https://buttondown.email/api/emails/embed-subscribe/lihautan"),w(k,"method","post"),w(k,"target","popupwindow"),w(k,"onsubmit","window.open('https://buttondown.email/lihautan', 'popupwindow')"),w(k,"class","embeddable-buttondown-form"),w(s,"class","form svelte-1k1s1co")},m(n,i){var d,f,m,w;r(n,s,i),u(s,t),u(t,e),u(s,o),u(s,p),u(p,c),u(s,l),u(s,k),u(k,h),u(h,g),x(g,a[0]),u(h,I),u(h,P),u(k,A),u(k,T),u(k,S),u(k,L),u(L,O),M||(d=g,f="input",m=a[1],d.addEventListener(f,m,w),C=()=>d.removeEventListener(f,m,w),M=!0)},p(n,[a]){1&a&&g.value!==n[0]&&x(g,n[0]),1&a&&j!==(j=!n[0])&&(P.disabled=j)},i:n,o:n,d(n){n&&i(s),M=!1,C()}}}function X(n,a,s){let t;return[t,function(){t=this.value,s(0,t)}]}class nn extends Y{constructor(n){super(),z(this,n,X,Q,p,{})}}function an(n){return T(()=>(setTimeout(()=>{if(window.innerWidth>1080){const n=document.createElement("script");n.async=!0,n.type="text/javascript",n.src="//cdn.carbonads.com/carbon.js?serve=CE7ITK3E&placement=lihautancom",n.id="_carbonads_js",document.body.appendChild(n)}},5e3),()=>{try{const n=document.getElementById("carbonads");n.parentNode.removeChild(n)}catch(n){}})),[]}class sn extends Y{constructor(n){super(),z(this,n,an,null,p,{})}}var tn="https://lihautan.com/i-wrote-my-module-bundler/assets/hero-twitter-01456022.jpg";function en(n,a,s){const t=n.slice();return t[6]=a[s],t}function on(n,a,s){const t=n.slice();return t[6]=a[s],t}function pn(n){let a,s;return{c(){a=d("meta"),this.h()},l(n){a=y(n,"META",{name:!0,content:!0}),this.h()},h(){w(a,"name","keywords"),w(a,"content",s=n[6])},m(n,s){r(n,a,s)},p(n,t){4&t&&s!==(s=n[6])&&w(a,"content",s)},d(n){n&&i(a)}}}function cn(n){let a,s,t=n[6]+"";return{c(){a=d("span"),s=f(t),this.h()},l(n){a=y(n,"SPAN",{class:!0});var e=v(a);s=E(e,t),e.forEach(i),this.h()},h(){w(a,"class","svelte-9tqnza")},m(n,t){r(n,a,t),u(a,s)},p(n,a){4&a&&t!==(t=n[6]+"")&&I(s,t)},d(n){n&&i(a)}}}function ln(n){let a,s,t,e,o,p,h,x,j,A,T,S,L,O,M,C,q,N,R,$,D,H,G,V,z,Y,K,Q,X,an,ln,un,rn,kn,dn,hn,fn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"Article",author:n[3],copyrightHolder:n[3],copyrightYear:"2020",creator:n[3],publisher:n[3],description:n[1],headline:n[0],name:n[0],inLanguage:"en"})}<\/script>`,mn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"BreadcrumbList",description:"Breadcrumbs list",name:"Breadcrumbs",itemListElement:[{"@type":"ListItem",item:{"@id":"https://lihautan.com",name:"Homepage"},position:1},{"@type":"ListItem",item:{"@id":"https%3A%2F%2Flihautan.com%2Fi-wrote-my-module-bundler",name:n[0]},position:2}]})}<\/script>`;document.title=a=n[0]+" | Tan Li Hau";let gn=n[2],wn=[];for(let a=0;a<gn.length;a+=1)wn[a]=pn(on(n,gn,a));G=new Z({});let vn=n[2],yn=[];for(let a=0;a<vn.length;a+=1)yn[a]=cn(en(n,vn,a));const En=n[5].default,bn=function(n,a,s,t){if(n){const e=c(n,a,s,t);return n[0](e)}}(En,n,n[4],null);return rn=new nn({}),dn=new sn({}),{c(){s=d("meta"),t=d("meta"),e=d("meta"),o=d("meta"),p=d("meta"),h=d("meta"),x=d("meta"),j=d("meta"),A=d("meta"),T=d("meta"),S=d("meta");for(let n=0;n<wn.length;n+=1)wn[n].c();L=d("meta"),O=d("meta"),C=g(),N=g(),R=m(),$=d("a"),D=f("Skip to content"),H=m(),J(G.$$.fragment),V=m(),z=d("main"),Y=d("h1"),K=f(n[0]),Q=m();for(let n=0;n<yn.length;n+=1)yn[n].c();X=m(),an=d("article"),bn&&bn.c(),ln=m(),un=d("footer"),J(rn.$$.fragment),kn=m(),J(dn.$$.fragment),this.h()},l(a){const c=function(n,a=document.body){return Array.from(a.querySelectorAll(n))}('[data-svelte="svelte-n0q11s"]',document.head);s=y(c,"META",{name:!0,content:!0}),t=y(c,"META",{name:!0,content:!0}),e=y(c,"META",{name:!0,content:!0}),o=y(c,"META",{name:!0,content:!0}),p=y(c,"META",{name:!0,content:!0}),h=y(c,"META",{name:!0,content:!0}),x=y(c,"META",{name:!0,content:!0}),j=y(c,"META",{name:!0,content:!0}),A=y(c,"META",{name:!0,content:!0}),T=y(c,"META",{name:!0,content:!0}),S=y(c,"META",{name:!0,content:!0});for(let n=0;n<wn.length;n+=1)wn[n].l(c);L=y(c,"META",{itemprop:!0,content:!0}),O=y(c,"META",{itemprop:!0,content:!0}),C=g(),N=g(),c.forEach(i),R=b(a),$=y(a,"A",{href:!0,class:!0});var l=v($);D=E(l,"Skip to content"),l.forEach(i),H=b(a),U(G.$$.fragment,a),V=b(a),z=y(a,"MAIN",{id:!0,class:!0});var u=v(z);Y=y(u,"H1",{});var r=v(Y);K=E(r,n[0]),r.forEach(i),Q=b(u);for(let n=0;n<yn.length;n+=1)yn[n].l(u);X=b(u),an=y(u,"ARTICLE",{});var k=v(an);bn&&bn.l(k),k.forEach(i),u.forEach(i),ln=b(a),un=y(a,"FOOTER",{class:!0});var d=v(un);U(rn.$$.fragment,d),kn=b(d),U(dn.$$.fragment,d),d.forEach(i),this.h()},h(){w(s,"name","description"),w(s,"content",n[1]),w(t,"name","image"),w(t,"content",tn),w(e,"name","og:image"),w(e,"content",tn),w(o,"name","og:title"),w(o,"content",n[0]),w(p,"name","og:description"),w(p,"content",n[1]),w(h,"name","og:type"),w(h,"content","website"),w(x,"name","twitter:card"),w(x,"content","summary_large_image"),w(j,"name","twitter:creator"),w(j,"content","@lihautan"),w(A,"name","twitter:title"),w(A,"content",n[0]),w(T,"name","twitter:description"),w(T,"content",n[1]),w(S,"name","twitter:image"),w(S,"content",tn),w(L,"itemprop","url"),w(L,"content","https%3A%2F%2Flihautan.com%2Fi-wrote-my-module-bundler"),w(O,"itemprop","image"),w(O,"content",tn),M=new P(C),q=new P(N),w($,"href","#content"),w($,"class","skip svelte-9tqnza"),w(z,"id","content"),w(z,"class","blog svelte-9tqnza"),w(un,"class","svelte-9tqnza")},m(n,a){u(document.head,s),u(document.head,t),u(document.head,e),u(document.head,o),u(document.head,p),u(document.head,h),u(document.head,x),u(document.head,j),u(document.head,A),u(document.head,T),u(document.head,S);for(let n=0;n<wn.length;n+=1)wn[n].m(document.head,null);u(document.head,L),u(document.head,O),M.m(fn,document.head),u(document.head,C),q.m(mn,document.head),u(document.head,N),r(n,R,a),r(n,$,a),u($,D),r(n,H,a),W(G,n,a),r(n,V,a),r(n,z,a),u(z,Y),u(Y,K),u(z,Q);for(let n=0;n<yn.length;n+=1)yn[n].m(z,null);u(z,X),u(z,an),bn&&bn.m(an,null),r(n,ln,a),r(n,un,a),W(rn,un,null),u(un,kn),W(dn,un,null),hn=!0},p(n,[t]){if((!hn||1&t)&&a!==(a=n[0]+" | Tan Li Hau")&&(document.title=a),(!hn||2&t)&&w(s,"content",n[1]),(!hn||1&t)&&w(o,"content",n[0]),(!hn||2&t)&&w(p,"content",n[1]),(!hn||1&t)&&w(A,"content",n[0]),(!hn||2&t)&&w(T,"content",n[1]),4&t){let a;for(gn=n[2],a=0;a<gn.length;a+=1){const s=on(n,gn,a);wn[a]?wn[a].p(s,t):(wn[a]=pn(s),wn[a].c(),wn[a].m(L.parentNode,L))}for(;a<wn.length;a+=1)wn[a].d(1);wn.length=gn.length}if((!hn||3&t)&&fn!==(fn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"Article",author:n[3],copyrightHolder:n[3],copyrightYear:"2020",creator:n[3],publisher:n[3],description:n[1],headline:n[0],name:n[0],inLanguage:"en"})}<\/script>`)&&M.p(fn),(!hn||1&t)&&mn!==(mn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"BreadcrumbList",description:"Breadcrumbs list",name:"Breadcrumbs",itemListElement:[{"@type":"ListItem",item:{"@id":"https://lihautan.com",name:"Homepage"},position:1},{"@type":"ListItem",item:{"@id":"https%3A%2F%2Flihautan.com%2Fi-wrote-my-module-bundler",name:n[0]},position:2}]})}<\/script>`)&&q.p(mn),(!hn||1&t)&&I(K,n[0]),4&t){let a;for(vn=n[2],a=0;a<vn.length;a+=1){const s=en(n,vn,a);yn[a]?yn[a].p(s,t):(yn[a]=cn(s),yn[a].c(),yn[a].m(z,X))}for(;a<yn.length;a+=1)yn[a].d(1);yn.length=vn.length}bn&&bn.p&&16&t&&l(bn,En,n,n[4],t,null,null)},i(n){hn||(B(G.$$.fragment,n),B(bn,n),B(rn.$$.fragment,n),B(dn.$$.fragment,n),hn=!0)},o(n){F(G.$$.fragment,n),F(bn,n),F(rn.$$.fragment,n),F(dn.$$.fragment,n),hn=!1},d(n){i(s),i(t),i(e),i(o),i(p),i(h),i(x),i(j),i(A),i(T),i(S),k(wn,n),i(L),i(O),i(C),n&&M.d(),i(N),n&&q.d(),n&&i(R),n&&i($),n&&i(H),_(G,n),n&&i(V),n&&i(z),k(yn,n),bn&&bn.d(n),n&&i(ln),n&&i(un),_(rn),_(dn)}}}function un(n,a,s){let{title:t=""}=a,{description:e=""}=a,{tags:o=[]}=a;const p={"@type":"Person",name:"Tan Li Hau"};let{$$slots:c={},$$scope:l}=a;return n.$set=n=>{"title"in n&&s(0,t=n.title),"description"in n&&s(1,e=n.description),"tags"in n&&s(2,o=n.tags),"$$scope"in n&&s(4,l=n.$$scope)},[t,e,o,p,l,c]}class rn extends Y{constructor(n){super(),z(this,n,un,ln,p,{title:0,description:1,tags:2})}}function kn(a){let s,t,e,o,p,c,l,k,h,g,I,x,P,j,A,T,S,L,O,M,C,q,N,R,$,D,H,G,B,F,J,U,W,_,V,z,Y,K,Z,Q,X,nn,an,sn,tn,en,on,pn,cn,ln,un,rn,kn,dn,hn,fn,mn,gn,wn,vn,yn,En,bn,In,xn,Pn,jn,An,Tn,Sn,Ln,On,Mn,Cn,qn,Nn,Rn,$n,Dn,Hn,Gn,Bn,Fn,Jn,Un,Wn,_n,Vn,zn,Yn,Kn,Zn,Qn,Xn,na,aa,sa,ta,ea,oa,pa,ca,la,ua,ra,ia,ka,da,ha,fa,ma,ga,wa,va,ya,Ea,ba,Ia,xa,Pa,ja,Aa,Ta,Sa,La,Oa,Ma,Ca,qa,Na,Ra,$a,Da,Ha,Ga,Ba,Fa,Ja,Ua,Wa,_a,Va,za,Ya,Ka,Za,Qa,Xa,ns,as,ss,ts,es,os,ps,cs,ls,us,rs,is,ks,ds,hs,fs,ms,gs,ws,vs,ys,Es,bs,Is,xs,Ps,js,As,Ts,Ss,Ls,Os,Ms,Cs,qs,Ns,Rs,$s,Ds,Hs,Gs,Bs,Fs,Js,Us,Ws,_s,Vs,zs,Ys,Ks,Zs,Qs,Xs,nt,at,st,tt,et,ot,pt,ct,lt,ut,rt,it,kt,dt,ht,ft,mt,gt,wt,vt,yt,Et,bt,It,xt,Pt,jt,At,Tt,St,Lt,Ot,Mt,Ct,qt,Nt,Rt,$t,Dt,Ht,Gt,Bt,Ft,Jt,Ut,Wt,_t,Vt,zt,Yt,Kt,Zt,Qt,Xt,ne,ae,se,te,ee,oe,pe,ce,le,ue,re,ie,ke,de,he,fe,me,ge,we,ve,ye,Ee,be,Ie,xe,Pe,je,Ae,Te,Se,Le,Oe,Me,Ce,qe,Ne,Re,$e,De,He,Ge,Be,Fe,Je,Ue,We,_e,Ve,ze,Ye,Ke,Ze,Qe,Xe,no,ao,so,to,eo,oo,po,co,lo,uo,ro,io,ko,ho,fo,mo,go,wo,vo,yo,Eo,bo,Io,xo,Po,jo,Ao,To,So,Lo,Oo,Mo,Co,qo,No,Ro,$o,Do,Ho,Go,Bo,Fo,Jo,Uo,Wo,_o,Vo,zo,Yo,Ko,Zo,Qo,Xo,np,ap,sp,tp,ep,op,pp,cp,lp,up,rp,ip,kp,dp,hp,fp,mp,gp,wp,vp,yp,Ep,bp,Ip,xp,Pp,jp,Ap,Tp,Sp,Lp,Op,Mp,Cp,qp,Np,Rp,$p,Dp,Hp,Gp,Bp,Fp,Jp,Up,Wp,_p,Vp,zp,Yp,Kp,Zp,Qp,Xp,nc,ac,sc,tc,ec,oc,pc,cc,lc,uc,rc,ic,kc,dc,hc,fc,mc,gc,wc,vc,yc,Ec,bc,Ic,xc,Pc,jc,Ac,Tc,Sc,Lc,Oc,Mc,Cc,qc,Nc,Rc,$c,Dc,Hc,Gc,Bc,Fc,Jc,Uc,Wc,_c,Vc,zc,Yc,Kc,Zc,Qc,Xc,nl,al,sl,tl,el,ol,pl,cl,ll,ul,rl,il,kl,dl,hl,fl,ml,gl,wl,vl,yl,El,bl,Il,xl,Pl,jl,Al,Tl,Sl,Ll,Ol,Ml,Cl,ql,Nl,Rl,$l,Dl,Hl,Gl,Bl,Fl,Jl,Ul,Wl,_l,Vl,zl,Yl,Kl,Zl,Ql,Xl,nu,au,su,tu,eu,ou,pu,cu,lu,uu,ru,iu,ku,du,hu,fu,mu,gu,wu,vu,yu,Eu,bu,Iu,xu,Pu,ju,Au,Tu,Su,Lu,Ou,Mu,Cu,qu,Nu,Ru,$u,Du,Hu,Gu,Bu,Fu,Ju,Uu,Wu,_u,Vu,zu,Yu,Ku,Zu,Qu,Xu,nr,ar,sr,tr,er,or,pr,cr,lr,ur,rr,ir,kr,dr,hr,fr,mr,gr,wr,vr,yr,Er,br,Ir,xr,Pr,jr,Ar,Tr,Sr,Lr,Or,Mr,Cr,qr,Nr,Rr,$r,Dr,Hr,Gr,Br,Fr,Jr,Ur,Wr,_r,Vr,zr,Yr,Kr,Zr,Qr,Xr,ni,ai,si,ti,ei,oi,pi,ci,li,ui,ri,ii,ki,di,hi,fi,mi,gi,wi,vi,yi,Ei,bi,Ii,xi,Pi,ji,Ai,Ti,Si,Li,Oi,Mi,Ci,qi,Ni,Ri,$i,Di,Hi,Gi,Bi,Fi,Ji,Ui,Wi,_i,Vi,zi,Yi,Ki,Zi,Qi,Xi,nk,ak,sk,tk,ek,ok,pk,ck,lk,uk,rk,ik,kk,dk,hk,fk,mk,gk,wk,vk,yk,Ek,bk,Ik,xk,Pk,jk,Ak,Tk,Sk,Lk,Ok,Mk,Ck,qk,Nk,Rk,$k,Dk,Hk,Gk,Bk,Fk,Jk,Uk,Wk,_k,Vk,zk,Yk,Kk,Zk,Qk,Xk,nd,ad,sd,td,ed,od,pd,cd,ld,ud,rd,id,kd,dd,hd,fd,md,gd,wd,vd,yd;return{c(){s=d("section"),t=d("ul"),e=d("li"),o=d("a"),p=f("Getting Started"),c=d("ul"),l=d("li"),k=d("a"),h=f("The Input"),g=d("li"),I=d("a"),x=f("Writing"),P=d("li"),j=d("a"),A=f("Resolving"),T=d("li"),S=d("a"),L=f("Bundling"),O=d("ul"),M=d("li"),C=d("a"),q=f("Grouping modules into files"),N=d("li"),R=d("a"),$=f("Creating module map"),D=d("li"),H=d("a"),G=d("li"),B=d("a"),F=f("Optimisation"),J=d("ul"),U=d("li"),W=d("a"),_=f("Circular dependency"),V=d("li"),z=d("a"),Y=f("Summary"),K=d("ul"),Z=d("li"),Q=d("a"),X=f("Whats next?"),nn=d("li"),an=d("a"),sn=f("Further Readings"),tn=m(),en=d("p"),on=f("In my "),pn=d("a"),cn=f("previous article"),ln=f(", I explained how module bundler works. I used "),un=d("a"),rn=f("webpack"),kn=f(" and "),dn=d("a"),hn=f("rollup"),fn=f(" as example, how each of them gave us a different perspective on how we can bundle our JavaScript application."),mn=m(),gn=d("p"),wn=f("In this article, I am going to show you how I wrote my module bundler. The module bundler itself is not production-ready, yet I learned a ton through the exercise, and I am ever more appreciative of what modern module bundlers have provided."),vn=m(),yn=d("hr"),En=m(),bn=d("p"),In=f("‚ö†Ô∏è "),xn=d("strong"),Pn=f("Warning: Tons of JavaScript code ahead. üôàüò±üò®"),jn=f(" ‚ö†Ô∏è"),An=m(),Tn=d("hr"),Sn=m(),Ln=d("section"),On=d("h2"),Mn=d("a"),Cn=f("Getting Started"),qn=m(),Nn=d("p"),Rn=f("I talked about the input (the JavaScript modules) and the output (the bundled JavaScript file) of a module bundler in "),$n=d("a"),Dn=f("my previous article"),Hn=f(". Now it's time to write a module bundler that takes in the input and produces the output."),Gn=m(),Bn=d("p"),Fn=f("A "),Jn=d("em"),Un=f("basic"),Wn=f(" module bundler can be broken down into 2 parts:"),_n=m(),Vn=d("ul"),zn=d("li"),Yn=f("Understands the code and constructs the dependency graph "),Kn=d("strong"),Zn=f("(Dependency Resolution)"),Qn=m(),Xn=d("li"),na=f("Assembles the module into a single (or multiple) JavaScript file "),aa=d("strong"),sa=f("(Bundle)"),ta=m(),ea=d("blockquote"),oa=d("p"),pa=f("A "),ca=d("strong"),la=f("dependency graph"),ua=f(" is a graph representation of the dependency relationship between modules."),ra=m(),ia=d("section"),ka=d("h3"),da=d("a"),ha=f("The Input"),fa=m(),ma=d("p"),ga=f("In this article, I will be using following files as my input to the bundler:"),wa=m(),va=d("pre"),ya=m(),Ea=d("pre"),ba=m(),Ia=d("pre"),xa=m(),Pa=d("p"),ja=f("I've created the project on "),Aa=d("a"),Ta=f("Github"),Sa=f(", so if you are interested to try out yourself, you can clone it and checkout the "),La=d("code"),Oa=f("fixture-1"),Ma=f(" tag. The input files are in the "),Ca=d("code"),qa=f("fixture/"),Na=f(" folder."),Ra=m(),$a=d("section"),Da=d("h2"),Ha=d("a"),Ga=f("Writing"),Ba=m(),Fa=d("p"),Ja=f("I started with the main structure of the module bundler:"),Ua=m(),Wa=d("pre"),_a=m(),Va=d("blockquote"),za=d("p"),Ya=f("The "),Ka=d("strong"),Za=f("dependency graph"),Qa=f(" is a "),Xa=d("a"),ns=f("directed graph"),as=f(", where the vertex is the module, and the directed edge is the dependency relationship between the modules."),ss=m(),ts=d("pre"),es=m(),os=d("p"),ps=f('So, the entry module is "the root" of the graph.'),cs=m(),ls=d("p"),us=f("In "),rs=d("code"),is=f("createModule"),ks=f(", I instantiate a new "),ds=d("code"),hs=f("Module"),fs=f(" instance:"),ms=m(),gs=d("pre"),ws=m(),vs=d("p"),ys=f("The class "),Es=d("code"),bs=f("Module"),Is=f(" will be used to record module properties, such as the content, the dependencies, exported keys, etc."),xs=m(),Ps=d("pre"),js=m(),As=d("p"),Ts=f("While the "),Ss=d("code"),Ls=f("content"),Os=f(" is the string content of the module, to understand what it actually means, I used "),Ms=d("a"),Cs=f("babel"),qs=f(" to "),Ns=d("em"),Rs=f("parse the content"),$s=f(" into AST (Abstract Syntax Tree):"),Ds=m(),Hs=d("pre"),Gs=m(),Bs=d("p"),Fs=f("Next, I need to find out the dependency of this module:"),Js=m(),Us=d("pre"),Ws=m(),_s=d("p"),Vs=f("So, how can I know what are the dependencies of this module?"),zs=m(),Ys=d("p"),Ks=f("I can look for the "),Zs=d("code"),Qs=f("import"),Xs=f(" statement from the AST with the help of the\n"),nt=d("a"),at=f("babel-ast-explorer"),st=f("."),tt=m(),et=d("p"),ot=d("picture"),pt=d("source"),ct=d("source"),lt=d("img"),ut=m(),rt=d("p"),it=f("I found out that the "),kt=d("code"),dt=f("import"),ht=f(" statement in the AST is called the "),ft=d("code"),mt=f("ImportDeclaration"),gt=f(". It has "),wt=d("code"),vt=f("specifiers"),yt=f(" and "),Et=d("code"),bt=f("source"),It=f(", which the "),xt=d("code"),Pt=f("source.value"),jt=f(" tells us what this module is importing from:"),At=m(),Tt=d("pre"),St=m(),Lt=d("p"),Ot=f("So I had the path that the module is requesting, but it could be relative to the current file, eg "),Mt=d("code"),Ct=f('"./foo/bar"'),qt=f(", or from the "),Nt=d("code"),Rt=f("node_modules"),$t=f(", eg: "),Dt=d("code"),Ht=f('"lodash"'),Gt=f(". How do I know what is the "),Bt=d("strong"),Ft=f("actual file path"),Jt=f(" that the module is requesting?"),Ut=m(),Wt=d("p"),_t=f("The step of figuring out the actual path based on the requested path, is called "),Vt=d("strong"),zt=f('"Resolving"'),Yt=f(":"),Kt=m(),Zt=d("pre"),Qt=m(),Xt=d("p"),ne=d("em"),ae=f("Resolving path to the actual file path"),se=m(),te=d("section"),ee=d("h2"),oe=d("a"),pe=f("Resolving"),ce=m(),le=d("p"),ue=f('Let\'s talk about resolving. We know that "import"ing '),re=d("code"),ie=f("./b.js"),ke=f(" in the following examples will result in getting a different file, because when we specify "),de=d("code"),he=f("./"),fe=f(', we are "import"ing relative to the current file.'),me=m(),ge=d("pre"),we=m(),ve=d("pre"),ye=m(),Ee=d("p"),be=f("So, what are the rules of resolving a module?"),Ie=m(),xe=d("p"),Pe=f("The Node.js documentation has listed out the "),je=d("a"),Ae=f("detailed step of the module resolving algorithm"),Te=f(":"),Se=m(),Le=d("p"),Oe=f("When we specify a relative path, "),Me=d("code"),Ce=f("./b"),qe=f(", Node.js will first assume that "),Ne=d("code"),Re=f("./b"),$e=f(" is a file, and tries the following extension if it doesn't exactly match the file name:"),De=m(),He=d("pre"),Ge=m(),Be=d("p"),Fe=f("If the file does not exist, Node.js will then try to treat "),Je=d("code"),Ue=f("./b"),We=f(" as a directory, and try the following:"),_e=m(),Ve=d("pre"),ze=m(),Ye=d("p"),Ke=f("If we specify "),Ze=d("code"),Qe=f("import 'b'"),Xe=f(" instead, Node.js will treat it as a package within "),no=d("code"),ao=f("node_modules/"),so=f(", and have a different resolving strategy."),to=m(),eo=d("p"),oo=f("Through the above illustration, we can see that resolving "),po=d("code"),co=f("import './b'"),lo=f(" is not as simple as it seems. Besides the default Node.js resolving behaviour, "),uo=d("a"),ro=f("webpack provides a lot more customisation options"),io=f(", such as custom extensions, alias, modules folders, etc."),ko=m(),ho=d("p"),fo=f("Here, I am showing you the "),mo=d("em"),go=f('"simplest"'),wo=f(" resolver, which is to resolve relative path only:"),vo=m(),yo=d("pre"),Eo=m(),bo=d("blockquote"),Io=d("small"),xo=f("**Note:** You should try out writing a full node resolvers that resolve relatively as well as absolutely from `node_modules/`"),Po=m(),jo=d("p"),Ao=f("Now I know the actual requested file paths, I then create modules out of them."),To=m(),So=d("pre"),Lo=m(),Oo=d("p"),Mo=f("So, for each module, I find their dependencies, parse them, and find each dependency's dependencies, parse them as well, and find their dependencies, and so forth recursively. At the end of the process, I get a module dependency graph that looks something like this:"),Co=m(),qo=d("pre"),No=m(),Ro=d("p"),$o=f("The root of the graph is our entry module, and you can traverse the graph through the "),Do=d("code"),Ho=f("dependencies"),Go=f(" of the module. As you can see, the "),Bo=d("code"),Fo=f("index.js"),Jo=f(" has 2 dependencies, the "),Uo=d("code"),Wo=f("square.js"),_o=f(" and the "),Vo=d("code"),zo=f("circle.js"),Yo=f("."),Ko=m(),Zo=d("blockquote"),Qo=d("small"),Xo=f("**Note:** If you are following along, you can checkout the tag `feat-1-module-dependency-graph`, to see the code that I had written up till this point."),np=m(),ap=d("section"),sp=d("h2"),tp=d("a"),ep=f("Bundling"),op=m(),pp=d("p"),cp=f("With the module dependency graph, it's time to bundle them into a file!"),lp=m(),up=d("p"),rp=f("At this point in time, we can choose whether we want to bundle it in the "),ip=d("strong"),kp=f('"webpack way"'),dp=f(" or the "),hp=d("strong"),fp=f('"rollup way"'),mp=f(". In this article I am showing you how I did it the "),gp=d("strong"),wp=f('"webpack way"'),vp=f(". I'll write about bundling in the "),yp=d("strong"),Ep=f('"rollup way"'),bp=f(" in the coming article."),Ip=m(),xp=d("blockquote"),Pp=d("p"),jp=f("If you have no idea about what is the "),Ap=d("strong"),Tp=f('"webpack way"'),Sp=f(" or "),Lp=d("strong"),Op=f('"rollup way"'),Mp=f(', I have "coined" the term in my '),Cp=d("a"),qp=f("previous article"),Np=f(" and have detailed explanation about them!"),Rp=m(),$p=d("p"),Dp=f("Let's take a look how the final bundled file would look like:"),Hp=m(),Gp=d("pre"),Bp=m(),Fp=d("p"),Jp=f("Let's break it down to a few steps:"),Up=m(),Wp=d("ul"),_p=d("li"),Vp=d("strong"),zp=f("Group modules into files"),Yp=m(),Kp=d("li"),Zp=d("strong"),Qp=f("Create the module map"),Xp=f(' and wrapping each module in a "special" module factory function'),nc=m(),ac=d("li"),sc=d("strong"),tc=f('Create the "runtime"'),ec=f(", the glue that links each module together."),oc=m(),pc=d("section"),cc=d("h3"),lc=d("a"),uc=f("Grouping modules into files"),rc=m(),ic=d("p"),kc=f("This step is to decide which modules goes to which file. We can split modules into different files because of "),dc=d("a"),hc=f("code splitting"),fc=f(" due to dynamic import as well as optimisation, such as the webpack's "),mc=d("a"),gc=f("Chunk Splitting"),wc=f("."),vc=m(),yc=d("p"),Ec=f("I will support code splitting in the future. For now, I grouped all modules into 1 file."),bc=m(),Ic=d("p"),xc=f("To collect all the modules from module graph into a list of modules, I did a graph traversal:"),Pc=m(),jc=d("pre"),Ac=m(),Tc=d("p"),Sc=f("...and I used the list of modules to create a module map."),Lc=m(),Oc=d("section"),Mc=d("h3"),Cc=d("a"),qc=f("Creating module map"),Nc=m(),Rc=d("p"),$c=f("The module map I created is a string, that would be inlined into the final bundle file."),Dc=m(),Hc=d("p"),Gc=f("I looped through each module, and used "),Bc=d("code"),Fc=f("module.filePath"),Jc=f(" as the key, and "),Uc=d("code"),Wc=f("module.content"),_c=f(" as the value."),Vc=m(),zc=d("p"),Yc=f("The reason I dont use "),Kc=d("code"),Zc=f("JSON.stringify(moduleMap)"),Qc=f(" instead of manually concatenating to build up the module map, is because JSON can only takes in "),Xc=d("a"),nl=f("JSON primitive data type"),al=f(" as value, but what I built here is a JavaScript map, with "),sl=d("code"),tl=f("function"),el=f(" as value, but in string."),ol=m(),pl=d("pre"),cl=m(),ll=d("p"),ul=f("The function that wraps around the "),rl=d("code"),il=f("module.content"),kl=f(" is called the module factory function. It provides 2 parameter to the module:"),dl=m(),hl=d("ul"),fl=d("li"),ml=d("code"),gl=f("exports"),wl=f(", an object that the module can assign its exported value onto"),vl=m(),yl=d("li"),El=d("code"),bl=f("require"),Il=f(", a function that the module can invoke with module path to import exported value from another module"),xl=m(),Pl=d("p"),jl=f("The module map right now is not something that can be executed:"),Al=m(),Tl=d("pre"),Sl=m(),Ll=d("p"),Ol=f("because it still uses "),Ml=d("code"),Cl=f("import"),ql=f(" and "),Nl=d("code"),Rl=f("export"),$l=f(". I had to transform them to use the "),Dl=d("code"),Hl=f("exports"),Gl=f(" and "),Bl=d("code"),Fl=f("require"),Jl=f(" that we pass in."),Ul=m(),Wl=d("p"),_l=f("To transform the code, I used the AST of the module again: trasform the ast and generate the new code from the transformed ast."),Vl=m(),zl=d("p"),Yl=f('What I need is to trasform the "from" to "to" of the following:'),Kl=m(),Zl=d("pre"),Ql=m(),Xl=d("blockquote"),nu=d("p"),au=f("I wrote a "),su=d("a"),tu=f("step by step guide"),eu=f(" on how to write babel transformation, please do check it out."),ou=m(),pu=d("p"),cu=f("Knowing "),lu=d("strong"),uu=f("what to target on AST"),ru=f(" and "),iu=d("strong"),ku=f("how the transformed AST look like"),du=f(", I wrote my transformation code:"),hu=m(),fu=d("pre"),mu=m(),gu=d("p"),wu=f("I omitted the actual babel transformation code, because it is lengthy. If you are interested to read about it, you can check out "),vu=d("a"),yu=f("from my Github repo"),Eu=m(),bu=d("p"),Iu=f("So, now the module map looks ready:"),xu=m(),Pu=d("pre"),ju=m(),Au=d("p"),Tu=f("One thing to take note is that, for the "),Su=d("code"),Lu=f("require"),Ou=f(" statements, I replaced the requested path to the actual resolved path, because I used the actual resolved path as the key to the module map."),Mu=m(),Cu=d("section"),qu=d("h3"),Nu=d("a"),Ru=d("strong"),$u=f('Create the "runtime"'),Du=m(),Hu=d("p"),Gu=f("Now it's time to create the runtime. The runtime is a piece of code that is part of the output bundle, that runs when the application code is running, therefore, the runtime."),Bu=m(),Fu=d("p"),Ju=f("The runtime code can be from a template file, but for simplicity sake, I kept the runtime code as a string:"),Uu=m(),Wu=d("pre"),_u=m(),Vu=d("p"),zu=f("The code above is self explanatory, except if you have no idea what does the "),Yu=d("code"),Ku=f("webpackStart()"),Zu=f(" do, you can read more about it in "),Qu=d("a"),Xu=f("my previous post"),nr=f("."),ar=m(),sr=d("p"),tr=f("Finally, I returned the module code from the "),er=d("code"),or=f("bundle"),pr=f(" function:"),cr=m(),lr=d("pre"),ur=m(),rr=d("p"),ir=f("Now I run my bundler, it generates a "),kr=d("code"),dr=f("output/bundle.js"),hr=f(" file. I run the generated file with node and I see:"),fr=m(),mr=d("pre"),gr=m(),wr=d("p"),vr=f("That's it! A working module bundler!"),yr=m(),Er=d("p"),br=f("Of course, the module bundler I've shown here is "),Ir=d("strong"),xr=f("nowhere near webpack"),Pr=f(". Webpack supports more module system, resolving strategies, loading strategies, plugin system, optimisation, and many many more."),jr=m(),Ar=d("section"),Tr=d("h2"),Sr=d("a"),Lr=f("Optimisation"),Or=m(),Mr=d("p"),Cr=f("I played around my module bundler, and I quickly noticed a bug: "),qr=d("strong"),Nr=f("Circular Dependency"),Rr=f("."),$r=m(),Dr=d("p"),Hr=f("Here's my input files that I've tweaked:"),Gr=m(),Br=d("pre"),Fr=m(),Jr=d("pre"),Ur=m(),Wr=d("p"),_r=f("When I ran it through my module bunlder, immediately it ran into a stack overflow:"),Vr=m(),zr=d("pre"),Yr=m(),Kr=d("section"),Zr=d("h3"),Qr=d("a"),Xr=f("Circular dependency"),ni=m(),ai=d("p"),si=f("There were 2 junctures that the code did recursive traversal which have led to the endless loop:"),ti=m(),ei=d("ul"),oi=d("li"),pi=f("Generating dependency graphs"),ci=m(),li=d("li"),ui=f("Traversing module graph for bundling"),ri=m(),ii=d("pre"),ki=m(),di=d("p"),hi=f("Bundle with the latest code, the stack overflow is gone. However when I executed the output bundle, I saw"),fi=m(),mi=d("pre"),gi=m(),wi=d("p"),vi=f("So I took a look at the output bundle:"),yi=m(),Ei=d("pre"),bi=m(),Ii=d("p"),xi=f("So, the problem is that I destructed "),Pi=d("code"),ji=f("PI"),Ai=f(" from the exports of "),Ti=d("code"),Si=f("index.js"),Li=f(" before it is defined, so naturally "),Oi=d("code"),Mi=f("PI"),Ci=f(" within "),qi=d("code"),Ni=f("circle.js"),Ri=f(" would stay as "),$i=d("code"),Di=f("undefined"),Hi=f(" throughout the application. However before I called "),Gi=d("code"),Bi=f("circleArea"),Fi=f(", we defined "),Ji=d("code"),Ui=f("PI"),Wi=f(" on the "),_i=d("code"),Vi=f("index.js"),zi=f("'s export, I am expecting it to be available."),Yi=m(),Ki=d("p"),Zi=f("So I built my application with webpack and took a look at how webpack solved this problem."),Qi=m(),Xi=d("pre"),nk=m(),ak=d("p"),sk=f("Brilliant! The key is to lazily get the value of "),tk=d("code"),ek=f("PI"),ok=f(" when needed!"),pk=m(),ck=d("p"),lk=f("I changed my babel transformation code, which I am not showing it here. If you are curious enough, you can check out "),uk=d("a"),rk=f("the changes I made from Github"),ik=f("."),kk=m(),dk=d("section"),hk=d("h2"),fk=d("a"),mk=f("Summary"),gk=m(),wk=d("p"),vk=f("There's two phases in module bundling: "),yk=d("strong"),Ek=f("Dependency Resolution"),bk=f(" and "),Ik=d("strong"),xk=f("Bundling"),Pk=f("."),jk=m(),Ak=d("p"),Tk=f("I showed you how I constructed the dependency graph, by finding import statements and resolving modules. I shared how I created module maps and transformed the imports / exports syntax during "),Sk=d("strong"),Lk=f("bundling"),Ok=f(". Lastly, I fixed the circular dependency bug that was in the first version of my module bundler."),Mk=m(),Ck=d("section"),qk=d("h3"),Nk=d("a"),Rk=f("Whats next?"),$k=m(),Dk=d("p"),Hk=f("I have a few ideas that I will add to my module bundler, such as:"),Gk=m(),Bk=d("ul"),Fk=d("li"),Jk=f("code spliting"),Uk=m(),Wk=d("li"),_k=f("watch mode and reloading"),Vk=m(),zk=d("p"),Yk=f("which I will cover them in my next article when they are ready."),Kk=m(),Zk=d("p"),Qk=f("Till then. Cheers. üòé"),Xk=m(),nd=d("section"),ad=d("h2"),sd=d("a"),td=f("Further Readings"),ed=m(),od=d("ul"),pd=d("li"),cd=d("a"),ld=f("Ronen Amiel, Build Your Own Webpack - You Gotta Love Frontend 2018"),ud=m(),rd=d("li"),id=d("a"),kd=f("Luciano Mammino, Unbundling the JavaScript module bundler - DublinJS July 2018"),dd=m(),hd=d("li"),fd=d("a"),md=f("Adam Kelly, Let‚Äôs learn how module bundlers work and then write one ourselves"),gd=m(),wd=d("li"),vd=d("a"),yd=f("Webpack founder Tobias Koppers demos bundling live by hand"),this.h()},l(n){s=y(n,"SECTION",{});var a=v(s);t=y(a,"UL",{class:!0,id:!0,role:!0,"aria-label":!0});var u=v(t);e=y(u,"LI",{});var r=v(e);o=y(r,"A",{href:!0});var d=v(o);p=E(d,"Getting Started"),d.forEach(i),r.forEach(i),c=y(u,"UL",{});var f=v(c);l=y(f,"LI",{});var m=v(l);k=y(m,"A",{href:!0});var w=v(k);h=E(w,"The Input"),w.forEach(i),m.forEach(i),f.forEach(i),g=y(u,"LI",{});var Ed=v(g);I=y(Ed,"A",{href:!0});var bd=v(I);x=E(bd,"Writing"),bd.forEach(i),Ed.forEach(i),P=y(u,"LI",{});var Id=v(P);j=y(Id,"A",{href:!0});var xd=v(j);A=E(xd,"Resolving"),xd.forEach(i),Id.forEach(i),T=y(u,"LI",{});var Pd=v(T);S=y(Pd,"A",{href:!0});var jd=v(S);L=E(jd,"Bundling"),jd.forEach(i),Pd.forEach(i),O=y(u,"UL",{});var Ad=v(O);M=y(Ad,"LI",{});var Td=v(M);C=y(Td,"A",{href:!0});var Sd=v(C);q=E(Sd,"Grouping modules into files"),Sd.forEach(i),Td.forEach(i),N=y(Ad,"LI",{});var Ld=v(N);R=y(Ld,"A",{href:!0});var Od=v(R);$=E(Od,"Creating module map"),Od.forEach(i),Ld.forEach(i),D=y(Ad,"LI",{});var Md=v(D);H=y(Md,"A",{href:!0}),v(H).forEach(i),Md.forEach(i),Ad.forEach(i),G=y(u,"LI",{});var Cd=v(G);B=y(Cd,"A",{href:!0});var qd=v(B);F=E(qd,"Optimisation"),qd.forEach(i),Cd.forEach(i),J=y(u,"UL",{});var Nd=v(J);U=y(Nd,"LI",{});var Rd=v(U);W=y(Rd,"A",{href:!0});var $d=v(W);_=E($d,"Circular dependency"),$d.forEach(i),Rd.forEach(i),Nd.forEach(i),V=y(u,"LI",{});var Dd=v(V);z=y(Dd,"A",{href:!0});var Hd=v(z);Y=E(Hd,"Summary"),Hd.forEach(i),Dd.forEach(i),K=y(u,"UL",{});var Gd=v(K);Z=y(Gd,"LI",{});var Bd=v(Z);Q=y(Bd,"A",{href:!0});var Fd=v(Q);X=E(Fd,"Whats next?"),Fd.forEach(i),Bd.forEach(i),Gd.forEach(i),nn=y(u,"LI",{});var Jd=v(nn);an=y(Jd,"A",{href:!0});var Ud=v(an);sn=E(Ud,"Further Readings"),Ud.forEach(i),Jd.forEach(i),u.forEach(i),a.forEach(i),tn=b(n),en=y(n,"P",{});var Wd=v(en);on=E(Wd,"In my "),pn=y(Wd,"A",{href:!0});var _d=v(pn);cn=E(_d,"previous article"),_d.forEach(i),ln=E(Wd,", I explained how module bundler works. I used "),un=y(Wd,"A",{href:!0,rel:!0});var Vd=v(un);rn=E(Vd,"webpack"),Vd.forEach(i),kn=E(Wd," and "),dn=y(Wd,"A",{href:!0,rel:!0});var zd=v(dn);hn=E(zd,"rollup"),zd.forEach(i),fn=E(Wd," as example, how each of them gave us a different perspective on how we can bundle our JavaScript application."),Wd.forEach(i),mn=b(n),gn=y(n,"P",{});var Yd=v(gn);wn=E(Yd,"In this article, I am going to show you how I wrote my module bundler. The module bundler itself is not production-ready, yet I learned a ton through the exercise, and I am ever more appreciative of what modern module bundlers have provided."),Yd.forEach(i),vn=b(n),yn=y(n,"HR",{}),En=b(n),bn=y(n,"P",{});var Kd=v(bn);In=E(Kd,"‚ö†Ô∏è "),xn=y(Kd,"STRONG",{});var Zd=v(xn);Pn=E(Zd,"Warning: Tons of JavaScript code ahead. üôàüò±üò®"),Zd.forEach(i),jn=E(Kd," ‚ö†Ô∏è"),Kd.forEach(i),An=b(n),Tn=y(n,"HR",{}),Sn=b(n),Ln=y(n,"SECTION",{});var Qd=v(Ln);On=y(Qd,"H2",{});var Xd=v(On);Mn=y(Xd,"A",{href:!0,id:!0});var nh=v(Mn);Cn=E(nh,"Getting Started"),nh.forEach(i),Xd.forEach(i),qn=b(Qd),Nn=y(Qd,"P",{});var ah=v(Nn);Rn=E(ah,"I talked about the input (the JavaScript modules) and the output (the bundled JavaScript file) of a module bundler in "),$n=y(ah,"A",{href:!0});var sh=v($n);Dn=E(sh,"my previous article"),sh.forEach(i),Hn=E(ah,". Now it's time to write a module bundler that takes in the input and produces the output."),ah.forEach(i),Gn=b(Qd),Bn=y(Qd,"P",{});var th=v(Bn);Fn=E(th,"A "),Jn=y(th,"EM",{});var eh=v(Jn);Un=E(eh,"basic"),eh.forEach(i),Wn=E(th," module bundler can be broken down into 2 parts:"),th.forEach(i),_n=b(Qd),Vn=y(Qd,"UL",{});var oh=v(Vn);zn=y(oh,"LI",{});var ph=v(zn);Yn=E(ph,"Understands the code and constructs the dependency graph "),Kn=y(ph,"STRONG",{});var ch=v(Kn);Zn=E(ch,"(Dependency Resolution)"),ch.forEach(i),ph.forEach(i),Qn=b(oh),Xn=y(oh,"LI",{});var lh=v(Xn);na=E(lh,"Assembles the module into a single (or multiple) JavaScript file "),aa=y(lh,"STRONG",{});var uh=v(aa);sa=E(uh,"(Bundle)"),uh.forEach(i),lh.forEach(i),oh.forEach(i),ta=b(Qd),ea=y(Qd,"BLOCKQUOTE",{});var rh=v(ea);oa=y(rh,"P",{});var ih=v(oa);pa=E(ih,"A "),ca=y(ih,"STRONG",{});var kh=v(ca);la=E(kh,"dependency graph"),kh.forEach(i),ua=E(ih," is a graph representation of the dependency relationship between modules."),ih.forEach(i),rh.forEach(i),Qd.forEach(i),ra=b(n),ia=y(n,"SECTION",{});var dh=v(ia);ka=y(dh,"H3",{});var hh=v(ka);da=y(hh,"A",{href:!0,id:!0});var fh=v(da);ha=E(fh,"The Input"),fh.forEach(i),hh.forEach(i),fa=b(dh),ma=y(dh,"P",{});var mh=v(ma);ga=E(mh,"In this article, I will be using following files as my input to the bundler:"),mh.forEach(i),wa=b(dh),va=y(dh,"PRE",{class:!0}),v(va).forEach(i),ya=b(dh),Ea=y(dh,"PRE",{class:!0}),v(Ea).forEach(i),ba=b(dh),Ia=y(dh,"PRE",{class:!0}),v(Ia).forEach(i),xa=b(dh),Pa=y(dh,"P",{});var gh=v(Pa);ja=E(gh,"I've created the project on "),Aa=y(gh,"A",{href:!0,rel:!0});var wh=v(Aa);Ta=E(wh,"Github"),wh.forEach(i),Sa=E(gh,", so if you are interested to try out yourself, you can clone it and checkout the "),La=y(gh,"CODE",{});var vh=v(La);Oa=E(vh,"fixture-1"),vh.forEach(i),Ma=E(gh," tag. The input files are in the "),Ca=y(gh,"CODE",{});var yh=v(Ca);qa=E(yh,"fixture/"),yh.forEach(i),Na=E(gh," folder."),gh.forEach(i),dh.forEach(i),Ra=b(n),$a=y(n,"SECTION",{});var Eh=v($a);Da=y(Eh,"H2",{});var bh=v(Da);Ha=y(bh,"A",{href:!0,id:!0});var Ih=v(Ha);Ga=E(Ih,"Writing"),Ih.forEach(i),bh.forEach(i),Ba=b(Eh),Fa=y(Eh,"P",{});var xh=v(Fa);Ja=E(xh,"I started with the main structure of the module bundler:"),xh.forEach(i),Ua=b(Eh),Wa=y(Eh,"PRE",{class:!0}),v(Wa).forEach(i),_a=b(Eh),Va=y(Eh,"BLOCKQUOTE",{});var Ph=v(Va);za=y(Ph,"P",{});var jh=v(za);Ya=E(jh,"The "),Ka=y(jh,"STRONG",{});var Ah=v(Ka);Za=E(Ah,"dependency graph"),Ah.forEach(i),Qa=E(jh," is a "),Xa=y(jh,"A",{href:!0,rel:!0});var Th=v(Xa);ns=E(Th,"directed graph"),Th.forEach(i),as=E(jh,", where the vertex is the module, and the directed edge is the dependency relationship between the modules."),jh.forEach(i),Ph.forEach(i),ss=b(Eh),ts=y(Eh,"PRE",{class:!0}),v(ts).forEach(i),es=b(Eh),os=y(Eh,"P",{});var Sh=v(os);ps=E(Sh,'So, the entry module is "the root" of the graph.'),Sh.forEach(i),cs=b(Eh),ls=y(Eh,"P",{});var Lh=v(ls);us=E(Lh,"In "),rs=y(Lh,"CODE",{});var Oh=v(rs);is=E(Oh,"createModule"),Oh.forEach(i),ks=E(Lh,", I instantiate a new "),ds=y(Lh,"CODE",{});var Mh=v(ds);hs=E(Mh,"Module"),Mh.forEach(i),fs=E(Lh," instance:"),Lh.forEach(i),ms=b(Eh),gs=y(Eh,"PRE",{class:!0}),v(gs).forEach(i),ws=b(Eh),vs=y(Eh,"P",{});var Ch=v(vs);ys=E(Ch,"The class "),Es=y(Ch,"CODE",{});var qh=v(Es);bs=E(qh,"Module"),qh.forEach(i),Is=E(Ch," will be used to record module properties, such as the content, the dependencies, exported keys, etc."),Ch.forEach(i),xs=b(Eh),Ps=y(Eh,"PRE",{class:!0}),v(Ps).forEach(i),js=b(Eh),As=y(Eh,"P",{});var Nh=v(As);Ts=E(Nh,"While the "),Ss=y(Nh,"CODE",{});var Rh=v(Ss);Ls=E(Rh,"content"),Rh.forEach(i),Os=E(Nh," is the string content of the module, to understand what it actually means, I used "),Ms=y(Nh,"A",{href:!0,rel:!0});var $h=v(Ms);Cs=E($h,"babel"),$h.forEach(i),qs=E(Nh," to "),Ns=y(Nh,"EM",{});var Dh=v(Ns);Rs=E(Dh,"parse the content"),Dh.forEach(i),$s=E(Nh," into AST (Abstract Syntax Tree):"),Nh.forEach(i),Ds=b(Eh),Hs=y(Eh,"PRE",{class:!0}),v(Hs).forEach(i),Gs=b(Eh),Bs=y(Eh,"P",{});var Hh=v(Bs);Fs=E(Hh,"Next, I need to find out the dependency of this module:"),Hh.forEach(i),Js=b(Eh),Us=y(Eh,"PRE",{class:!0}),v(Us).forEach(i),Ws=b(Eh),_s=y(Eh,"P",{});var Gh=v(_s);Vs=E(Gh,"So, how can I know what are the dependencies of this module?"),Gh.forEach(i),zs=b(Eh),Ys=y(Eh,"P",{});var Bh=v(Ys);Ks=E(Bh,"I can look for the "),Zs=y(Bh,"CODE",{});var Fh=v(Zs);Qs=E(Fh,"import"),Fh.forEach(i),Xs=E(Bh," statement from the AST with the help of the\n"),nt=y(Bh,"A",{href:!0,rel:!0});var Jh=v(nt);at=E(Jh,"babel-ast-explorer"),Jh.forEach(i),st=E(Bh,"."),Bh.forEach(i),tt=b(Eh),et=y(Eh,"P",{});var Uh=v(et);ot=y(Uh,"PICTURE",{});var Wh=v(ot);pt=y(Wh,"SOURCE",{type:!0,srcset:!0}),ct=y(Wh,"SOURCE",{type:!0,srcset:!0}),lt=y(Wh,"IMG",{title:!0,alt:!0,"data-src":!0,loading:!0}),Wh.forEach(i),Uh.forEach(i),ut=b(Eh),rt=y(Eh,"P",{});var _h=v(rt);it=E(_h,"I found out that the "),kt=y(_h,"CODE",{});var Vh=v(kt);dt=E(Vh,"import"),Vh.forEach(i),ht=E(_h," statement in the AST is called the "),ft=y(_h,"CODE",{});var zh=v(ft);mt=E(zh,"ImportDeclaration"),zh.forEach(i),gt=E(_h,". It has "),wt=y(_h,"CODE",{});var Yh=v(wt);vt=E(Yh,"specifiers"),Yh.forEach(i),yt=E(_h," and "),Et=y(_h,"CODE",{});var Kh=v(Et);bt=E(Kh,"source"),Kh.forEach(i),It=E(_h,", which the "),xt=y(_h,"CODE",{});var Zh=v(xt);Pt=E(Zh,"source.value"),Zh.forEach(i),jt=E(_h," tells us what this module is importing from:"),_h.forEach(i),At=b(Eh),Tt=y(Eh,"PRE",{class:!0}),v(Tt).forEach(i),St=b(Eh),Lt=y(Eh,"P",{});var Qh=v(Lt);Ot=E(Qh,"So I had the path that the module is requesting, but it could be relative to the current file, eg "),Mt=y(Qh,"CODE",{});var Xh=v(Mt);Ct=E(Xh,'"./foo/bar"'),Xh.forEach(i),qt=E(Qh,", or from the "),Nt=y(Qh,"CODE",{});var nf=v(Nt);Rt=E(nf,"node_modules"),nf.forEach(i),$t=E(Qh,", eg: "),Dt=y(Qh,"CODE",{});var af=v(Dt);Ht=E(af,'"lodash"'),af.forEach(i),Gt=E(Qh,". How do I know what is the "),Bt=y(Qh,"STRONG",{});var sf=v(Bt);Ft=E(sf,"actual file path"),sf.forEach(i),Jt=E(Qh," that the module is requesting?"),Qh.forEach(i),Ut=b(Eh),Wt=y(Eh,"P",{});var tf=v(Wt);_t=E(tf,"The step of figuring out the actual path based on the requested path, is called "),Vt=y(tf,"STRONG",{});var ef=v(Vt);zt=E(ef,'"Resolving"'),ef.forEach(i),Yt=E(tf,":"),tf.forEach(i),Kt=b(Eh),Zt=y(Eh,"PRE",{class:!0}),v(Zt).forEach(i),Qt=b(Eh),Xt=y(Eh,"P",{});var of=v(Xt);ne=y(of,"EM",{});var pf=v(ne);ae=E(pf,"Resolving path to the actual file path"),pf.forEach(i),of.forEach(i),Eh.forEach(i),se=b(n),te=y(n,"SECTION",{});var cf=v(te);ee=y(cf,"H2",{});var lf=v(ee);oe=y(lf,"A",{href:!0,id:!0});var uf=v(oe);pe=E(uf,"Resolving"),uf.forEach(i),lf.forEach(i),ce=b(cf),le=y(cf,"P",{});var rf=v(le);ue=E(rf,'Let\'s talk about resolving. We know that "import"ing '),re=y(rf,"CODE",{});var kf=v(re);ie=E(kf,"./b.js"),kf.forEach(i),ke=E(rf," in the following examples will result in getting a different file, because when we specify "),de=y(rf,"CODE",{});var df=v(de);he=E(df,"./"),df.forEach(i),fe=E(rf,', we are "import"ing relative to the current file.'),rf.forEach(i),me=b(cf),ge=y(cf,"PRE",{class:!0}),v(ge).forEach(i),we=b(cf),ve=y(cf,"PRE",{class:!0}),v(ve).forEach(i),ye=b(cf),Ee=y(cf,"P",{});var hf=v(Ee);be=E(hf,"So, what are the rules of resolving a module?"),hf.forEach(i),Ie=b(cf),xe=y(cf,"P",{});var ff=v(xe);Pe=E(ff,"The Node.js documentation has listed out the "),je=y(ff,"A",{href:!0,rel:!0});var mf=v(je);Ae=E(mf,"detailed step of the module resolving algorithm"),mf.forEach(i),Te=E(ff,":"),ff.forEach(i),Se=b(cf),Le=y(cf,"P",{});var gf=v(Le);Oe=E(gf,"When we specify a relative path, "),Me=y(gf,"CODE",{});var wf=v(Me);Ce=E(wf,"./b"),wf.forEach(i),qe=E(gf,", Node.js will first assume that "),Ne=y(gf,"CODE",{});var vf=v(Ne);Re=E(vf,"./b"),vf.forEach(i),$e=E(gf," is a file, and tries the following extension if it doesn't exactly match the file name:"),gf.forEach(i),De=b(cf),He=y(cf,"PRE",{class:!0}),v(He).forEach(i),Ge=b(cf),Be=y(cf,"P",{});var yf=v(Be);Fe=E(yf,"If the file does not exist, Node.js will then try to treat "),Je=y(yf,"CODE",{});var Ef=v(Je);Ue=E(Ef,"./b"),Ef.forEach(i),We=E(yf," as a directory, and try the following:"),yf.forEach(i),_e=b(cf),Ve=y(cf,"PRE",{class:!0}),v(Ve).forEach(i),ze=b(cf),Ye=y(cf,"P",{});var bf=v(Ye);Ke=E(bf,"If we specify "),Ze=y(bf,"CODE",{});var If=v(Ze);Qe=E(If,"import 'b'"),If.forEach(i),Xe=E(bf," instead, Node.js will treat it as a package within "),no=y(bf,"CODE",{});var xf=v(no);ao=E(xf,"node_modules/"),xf.forEach(i),so=E(bf,", and have a different resolving strategy."),bf.forEach(i),to=b(cf),eo=y(cf,"P",{});var Pf=v(eo);oo=E(Pf,"Through the above illustration, we can see that resolving "),po=y(Pf,"CODE",{});var jf=v(po);co=E(jf,"import './b'"),jf.forEach(i),lo=E(Pf," is not as simple as it seems. Besides the default Node.js resolving behaviour, "),uo=y(Pf,"A",{href:!0,rel:!0});var Af=v(uo);ro=E(Af,"webpack provides a lot more customisation options"),Af.forEach(i),io=E(Pf,", such as custom extensions, alias, modules folders, etc."),Pf.forEach(i),ko=b(cf),ho=y(cf,"P",{});var Tf=v(ho);fo=E(Tf,"Here, I am showing you the "),mo=y(Tf,"EM",{});var Sf=v(mo);go=E(Sf,'"simplest"'),Sf.forEach(i),wo=E(Tf," resolver, which is to resolve relative path only:"),Tf.forEach(i),vo=b(cf),yo=y(cf,"PRE",{class:!0}),v(yo).forEach(i),Eo=b(cf),bo=y(cf,"BLOCKQUOTE",{});var Lf=v(bo);Io=y(Lf,"SMALL",{});var Of=v(Io);xo=E(Of,"**Note:** You should try out writing a full node resolvers that resolve relatively as well as absolutely from `node_modules/`"),Of.forEach(i),Lf.forEach(i),Po=b(cf),jo=y(cf,"P",{});var Mf=v(jo);Ao=E(Mf,"Now I know the actual requested file paths, I then create modules out of them."),Mf.forEach(i),To=b(cf),So=y(cf,"PRE",{class:!0}),v(So).forEach(i),Lo=b(cf),Oo=y(cf,"P",{});var Cf=v(Oo);Mo=E(Cf,"So, for each module, I find their dependencies, parse them, and find each dependency's dependencies, parse them as well, and find their dependencies, and so forth recursively. At the end of the process, I get a module dependency graph that looks something like this:"),Cf.forEach(i),Co=b(cf),qo=y(cf,"PRE",{class:!0}),v(qo).forEach(i),No=b(cf),Ro=y(cf,"P",{});var qf=v(Ro);$o=E(qf,"The root of the graph is our entry module, and you can traverse the graph through the "),Do=y(qf,"CODE",{});var Nf=v(Do);Ho=E(Nf,"dependencies"),Nf.forEach(i),Go=E(qf," of the module. As you can see, the "),Bo=y(qf,"CODE",{});var Rf=v(Bo);Fo=E(Rf,"index.js"),Rf.forEach(i),Jo=E(qf," has 2 dependencies, the "),Uo=y(qf,"CODE",{});var $f=v(Uo);Wo=E($f,"square.js"),$f.forEach(i),_o=E(qf," and the "),Vo=y(qf,"CODE",{});var Df=v(Vo);zo=E(Df,"circle.js"),Df.forEach(i),Yo=E(qf,"."),qf.forEach(i),Ko=b(cf),Zo=y(cf,"BLOCKQUOTE",{});var Hf=v(Zo);Qo=y(Hf,"SMALL",{});var Gf=v(Qo);Xo=E(Gf,"**Note:** If you are following along, you can checkout the tag `feat-1-module-dependency-graph`, to see the code that I had written up till this point."),Gf.forEach(i),Hf.forEach(i),cf.forEach(i),np=b(n),ap=y(n,"SECTION",{});var Bf=v(ap);sp=y(Bf,"H2",{});var Ff=v(sp);tp=y(Ff,"A",{href:!0,id:!0});var Jf=v(tp);ep=E(Jf,"Bundling"),Jf.forEach(i),Ff.forEach(i),op=b(Bf),pp=y(Bf,"P",{});var Uf=v(pp);cp=E(Uf,"With the module dependency graph, it's time to bundle them into a file!"),Uf.forEach(i),lp=b(Bf),up=y(Bf,"P",{});var Wf=v(up);rp=E(Wf,"At this point in time, we can choose whether we want to bundle it in the "),ip=y(Wf,"STRONG",{});var _f=v(ip);kp=E(_f,'"webpack way"'),_f.forEach(i),dp=E(Wf," or the "),hp=y(Wf,"STRONG",{});var Vf=v(hp);fp=E(Vf,'"rollup way"'),Vf.forEach(i),mp=E(Wf,". In this article I am showing you how I did it the "),gp=y(Wf,"STRONG",{});var zf=v(gp);wp=E(zf,'"webpack way"'),zf.forEach(i),vp=E(Wf,". I'll write about bundling in the "),yp=y(Wf,"STRONG",{});var Yf=v(yp);Ep=E(Yf,'"rollup way"'),Yf.forEach(i),bp=E(Wf," in the coming article."),Wf.forEach(i),Ip=b(Bf),xp=y(Bf,"BLOCKQUOTE",{});var Kf=v(xp);Pp=y(Kf,"P",{});var Zf=v(Pp);jp=E(Zf,"If you have no idea about what is the "),Ap=y(Zf,"STRONG",{});var Qf=v(Ap);Tp=E(Qf,'"webpack way"'),Qf.forEach(i),Sp=E(Zf," or "),Lp=y(Zf,"STRONG",{});var Xf=v(Lp);Op=E(Xf,'"rollup way"'),Xf.forEach(i),Mp=E(Zf,', I have "coined" the term in my '),Cp=y(Zf,"A",{href:!0});var nm=v(Cp);qp=E(nm,"previous article"),nm.forEach(i),Np=E(Zf," and have detailed explanation about them!"),Zf.forEach(i),Kf.forEach(i),Rp=b(Bf),$p=y(Bf,"P",{});var am=v($p);Dp=E(am,"Let's take a look how the final bundled file would look like:"),am.forEach(i),Hp=b(Bf),Gp=y(Bf,"PRE",{class:!0}),v(Gp).forEach(i),Bp=b(Bf),Fp=y(Bf,"P",{});var sm=v(Fp);Jp=E(sm,"Let's break it down to a few steps:"),sm.forEach(i),Up=b(Bf),Wp=y(Bf,"UL",{});var tm=v(Wp);_p=y(tm,"LI",{});var em=v(_p);Vp=y(em,"STRONG",{});var om=v(Vp);zp=E(om,"Group modules into files"),om.forEach(i),em.forEach(i),Yp=b(tm),Kp=y(tm,"LI",{});var pm=v(Kp);Zp=y(pm,"STRONG",{});var cm=v(Zp);Qp=E(cm,"Create the module map"),cm.forEach(i),Xp=E(pm,' and wrapping each module in a "special" module factory function'),pm.forEach(i),nc=b(tm),ac=y(tm,"LI",{});var lm=v(ac);sc=y(lm,"STRONG",{});var um=v(sc);tc=E(um,'Create the "runtime"'),um.forEach(i),ec=E(lm,", the glue that links each module together."),lm.forEach(i),tm.forEach(i),Bf.forEach(i),oc=b(n),pc=y(n,"SECTION",{});var rm=v(pc);cc=y(rm,"H3",{});var im=v(cc);lc=y(im,"A",{href:!0,id:!0});var km=v(lc);uc=E(km,"Grouping modules into files"),km.forEach(i),im.forEach(i),rc=b(rm),ic=y(rm,"P",{});var dm=v(ic);kc=E(dm,"This step is to decide which modules goes to which file. We can split modules into different files because of "),dc=y(dm,"A",{href:!0,rel:!0});var hm=v(dc);hc=E(hm,"code splitting"),hm.forEach(i),fc=E(dm," due to dynamic import as well as optimisation, such as the webpack's "),mc=y(dm,"A",{href:!0,rel:!0});var fm=v(mc);gc=E(fm,"Chunk Splitting"),fm.forEach(i),wc=E(dm,"."),dm.forEach(i),vc=b(rm),yc=y(rm,"P",{});var mm=v(yc);Ec=E(mm,"I will support code splitting in the future. For now, I grouped all modules into 1 file."),mm.forEach(i),bc=b(rm),Ic=y(rm,"P",{});var gm=v(Ic);xc=E(gm,"To collect all the modules from module graph into a list of modules, I did a graph traversal:"),gm.forEach(i),Pc=b(rm),jc=y(rm,"PRE",{class:!0}),v(jc).forEach(i),Ac=b(rm),Tc=y(rm,"P",{});var wm=v(Tc);Sc=E(wm,"...and I used the list of modules to create a module map."),wm.forEach(i),rm.forEach(i),Lc=b(n),Oc=y(n,"SECTION",{});var vm=v(Oc);Mc=y(vm,"H3",{});var ym=v(Mc);Cc=y(ym,"A",{href:!0,id:!0});var Em=v(Cc);qc=E(Em,"Creating module map"),Em.forEach(i),ym.forEach(i),Nc=b(vm),Rc=y(vm,"P",{});var bm=v(Rc);$c=E(bm,"The module map I created is a string, that would be inlined into the final bundle file."),bm.forEach(i),Dc=b(vm),Hc=y(vm,"P",{});var Im=v(Hc);Gc=E(Im,"I looped through each module, and used "),Bc=y(Im,"CODE",{});var xm=v(Bc);Fc=E(xm,"module.filePath"),xm.forEach(i),Jc=E(Im," as the key, and "),Uc=y(Im,"CODE",{});var Pm=v(Uc);Wc=E(Pm,"module.content"),Pm.forEach(i),_c=E(Im," as the value."),Im.forEach(i),Vc=b(vm),zc=y(vm,"P",{});var jm=v(zc);Yc=E(jm,"The reason I dont use "),Kc=y(jm,"CODE",{});var Am=v(Kc);Zc=E(Am,"JSON.stringify(moduleMap)"),Am.forEach(i),Qc=E(jm," instead of manually concatenating to build up the module map, is because JSON can only takes in "),Xc=y(jm,"A",{href:!0,rel:!0});var Tm=v(Xc);nl=E(Tm,"JSON primitive data type"),Tm.forEach(i),al=E(jm," as value, but what I built here is a JavaScript map, with "),sl=y(jm,"CODE",{});var Sm=v(sl);tl=E(Sm,"function"),Sm.forEach(i),el=E(jm," as value, but in string."),jm.forEach(i),ol=b(vm),pl=y(vm,"PRE",{class:!0}),v(pl).forEach(i),cl=b(vm),ll=y(vm,"P",{});var Lm=v(ll);ul=E(Lm,"The function that wraps around the "),rl=y(Lm,"CODE",{});var Om=v(rl);il=E(Om,"module.content"),Om.forEach(i),kl=E(Lm," is called the module factory function. It provides 2 parameter to the module:"),Lm.forEach(i),dl=b(vm),hl=y(vm,"UL",{});var Mm=v(hl);fl=y(Mm,"LI",{});var Cm=v(fl);ml=y(Cm,"CODE",{});var qm=v(ml);gl=E(qm,"exports"),qm.forEach(i),wl=E(Cm,", an object that the module can assign its exported value onto"),Cm.forEach(i),vl=b(Mm),yl=y(Mm,"LI",{});var Nm=v(yl);El=y(Nm,"CODE",{});var Rm=v(El);bl=E(Rm,"require"),Rm.forEach(i),Il=E(Nm,", a function that the module can invoke with module path to import exported value from another module"),Nm.forEach(i),Mm.forEach(i),xl=b(vm),Pl=y(vm,"P",{});var $m=v(Pl);jl=E($m,"The module map right now is not something that can be executed:"),$m.forEach(i),Al=b(vm),Tl=y(vm,"PRE",{class:!0}),v(Tl).forEach(i),Sl=b(vm),Ll=y(vm,"P",{});var Dm=v(Ll);Ol=E(Dm,"because it still uses "),Ml=y(Dm,"CODE",{});var Hm=v(Ml);Cl=E(Hm,"import"),Hm.forEach(i),ql=E(Dm," and "),Nl=y(Dm,"CODE",{});var Gm=v(Nl);Rl=E(Gm,"export"),Gm.forEach(i),$l=E(Dm,". I had to transform them to use the "),Dl=y(Dm,"CODE",{});var Bm=v(Dl);Hl=E(Bm,"exports"),Bm.forEach(i),Gl=E(Dm," and "),Bl=y(Dm,"CODE",{});var Fm=v(Bl);Fl=E(Fm,"require"),Fm.forEach(i),Jl=E(Dm," that we pass in."),Dm.forEach(i),Ul=b(vm),Wl=y(vm,"P",{});var Jm=v(Wl);_l=E(Jm,"To transform the code, I used the AST of the module again: trasform the ast and generate the new code from the transformed ast."),Jm.forEach(i),Vl=b(vm),zl=y(vm,"P",{});var Um=v(zl);Yl=E(Um,'What I need is to trasform the "from" to "to" of the following:'),Um.forEach(i),Kl=b(vm),Zl=y(vm,"PRE",{class:!0}),v(Zl).forEach(i),Ql=b(vm),Xl=y(vm,"BLOCKQUOTE",{});var Wm=v(Xl);nu=y(Wm,"P",{});var _m=v(nu);au=E(_m,"I wrote a "),su=y(_m,"A",{href:!0});var Vm=v(su);tu=E(Vm,"step by step guide"),Vm.forEach(i),eu=E(_m," on how to write babel transformation, please do check it out."),_m.forEach(i),Wm.forEach(i),ou=b(vm),pu=y(vm,"P",{});var zm=v(pu);cu=E(zm,"Knowing "),lu=y(zm,"STRONG",{});var Ym=v(lu);uu=E(Ym,"what to target on AST"),Ym.forEach(i),ru=E(zm," and "),iu=y(zm,"STRONG",{});var Km=v(iu);ku=E(Km,"how the transformed AST look like"),Km.forEach(i),du=E(zm,", I wrote my transformation code:"),zm.forEach(i),hu=b(vm),fu=y(vm,"PRE",{class:!0}),v(fu).forEach(i),mu=b(vm),gu=y(vm,"P",{});var Zm=v(gu);wu=E(Zm,"I omitted the actual babel transformation code, because it is lengthy. If you are interested to read about it, you can check out "),vu=y(Zm,"A",{href:!0,rel:!0});var Qm=v(vu);yu=E(Qm,"from my Github repo"),Qm.forEach(i),Zm.forEach(i),Eu=b(vm),bu=y(vm,"P",{});var Xm=v(bu);Iu=E(Xm,"So, now the module map looks ready:"),Xm.forEach(i),xu=b(vm),Pu=y(vm,"PRE",{class:!0}),v(Pu).forEach(i),ju=b(vm),Au=y(vm,"P",{});var ng=v(Au);Tu=E(ng,"One thing to take note is that, for the "),Su=y(ng,"CODE",{});var ag=v(Su);Lu=E(ag,"require"),ag.forEach(i),Ou=E(ng," statements, I replaced the requested path to the actual resolved path, because I used the actual resolved path as the key to the module map."),ng.forEach(i),vm.forEach(i),Mu=b(n),Cu=y(n,"SECTION",{});var sg=v(Cu);qu=y(sg,"H3",{});var tg=v(qu);Nu=y(tg,"A",{href:!0,id:!0});var eg=v(Nu);Ru=y(eg,"STRONG",{});var og=v(Ru);$u=E(og,'Create the "runtime"'),og.forEach(i),eg.forEach(i),tg.forEach(i),Du=b(sg),Hu=y(sg,"P",{});var pg=v(Hu);Gu=E(pg,"Now it's time to create the runtime. The runtime is a piece of code that is part of the output bundle, that runs when the application code is running, therefore, the runtime."),pg.forEach(i),Bu=b(sg),Fu=y(sg,"P",{});var cg=v(Fu);Ju=E(cg,"The runtime code can be from a template file, but for simplicity sake, I kept the runtime code as a string:"),cg.forEach(i),Uu=b(sg),Wu=y(sg,"PRE",{class:!0}),v(Wu).forEach(i),_u=b(sg),Vu=y(sg,"P",{});var lg=v(Vu);zu=E(lg,"The code above is self explanatory, except if you have no idea what does the "),Yu=y(lg,"CODE",{});var ug=v(Yu);Ku=E(ug,"webpackStart()"),ug.forEach(i),Zu=E(lg," do, you can read more about it in "),Qu=y(lg,"A",{href:!0});var rg=v(Qu);Xu=E(rg,"my previous post"),rg.forEach(i),nr=E(lg,"."),lg.forEach(i),ar=b(sg),sr=y(sg,"P",{});var ig=v(sr);tr=E(ig,"Finally, I returned the module code from the "),er=y(ig,"CODE",{});var kg=v(er);or=E(kg,"bundle"),kg.forEach(i),pr=E(ig," function:"),ig.forEach(i),cr=b(sg),lr=y(sg,"PRE",{class:!0}),v(lr).forEach(i),ur=b(sg),rr=y(sg,"P",{});var dg=v(rr);ir=E(dg,"Now I run my bundler, it generates a "),kr=y(dg,"CODE",{});var hg=v(kr);dr=E(hg,"output/bundle.js"),hg.forEach(i),hr=E(dg," file. I run the generated file with node and I see:"),dg.forEach(i),fr=b(sg),mr=y(sg,"PRE",{class:!0}),v(mr).forEach(i),gr=b(sg),wr=y(sg,"P",{});var fg=v(wr);vr=E(fg,"That's it! A working module bundler!"),fg.forEach(i),yr=b(sg),Er=y(sg,"P",{});var mg=v(Er);br=E(mg,"Of course, the module bundler I've shown here is "),Ir=y(mg,"STRONG",{});var gg=v(Ir);xr=E(gg,"nowhere near webpack"),gg.forEach(i),Pr=E(mg,". Webpack supports more module system, resolving strategies, loading strategies, plugin system, optimisation, and many many more."),mg.forEach(i),sg.forEach(i),jr=b(n),Ar=y(n,"SECTION",{});var wg=v(Ar);Tr=y(wg,"H2",{});var vg=v(Tr);Sr=y(vg,"A",{href:!0,id:!0});var yg=v(Sr);Lr=E(yg,"Optimisation"),yg.forEach(i),vg.forEach(i),Or=b(wg),Mr=y(wg,"P",{});var Eg=v(Mr);Cr=E(Eg,"I played around my module bundler, and I quickly noticed a bug: "),qr=y(Eg,"STRONG",{});var bg=v(qr);Nr=E(bg,"Circular Dependency"),bg.forEach(i),Rr=E(Eg,"."),Eg.forEach(i),$r=b(wg),Dr=y(wg,"P",{});var Ig=v(Dr);Hr=E(Ig,"Here's my input files that I've tweaked:"),Ig.forEach(i),Gr=b(wg),Br=y(wg,"PRE",{class:!0}),v(Br).forEach(i),Fr=b(wg),Jr=y(wg,"PRE",{class:!0}),v(Jr).forEach(i),Ur=b(wg),Wr=y(wg,"P",{});var xg=v(Wr);_r=E(xg,"When I ran it through my module bunlder, immediately it ran into a stack overflow:"),xg.forEach(i),Vr=b(wg),zr=y(wg,"PRE",{class:!0}),v(zr).forEach(i),wg.forEach(i),Yr=b(n),Kr=y(n,"SECTION",{});var Pg=v(Kr);Zr=y(Pg,"H3",{});var jg=v(Zr);Qr=y(jg,"A",{href:!0,id:!0});var Ag=v(Qr);Xr=E(Ag,"Circular dependency"),Ag.forEach(i),jg.forEach(i),ni=b(Pg),ai=y(Pg,"P",{});var Tg=v(ai);si=E(Tg,"There were 2 junctures that the code did recursive traversal which have led to the endless loop:"),Tg.forEach(i),ti=b(Pg),ei=y(Pg,"UL",{});var Sg=v(ei);oi=y(Sg,"LI",{});var Lg=v(oi);pi=E(Lg,"Generating dependency graphs"),Lg.forEach(i),ci=b(Sg),li=y(Sg,"LI",{});var Og=v(li);ui=E(Og,"Traversing module graph for bundling"),Og.forEach(i),Sg.forEach(i),ri=b(Pg),ii=y(Pg,"PRE",{class:!0}),v(ii).forEach(i),ki=b(Pg),di=y(Pg,"P",{});var Mg=v(di);hi=E(Mg,"Bundle with the latest code, the stack overflow is gone. However when I executed the output bundle, I saw"),Mg.forEach(i),fi=b(Pg),mi=y(Pg,"PRE",{class:!0}),v(mi).forEach(i),gi=b(Pg),wi=y(Pg,"P",{});var Cg=v(wi);vi=E(Cg,"So I took a look at the output bundle:"),Cg.forEach(i),yi=b(Pg),Ei=y(Pg,"PRE",{class:!0}),v(Ei).forEach(i),bi=b(Pg),Ii=y(Pg,"P",{});var qg=v(Ii);xi=E(qg,"So, the problem is that I destructed "),Pi=y(qg,"CODE",{});var Ng=v(Pi);ji=E(Ng,"PI"),Ng.forEach(i),Ai=E(qg," from the exports of "),Ti=y(qg,"CODE",{});var Rg=v(Ti);Si=E(Rg,"index.js"),Rg.forEach(i),Li=E(qg," before it is defined, so naturally "),Oi=y(qg,"CODE",{});var $g=v(Oi);Mi=E($g,"PI"),$g.forEach(i),Ci=E(qg," within "),qi=y(qg,"CODE",{});var Dg=v(qi);Ni=E(Dg,"circle.js"),Dg.forEach(i),Ri=E(qg," would stay as "),$i=y(qg,"CODE",{});var Hg=v($i);Di=E(Hg,"undefined"),Hg.forEach(i),Hi=E(qg," throughout the application. However before I called "),Gi=y(qg,"CODE",{});var Gg=v(Gi);Bi=E(Gg,"circleArea"),Gg.forEach(i),Fi=E(qg,", we defined "),Ji=y(qg,"CODE",{});var Bg=v(Ji);Ui=E(Bg,"PI"),Bg.forEach(i),Wi=E(qg," on the "),_i=y(qg,"CODE",{});var Fg=v(_i);Vi=E(Fg,"index.js"),Fg.forEach(i),zi=E(qg,"'s export, I am expecting it to be available."),qg.forEach(i),Yi=b(Pg),Ki=y(Pg,"P",{});var Jg=v(Ki);Zi=E(Jg,"So I built my application with webpack and took a look at how webpack solved this problem."),Jg.forEach(i),Qi=b(Pg),Xi=y(Pg,"PRE",{class:!0}),v(Xi).forEach(i),nk=b(Pg),ak=y(Pg,"P",{});var Ug=v(ak);sk=E(Ug,"Brilliant! The key is to lazily get the value of "),tk=y(Ug,"CODE",{});var Wg=v(tk);ek=E(Wg,"PI"),Wg.forEach(i),ok=E(Ug," when needed!"),Ug.forEach(i),pk=b(Pg),ck=y(Pg,"P",{});var _g=v(ck);lk=E(_g,"I changed my babel transformation code, which I am not showing it here. If you are curious enough, you can check out "),uk=y(_g,"A",{href:!0,rel:!0});var Vg=v(uk);rk=E(Vg,"the changes I made from Github"),Vg.forEach(i),ik=E(_g,"."),_g.forEach(i),Pg.forEach(i),kk=b(n),dk=y(n,"SECTION",{});var zg=v(dk);hk=y(zg,"H2",{});var Yg=v(hk);fk=y(Yg,"A",{href:!0,id:!0});var Kg=v(fk);mk=E(Kg,"Summary"),Kg.forEach(i),Yg.forEach(i),gk=b(zg),wk=y(zg,"P",{});var Zg=v(wk);vk=E(Zg,"There's two phases in module bundling: "),yk=y(Zg,"STRONG",{});var Qg=v(yk);Ek=E(Qg,"Dependency Resolution"),Qg.forEach(i),bk=E(Zg," and "),Ik=y(Zg,"STRONG",{});var Xg=v(Ik);xk=E(Xg,"Bundling"),Xg.forEach(i),Pk=E(Zg,"."),Zg.forEach(i),jk=b(zg),Ak=y(zg,"P",{});var nw=v(Ak);Tk=E(nw,"I showed you how I constructed the dependency graph, by finding import statements and resolving modules. I shared how I created module maps and transformed the imports / exports syntax during "),Sk=y(nw,"STRONG",{});var aw=v(Sk);Lk=E(aw,"bundling"),aw.forEach(i),Ok=E(nw,". Lastly, I fixed the circular dependency bug that was in the first version of my module bundler."),nw.forEach(i),zg.forEach(i),Mk=b(n),Ck=y(n,"SECTION",{});var sw=v(Ck);qk=y(sw,"H3",{});var tw=v(qk);Nk=y(tw,"A",{href:!0,id:!0});var ew=v(Nk);Rk=E(ew,"Whats next?"),ew.forEach(i),tw.forEach(i),$k=b(sw),Dk=y(sw,"P",{});var ow=v(Dk);Hk=E(ow,"I have a few ideas that I will add to my module bundler, such as:"),ow.forEach(i),Gk=b(sw),Bk=y(sw,"UL",{});var pw=v(Bk);Fk=y(pw,"LI",{});var cw=v(Fk);Jk=E(cw,"code spliting"),cw.forEach(i),Uk=b(pw),Wk=y(pw,"LI",{});var lw=v(Wk);_k=E(lw,"watch mode and reloading"),lw.forEach(i),pw.forEach(i),Vk=b(sw),zk=y(sw,"P",{});var uw=v(zk);Yk=E(uw,"which I will cover them in my next article when they are ready."),uw.forEach(i),Kk=b(sw),Zk=y(sw,"P",{});var rw=v(Zk);Qk=E(rw,"Till then. Cheers. üòé"),rw.forEach(i),sw.forEach(i),Xk=b(n),nd=y(n,"SECTION",{});var iw=v(nd);ad=y(iw,"H2",{});var kw=v(ad);sd=y(kw,"A",{href:!0,id:!0});var dw=v(sd);td=E(dw,"Further Readings"),dw.forEach(i),kw.forEach(i),ed=b(iw),od=y(iw,"UL",{});var hw=v(od);pd=y(hw,"LI",{});var fw=v(pd);cd=y(fw,"A",{href:!0,rel:!0});var mw=v(cd);ld=E(mw,"Ronen Amiel, Build Your Own Webpack - You Gotta Love Frontend 2018"),mw.forEach(i),fw.forEach(i),ud=b(hw),rd=y(hw,"LI",{});var gw=v(rd);id=y(gw,"A",{href:!0,rel:!0});var ww=v(id);kd=E(ww,"Luciano Mammino, Unbundling the JavaScript module bundler - DublinJS July 2018"),ww.forEach(i),gw.forEach(i),dd=b(hw),hd=y(hw,"LI",{});var vw=v(hd);fd=y(vw,"A",{href:!0,rel:!0});var yw=v(fd);md=E(yw,"Adam Kelly, Let‚Äôs learn how module bundlers work and then write one ourselves"),yw.forEach(i),vw.forEach(i),gd=b(hw),wd=y(hw,"LI",{});var Ew=v(wd);vd=y(Ew,"A",{href:!0,rel:!0});var bw=v(vd);yd=E(bw,"Webpack founder Tobias Koppers demos bundling live by hand"),bw.forEach(i),Ew.forEach(i),hw.forEach(i),iw.forEach(i),this.h()},h(){w(o,"href","#getting-started"),w(k,"href","#the-input"),w(I,"href","#writing"),w(j,"href","#resolving"),w(S,"href","#bundling"),w(C,"href","#grouping-modules-into-files"),w(R,"href","#creating-module-map"),w(H,"href","#"),w(B,"href","#optimisation"),w(W,"href","#circular-dependency"),w(z,"href","#summary"),w(Q,"href","#whats-next"),w(an,"href","#further-readings"),w(t,"class","sitemap"),w(t,"id","sitemap"),w(t,"role","navigation"),w(t,"aria-label","Table of Contents"),w(pn,"href","/what-is-module-bundler-and-how-does-it-work/"),w(un,"href","https://webpack.js.org"),w(un,"rel","nofollow"),w(dn,"href","https://rollupjs.org"),w(dn,"rel","nofollow"),w(Mn,"href","#getting-started"),w(Mn,"id","getting-started"),w($n,"href","/what-is-module-bundler-and-how-does-it-work/"),w(da,"href","#the-input"),w(da,"id","the-input"),w(va,"class","language-js"),w(Ea,"class","language-js"),w(Ia,"class","language-js"),w(Aa,"href","https://github.com/tanhauhau/byo-bundler/tree/master/fixture"),w(Aa,"rel","nofollow"),w(Ha,"href","#writing"),w(Ha,"id","writing"),w(Wa,"class","language-js"),w(Xa,"href","https://en.wikipedia.org/wiki/Directed_graph"),w(Xa,"rel","nofollow"),w(ts,"class","language-js"),w(gs,"class","language-js"),w(Ps,"class","language-js"),w(Ms,"href","http://babeljs.io"),w(Ms,"rel","nofollow"),w(Hs,"class","language-js"),w(Us,"class","language-js"),w(nt,"href","https://lihautan.com/babel-ast-explorer/#?eyJiYWJlbFNldHRpbmdzIjp7InZlcnNpb24iOiI3LjQuNSJ9LCJ0cmVlU2V0dGluZ3MiOnsiaGlkZUVtcHR5Ijp0cnVlLCJoaWRlTG9jYXRpb24iOnRydWUsImhpZGVUeXBlIjp0cnVlfSwiY29kZSI6ImltcG9ydCBzcXVhcmVBcmVhIGZyb20gJy4vc3F1YXJlLmpzJztcbmltcG9ydCBjaXJjbGVBcmVhIGZyb20gJy4vY2lyY2xlLmpzJztcblxuY29uc29sZS5sb2coJ0FyZWEgb2Ygc3F1YXJlOiAnLCBzcXVhcmVBcmVhKDUpKTtcbmNvbnNvbGUubG9nKCdBcmVhIG9mIGNpcmNsZScsIGNpcmNsZUFyZWEoNSkpO1xuIn0="),w(nt,"rel","nofollow"),w(pt,"type","image/webp"),w(pt,"srcset","f635154d6a84f142.webp"),w(ct,"type","image/jpeg"),w(ct,"srcset","f635154d6a84f142.png"),w(lt,"title","Visualizing AST through babel-ast-explorer"),w(lt,"alt","babel-ast-explorer"),w(lt,"data-src","f635154d6a84f142.png"),w(lt,"loading","lazy"),w(Tt,"class","language-js"),w(Zt,"class","language-js"),w(oe,"href","#resolving"),w(oe,"id","resolving"),w(ge,"class","language-js"),w(ve,"class","language-js"),w(je,"href","http://nodejs.org/api/modules.html#modules_all_together"),w(je,"rel","nofollow"),w(He,"class","language-null"),w(Ve,"class","language-null"),w(uo,"href","https://webpack.js.org/configuration/resolve/"),w(uo,"rel","nofollow"),w(yo,"class","language-js"),w(So,"class","language-js"),w(qo,"class","language-js"),w(tp,"href","#bundling"),w(tp,"id","bundling"),w(Cp,"href","/what-is-module-bundler-and-how-does-it-work/"),w(Gp,"class","language-js"),w(lc,"href","#grouping-modules-into-files"),w(lc,"id","grouping-modules-into-files"),w(dc,"href","https://webpack.js.org/guides/code-splitting/"),w(dc,"rel","nofollow"),w(mc,"href","https://webpack.js.org/plugins/split-chunks-plugin/"),w(mc,"rel","nofollow"),w(jc,"class","language-js"),w(Cc,"href","#creating-module-map"),w(Cc,"id","creating-module-map"),w(Xc,"href","https://documentation.progress.com/output/ua/OpenEdge_latest/index.html#page/dvjsn/json-data-types.html"),w(Xc,"rel","nofollow"),w(pl,"class","language-js"),w(Tl,"class","language-js"),w(Zl,"class","language-js"),w(su,"href","/step-by-step-guide-for-writing-a-babel-transformation"),w(fu,"class","language-js"),w(vu,"href","https://github.com/tanhauhau/byo-bundler/blob/feat-2-bundling/src/index.js#L46-L138"),w(vu,"rel","nofollow"),w(Pu,"class","language-js"),w(Nu,"href","#"),w(Nu,"id",""),w(Wu,"class","language-js"),w(Qu,"href","/what-is-module-bundler-and-how-does-it-work/"),w(lr,"class","language-js"),w(mr,"class","language-null"),w(Sr,"href","#optimisation"),w(Sr,"id","optimisation"),w(Br,"class","language-js"),w(Jr,"class","language-js"),w(zr,"class","language-null"),w(Qr,"href","#circular-dependency"),w(Qr,"id","circular-dependency"),w(ii,"class","language-js"),w(mi,"class","language-sh"),w(Ei,"class","language-js"),w(Xi,"class","language-js"),w(uk,"href","https://github.com/tanhauhau/byo-bundler/compare/feat-2-bundling...feat-3-circular-dependency"),w(uk,"rel","nofollow"),w(fk,"href","#summary"),w(fk,"id","summary"),w(Nk,"href","#whats-next"),w(Nk,"id","whats-next"),w(sd,"href","#further-readings"),w(sd,"id","further-readings"),w(cd,"href","https://www.youtube.com/watch?v=Gc9-7PBqOC8"),w(cd,"rel","nofollow"),w(id,"href","https://slides.com/lucianomammino/unbundling-the-javascript-module-bundler-dublinjs"),w(id,"rel","nofollow"),w(fd,"href","https://www.freecodecamp.org/news/lets-learn-how-module-bundlers-work-and-then-write-one-ourselves-b2e3fe6c88ae/"),w(fd,"rel","nofollow"),w(vd,"href","https://www.youtube.com/watch?v=UNMkLHzofQI"),w(vd,"rel","nofollow")},m(n,a){r(n,s,a),u(s,t),u(t,e),u(e,o),u(o,p),u(t,c),u(c,l),u(l,k),u(k,h),u(t,g),u(g,I),u(I,x),u(t,P),u(P,j),u(j,A),u(t,T),u(T,S),u(S,L),u(t,O),u(O,M),u(M,C),u(C,q),u(O,N),u(N,R),u(R,$),u(O,D),u(D,H),u(t,G),u(G,B),u(B,F),u(t,J),u(J,U),u(U,W),u(W,_),u(t,V),u(V,z),u(z,Y),u(t,K),u(K,Z),u(Z,Q),u(Q,X),u(t,nn),u(nn,an),u(an,sn),r(n,tn,a),r(n,en,a),u(en,on),u(en,pn),u(pn,cn),u(en,ln),u(en,un),u(un,rn),u(en,kn),u(en,dn),u(dn,hn),u(en,fn),r(n,mn,a),r(n,gn,a),u(gn,wn),r(n,vn,a),r(n,yn,a),r(n,En,a),r(n,bn,a),u(bn,In),u(bn,xn),u(xn,Pn),u(bn,jn),r(n,An,a),r(n,Tn,a),r(n,Sn,a),r(n,Ln,a),u(Ln,On),u(On,Mn),u(Mn,Cn),u(Ln,qn),u(Ln,Nn),u(Nn,Rn),u(Nn,$n),u($n,Dn),u(Nn,Hn),u(Ln,Gn),u(Ln,Bn),u(Bn,Fn),u(Bn,Jn),u(Jn,Un),u(Bn,Wn),u(Ln,_n),u(Ln,Vn),u(Vn,zn),u(zn,Yn),u(zn,Kn),u(Kn,Zn),u(Vn,Qn),u(Vn,Xn),u(Xn,na),u(Xn,aa),u(aa,sa),u(Ln,ta),u(Ln,ea),u(ea,oa),u(oa,pa),u(oa,ca),u(ca,la),u(oa,ua),r(n,ra,a),r(n,ia,a),u(ia,ka),u(ka,da),u(da,ha),u(ia,fa),u(ia,ma),u(ma,ga),u(ia,wa),u(ia,va),va.innerHTML='<code class="language-js"><span class="token comment">// filename: index.js</span>\n<span class="token keyword">import</span> squareArea <span class="token keyword">from</span> <span class="token string">\'./square.js\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> circleArea <span class="token keyword">from</span> <span class="token string">\'./circle.js\'</span><span class="token punctuation">;</span>\n\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',u(ia,ya),u(ia,Ea),Ea.innerHTML='<code class="language-js"><span class="token comment">// filename: square.js</span>\n<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">side</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> side <span class="token operator">*</span> side<span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span></code>',u(ia,ba),u(ia,Ia),Ia.innerHTML='<code class="language-js"><span class="token comment">// filename: circle.js</span>\n<span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span></code>',u(ia,xa),u(ia,Pa),u(Pa,ja),u(Pa,Aa),u(Aa,Ta),u(Pa,Sa),u(Pa,La),u(La,Oa),u(Pa,Ma),u(Pa,Ca),u(Ca,qa),u(Pa,Na),r(n,Ra,a),r(n,$a,a),u($a,Da),u(Da,Ha),u(Ha,Ga),u($a,Ba),u($a,Fa),u(Fa,Ja),u($a,Ua),u($a,Wa),Wa.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> entryFile<span class="token punctuation">,</span> outputFolder <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// build dependency graph</span>\n  <span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token function">createDependencyGraph</span><span class="token punctuation">(</span>entryFile<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// bundle the asset</span>\n  <span class="token keyword">const</span> outputFiles <span class="token operator">=</span> <span class="token function">bundle</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// write to output folder</span>\n  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> outputFile <span class="token keyword">of</span> outputFiles<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>\n      path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>outputFolder<span class="token punctuation">,</span> outputFile<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>\n      outputFile<span class="token punctuation">.</span>content<span class="token punctuation">,</span>\n      <span class="token string">\'utf-8\'</span>\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',u($a,_a),u($a,Va),u(Va,za),u(za,Ya),u(za,Ka),u(Ka,Za),u(za,Qa),u(za,Xa),u(Xa,ns),u(za,as),u($a,ss),u($a,ts),ts.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">createDependencyGraph</span><span class="token punctuation">(</span><span class="token parameter">entryFile</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> rootModule <span class="token operator">=</span> <span class="token function">createModule</span><span class="token punctuation">(</span>entryFile<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> rootModule<span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',u($a,es),u($a,os),u(os,ps),u($a,cs),u($a,ls),u(ls,us),u(ls,rs),u(rs,is),u(ls,ks),u(ls,ds),u(ds,hs),u(ls,fs),u($a,ms),u($a,gs),gs.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">createModule</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Module</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',u($a,ws),u($a,vs),u(vs,ys),u(vs,Es),u(Es,bs),u(vs,Is),u($a,xs),u($a,Ps),Ps.innerHTML='<code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>filePath <span class="token operator">=</span> filePath<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">\'utf-8\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>dependencies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',u($a,js),u($a,As),u(As,Ts),u(As,Ss),u(Ss,Ls),u(As,Os),u(As,Ms),u(Ms,Cs),u(As,qs),u(As,Ns),u(Ns,Rs),u(As,$s),u($a,Ds),u($a,Hs),Hs.innerHTML='<code class="language-js"><span class="token comment">// highlight-next-line</span>\n<span class="token keyword">const</span> babel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'@babel/core\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>filePath <span class="token operator">=</span> filePath<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">\'utf-8\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// highlight-next-line</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>ast <span class="token operator">=</span> babel<span class="token punctuation">.</span><span class="token function">parseSync</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',u($a,Gs),u($a,Bs),u(Bs,Fs),u($a,Js),u($a,Us),Us.innerHTML='<code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>filePath <span class="token operator">=</span> filePath<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">\'utf-8\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>ast <span class="token operator">=</span> babel<span class="token punctuation">.</span><span class="token function">parseSync</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// highlight-start</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>dependencies <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n  <span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token comment">//</span>\n  <span class="token punctuation">&#125;</span>\n  <span class="token comment">// highlight-end</span>\n<span class="token punctuation">&#125;</span></code>',u($a,Ws),u($a,_s),u(_s,Vs),u($a,zs),u($a,Ys),u(Ys,Ks),u(Ys,Zs),u(Zs,Qs),u(Ys,Xs),u(Ys,nt),u(nt,at),u(Ys,st),u($a,tt),u($a,et),u(et,ot),u(ot,pt),u(ot,ct),u(ot,lt),u($a,ut),u($a,rt),u(rt,it),u(rt,kt),u(kt,dt),u(rt,ht),u(rt,ft),u(ft,mt),u(rt,gt),u(rt,wt),u(wt,vt),u(rt,yt),u(rt,Et),u(Et,bt),u(rt,It),u(rt,xt),u(xt,Pt),u(rt,jt),u($a,At),u($a,Tt),Tt.innerHTML='<code class="language-js"><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// highlight-start</span>\n  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ast<span class="token punctuation">.</span>program<span class="token punctuation">.</span>body\n    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">\'ImportDeclaration\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value<span class="token punctuation">)</span>\n  <span class="token comment">// highlight-end</span>\n<span class="token punctuation">&#125;</span></code>',u($a,St),u($a,Lt),u(Lt,Ot),u(Lt,Mt),u(Mt,Ct),u(Lt,qt),u(Lt,Nt),u(Nt,Rt),u(Lt,$t),u(Lt,Dt),u(Dt,Ht),u(Lt,Gt),u(Lt,Bt),u(Bt,Ft),u(Lt,Jt),u($a,Ut),u($a,Wt),u(Wt,_t),u(Wt,Vt),u(Vt,zt),u(Wt,Yt),u($a,Kt),u($a,Zt),Zt.innerHTML='<code class="language-js"><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ast<span class="token punctuation">.</span>program<span class="token punctuation">.</span>body\n    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">\'ImportDeclaration\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value<span class="token punctuation">)</span>\n  <span class="token comment">// highlight-next-line</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">relativePath</span> <span class="token operator">=></span> <span class="token function">resolveRequest</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>filePath<span class="token punctuation">,</span> relativePath<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">&#125;</span>\n\n<span class="token comment">// highlight-start</span>\n<span class="token comment">// resolving</span>\n<span class="token keyword">function</span> <span class="token function">resolveRequest</span><span class="token punctuation">(</span><span class="token parameter">requester<span class="token punctuation">,</span> requestedPath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">//</span>\n<span class="token punctuation">&#125;</span></code>',u($a,Qt),u($a,Xt),u(Xt,ne),u(ne,ae),r(n,se,a),r(n,te,a),u(te,ee),u(ee,oe),u(oe,pe),u(te,ce),u(te,le),u(le,ue),u(le,re),u(re,ie),u(le,ke),u(le,de),u(de,he),u(le,fe),u(te,me),u(te,ge),ge.innerHTML='<code class="language-js"><span class="token comment">// filename: project/a.js</span>\n<span class="token keyword">import</span> <span class="token string">\'./b.js\'</span><span class="token punctuation">;</span></code>',u(te,we),u(te,ve),ve.innerHTML='<code class="language-js"><span class="token comment">// filename: project/foo/a.js</span>\n<span class="token keyword">import</span> <span class="token string">\'./b.js\'</span><span class="token punctuation">;</span></code>',u(te,ye),u(te,Ee),u(Ee,be),u(te,Ie),u(te,xe),u(xe,Pe),u(xe,je),u(je,Ae),u(xe,Te),u(te,Se),u(te,Le),u(Le,Oe),u(Le,Me),u(Me,Ce),u(Le,qe),u(Le,Ne),u(Ne,Re),u(Le,$e),u(te,De),u(te,He),He.innerHTML='\n<code class="language-">b\nb.js\nb.json\nb.node</code>',u(te,Ge),u(te,Be),u(Be,Fe),u(Be,Je),u(Je,Ue),u(Be,We),u(te,_e),u(te,Ve),Ve.innerHTML='\n<code class="language-">&quot;main&quot; in b/package.json\nb/index.js\nb/index.json\nb/index.node</code>',u(te,ze),u(te,Ye),u(Ye,Ke),u(Ye,Ze),u(Ze,Qe),u(Ye,Xe),u(Ye,no),u(no,ao),u(Ye,so),u(te,to),u(te,eo),u(eo,oo),u(eo,po),u(po,co),u(eo,lo),u(eo,uo),u(uo,ro),u(eo,io),u(te,ko),u(te,ho),u(ho,fo),u(ho,mo),u(mo,go),u(ho,wo),u(te,vo),u(te,yo),yo.innerHTML='<code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'path\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// highlight-start</span>\n<span class="token comment">// resolving</span>\n<span class="token keyword">function</span> <span class="token function">resolveRequest</span><span class="token punctuation">(</span><span class="token parameter">requester<span class="token punctuation">,</span> requestedPath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>requester<span class="token punctuation">)</span><span class="token punctuation">,</span> requestedPath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',u(te,Eo),u(te,bo),u(bo,Io),u(Io,xo),u(te,Po),u(te,jo),u(jo,Ao),u(te,To),u(te,So),So.innerHTML='<code class="language-js"><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ast<span class="token punctuation">.</span>program<span class="token punctuation">.</span>body\n    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">\'ImportDeclaration\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value<span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">relativePath</span> <span class="token operator">=></span> <span class="token function">resolveRequest</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>filePath<span class="token punctuation">,</span> relativePath<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token comment">// highlight-next-line</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">absolutePath</span> <span class="token operator">=></span> <span class="token function">createModule</span><span class="token punctuation">(</span>absolutePath<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">&#125;</span></code>',u(te,Lo),u(te,Oo),u(Oo,Mo),u(te,Co),u(te,qo),qo.innerHTML='<code class="language-js">Module <span class="token punctuation">&#123;</span>\n  filePath<span class="token punctuation">:</span> <span class="token string">\'/Projects/byo-bundler/fixture/index.js\'</span><span class="token punctuation">,</span>\n  content<span class="token punctuation">:</span>\n   <span class="token string">\'import squareArea from \'./square.js\';&#92;nimport circleArea from \'./circle.js\';&#92;n&#92;nconsole.log(\'Area of square: \', squareArea(5));&#92;nconsole.log(\'Area of circle\', circleArea(5));&#92;n\'</span><span class="token punctuation">,</span>\n  ast<span class="token punctuation">:</span>\n   Node <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  dependencies<span class="token punctuation">:</span>\n   <span class="token punctuation">[</span> Module <span class="token punctuation">&#123;</span>\n       filePath<span class="token punctuation">:</span> <span class="token string">\'/Projects/byo-bundler/fixture/square.js\'</span><span class="token punctuation">,</span>\n       content<span class="token punctuation">:</span>\n        <span class="token string">\'function area(side) &#123;&#92;n  return side * side;&#92;n&#125;&#92;nexport default area;&#92;n\'</span><span class="token punctuation">,</span>\n       ast<span class="token punctuation">:</span> Node <span class="token punctuation">&#123;</span><span class="token comment">/* ... */</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n       dependencies<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n     Module <span class="token punctuation">&#123;</span>\n       filePath<span class="token punctuation">:</span> <span class="token string">\'/Projects/byo-bundler/fixture/circle.js\'</span><span class="token punctuation">,</span>\n       content<span class="token punctuation">:</span>\n        <span class="token string">\'const PI = 3.141;&#92;nfunction area(radius) &#123;&#92;n    return PI * radius * radius;&#92;n&#125;&#92;nexport default area;&#92;n\'</span><span class="token punctuation">,</span>\n       ast<span class="token punctuation">:</span> Node <span class="token punctuation">&#123;</span><span class="token comment">/* ... */</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n       dependencies<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n      <span class="token punctuation">&#125;</span>\n   <span class="token punctuation">]</span>\n<span class="token punctuation">&#125;</span></code>',u(te,No),u(te,Ro),u(Ro,$o),u(Ro,Do),u(Do,Ho),u(Ro,Go),u(Ro,Bo),u(Bo,Fo),u(Ro,Jo),u(Ro,Uo),u(Uo,Wo),u(Ro,_o),u(Ro,Vo),u(Vo,zo),u(Ro,Yo),u(te,Ko),u(te,Zo),u(Zo,Qo),u(Qo,Xo),r(n,np,a),r(n,ap,a),u(ap,sp),u(sp,tp),u(tp,ep),u(ap,op),u(ap,pp),u(pp,cp),u(ap,lp),u(ap,up),u(up,rp),u(up,ip),u(ip,kp),u(up,dp),u(up,hp),u(hp,fp),u(up,mp),u(up,gp),u(gp,wp),u(up,vp),u(up,yp),u(yp,Ep),u(up,bp),u(ap,Ip),u(ap,xp),u(xp,Pp),u(Pp,jp),u(Pp,Ap),u(Ap,Tp),u(Pp,Sp),u(Pp,Lp),u(Lp,Op),u(Pp,Mp),u(Pp,Cp),u(Cp,qp),u(Pp,Np),u(ap,Rp),u(ap,$p),u($p,Dp),u(ap,Hp),u(ap,Gp),Gp.innerHTML='<code class="language-js"><span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token punctuation">&#123;</span>\n  <span class="token string">\'circle.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    exports<span class="token punctuation">.</span><span class="token function-variable function">default</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">\'square.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    exports<span class="token punctuation">.</span><span class="token function-variable function">default</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">side</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> side <span class="token operator">*</span> side<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">\'app.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> squareArea <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'square.js\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>\n    <span class="token keyword">const</span> circleArea <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'circle.js\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>\n\n<span class="token function">webpackStart</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>\n  modules<span class="token punctuation">,</span>\n  entry<span class="token punctuation">:</span> <span class="token string">\'app.js\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',u(ap,Bp),u(ap,Fp),u(Fp,Jp),u(ap,Up),u(ap,Wp),u(Wp,_p),u(_p,Vp),u(Vp,zp),u(Wp,Yp),u(Wp,Kp),u(Kp,Zp),u(Zp,Qp),u(Kp,Xp),u(Wp,nc),u(Wp,ac),u(ac,sc),u(sc,tc),u(ac,ec),r(n,oc,a),r(n,pc,a),u(pc,cc),u(cc,lc),u(lc,uc),u(pc,rc),u(pc,ic),u(ic,kc),u(ic,dc),u(dc,hc),u(ic,fc),u(ic,mc),u(mc,gc),u(ic,wc),u(pc,vc),u(pc,yc),u(yc,Ec),u(pc,bc),u(pc,Ic),u(Ic,xc),u(pc,Pc),u(pc,jc),jc.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">bundle</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token function">collectModules</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n\n<span class="token comment">// highlight-start</span>\n<span class="token keyword">function</span> <span class="token function">collectModules</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token function">collect</span><span class="token punctuation">(</span>graph<span class="token punctuation">,</span> modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> modules<span class="token punctuation">;</span>\n\n  <span class="token keyword">function</span> <span class="token function">collect</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> modules</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    modules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    module<span class="token punctuation">.</span>dependencies<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">dependency</span> <span class="token operator">=></span> <span class="token function">collect</span><span class="token punctuation">(</span>dependency<span class="token punctuation">,</span> modules<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',u(pc,Ac),u(pc,Tc),u(Tc,Sc),r(n,Lc,a),r(n,Oc,a),u(Oc,Mc),u(Mc,Cc),u(Cc,qc),u(Oc,Nc),u(Oc,Rc),u(Rc,$c),u(Oc,Dc),u(Oc,Hc),u(Hc,Gc),u(Hc,Bc),u(Bc,Fc),u(Hc,Jc),u(Hc,Uc),u(Uc,Wc),u(Hc,_c),u(Oc,Vc),u(Oc,zc),u(zc,Yc),u(zc,Kc),u(Kc,Zc),u(zc,Qc),u(zc,Xc),u(Xc,nl),u(zc,al),u(zc,sl),u(sl,tl),u(zc,el),u(Oc,ol),u(Oc,pl),pl.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">bundle</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token function">collectModules</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token keyword">const</span> moduleMap <span class="token operator">=</span> <span class="token function">toModuleMap</span><span class="token punctuation">(</span>modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n\n<span class="token comment">// highlight-start</span>\n<span class="token keyword">function</span> <span class="token function">toModuleMap</span><span class="token punctuation">(</span><span class="token parameter">modules</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">let</span> moduleMap <span class="token operator">=</span> <span class="token string">\'\'</span><span class="token punctuation">;</span>\n  moduleMap <span class="token operator">+=</span> <span class="token string">\'&#123;\'</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> module <span class="token keyword">of</span> modules<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    moduleMap <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>module<span class="token punctuation">.</span>filePath<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">": </span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>\n    moduleMap <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">function(exports, require) &#123; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>module<span class="token punctuation">.</span>content<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> &#125;,</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n\n  moduleMap <span class="token operator">+=</span> <span class="token string">\'&#125;\'</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> moduleMap<span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',u(Oc,cl),u(Oc,ll),u(ll,ul),u(ll,rl),u(rl,il),u(ll,kl),u(Oc,dl),u(Oc,hl),u(hl,fl),u(fl,ml),u(ml,gl),u(fl,wl),u(hl,vl),u(hl,yl),u(yl,El),u(El,bl),u(yl,Il),u(Oc,xl),u(Oc,Pl),u(Pl,jl),u(Oc,Al),u(Oc,Tl),Tl.innerHTML='<code class="language-js"><span class="token punctuation">&#123;</span>\n  <span class="token string">"index.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">import</span> squareArea <span class="token keyword">from</span> <span class="token string">\'./square.js\'</span><span class="token punctuation">;</span>\n    <span class="token keyword">import</span> circleArea <span class="token keyword">from</span> <span class="token string">\'./circle.js\'</span><span class="token punctuation">;</span>\n\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">"square.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">side</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> side <span class="token operator">*</span> side<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    <span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">"circle.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    <span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span></code>',u(Oc,Sl),u(Oc,Ll),u(Ll,Ol),u(Ll,Ml),u(Ml,Cl),u(Ll,ql),u(Ll,Nl),u(Nl,Rl),u(Ll,$l),u(Ll,Dl),u(Dl,Hl),u(Ll,Gl),u(Ll,Bl),u(Bl,Fl),u(Ll,Jl),u(Oc,Ul),u(Oc,Wl),u(Wl,_l),u(Oc,Vl),u(Oc,zl),u(zl,Yl),u(Oc,Kl),u(Oc,Zl),Zl.innerHTML='<code class="language-js"><span class="token comment">// #1</span>\n<span class="token comment">// from</span>\n<span class="token keyword">import</span> a<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> b<span class="token punctuation">,</span> c <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">\'foo\'</span><span class="token punctuation">;</span>\n<span class="token comment">// to</span>\n<span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'foo\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// #2</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> a<span class="token punctuation">;</span>\n<span class="token keyword">export</span> <span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n<span class="token keyword">export</span> <span class="token punctuation">&#123;</span> c <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>\n<span class="token comment">// to</span>\nexports<span class="token punctuation">.</span>default <span class="token operator">=</span> a<span class="token punctuation">;</span>\nexports<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>\nexports<span class="token punctuation">.</span>c <span class="token operator">=</span> c<span class="token punctuation">;</span></code>',u(Oc,Ql),u(Oc,Xl),u(Xl,nu),u(nu,au),u(nu,su),u(su,tu),u(nu,eu),u(Oc,ou),u(Oc,pu),u(pu,cu),u(pu,lu),u(lu,uu),u(pu,ru),u(pu,iu),u(iu,ku),u(pu,du),u(Oc,hu),u(Oc,fu),fu.innerHTML='<code class="language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> module <span class="token keyword">of</span> modules<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// highlight-next-line</span>\n  module<span class="token punctuation">.</span><span class="token function">transformModuleInterface</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  moduleMap <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>module<span class="token punctuation">.</span>filePath<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">": function(exports, require) &#123; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>module<span class="token punctuation">.</span>content<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> &#125;,</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="token comment">// ...</span>\n<span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// ...</span>\n  <span class="token comment">// highlight-start</span>\n  <span class="token function">transformModuleInterface</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> ast<span class="token punctuation">,</span> code <span class="token punctuation">&#125;</span> <span class="token operator">=</span> babel<span class="token punctuation">.</span><span class="token function">transformFromAstSync</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ast<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>ast <span class="token operator">=</span> ast<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> code<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n  <span class="token comment">// highlight-end</span>\n<span class="token punctuation">&#125;</span></code>',u(Oc,mu),u(Oc,gu),u(gu,wu),u(gu,vu),u(vu,yu),u(Oc,Eu),u(Oc,bu),u(bu,Iu),u(Oc,xu),u(Oc,Pu),Pu.innerHTML='<code class="language-js"><span class="token punctuation">&#123;</span>\n  <span class="token string">"index.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> squareArea <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'square.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> circleArea <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'circle.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">"square.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">side</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> side <span class="token operator">*</span> side<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    exports<span class="token punctuation">.</span>default <span class="token operator">=</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">"circle.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    exports<span class="token punctuation">.</span>default <span class="token operator">=</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span></code>',u(Oc,ju),u(Oc,Au),u(Au,Tu),u(Au,Su),u(Su,Lu),u(Au,Ou),r(n,Mu,a),r(n,Cu,a),u(Cu,qu),u(qu,Nu),u(Nu,Ru),u(Ru,$u),u(Cu,Du),u(Cu,Hu),u(Hu,Gu),u(Cu,Bu),u(Cu,Fu),u(Fu,Ju),u(Cu,Uu),u(Cu,Wu),Wu.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">bundle</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token function">collectModules</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> moduleMap <span class="token operator">=</span> <span class="token function">toModuleMap</span><span class="token punctuation">(</span>modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token keyword">const</span> moduleCode <span class="token operator">=</span> <span class="token function">addRuntime</span><span class="token punctuation">(</span>moduleMap<span class="token punctuation">,</span> modules<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="token comment">// highlight-start</span>\n<span class="token keyword">function</span> <span class="token function">addRuntime</span><span class="token punctuation">(</span><span class="token parameter">moduleMap<span class="token punctuation">,</span> entryPoint</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">\n    const modules = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>moduleMap<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">;\n    const entry = "</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>entryPoint<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">";\n    function webpackStart(&#123; modules, entry &#125;) &#123;\n      const moduleCache = &#123;&#125;;\n      const require = moduleName => &#123;\n        // if in cache, return the cached version\n        if (moduleCache[moduleName]) &#123;\n          return moduleCache[moduleName];\n        &#125;\n        const exports = &#123;&#125;;\n        // this will prevent infinite "require" loop\n        // from circular dependencies\n        moduleCache[moduleName] = exports;\n    \n        // "require"-ing the module,\n        // exported stuff will assigned to "exports"\n        modules[moduleName](exports, require);\n        return moduleCache[moduleName];\n      &#125;;\n    \n      // start the program\n      require(entry);\n    &#125;\n\n    webpackStart(&#123; modules, entry &#125;);</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n\n<span class="token comment">// trim away spaces before the line</span>\n<span class="token keyword">function</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> lines <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">\'&#92;n\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> padLength <span class="token operator">=</span> lines<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">-</span> lines<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">trimLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>\n  <span class="token keyword">const</span> regex <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">^\\s&#123;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>padLength<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&#125;</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> lines<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">line</span> <span class="token operator">=></span> line<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>regex<span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">\'&#92;n\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',u(Cu,_u),u(Cu,Vu),u(Vu,zu),u(Vu,Yu),u(Yu,Ku),u(Vu,Zu),u(Vu,Qu),u(Qu,Xu),u(Vu,nr),u(Cu,ar),u(Cu,sr),u(sr,tr),u(sr,er),u(er,or),u(sr,pr),u(Cu,cr),u(Cu,lr),lr.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">bundle</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token function">collectModules</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> moduleMap <span class="token operator">=</span> <span class="token function">toModuleMap</span><span class="token punctuation">(</span>modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> moduleCode <span class="token operator">=</span> <span class="token function">addRuntime</span><span class="token punctuation">(</span>moduleMap<span class="token punctuation">,</span> modules<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span> name<span class="token punctuation">:</span> <span class="token string">\'bundle.js\'</span><span class="token punctuation">,</span> content<span class="token punctuation">:</span> moduleCode <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',u(Cu,ur),u(Cu,rr),u(rr,ir),u(rr,kr),u(kr,dr),u(rr,hr),u(Cu,fr),u(Cu,mr),mr.innerHTML='\n<code class="language-">Area of square:  25\nArea of circle 78.525</code>',u(Cu,gr),u(Cu,wr),u(wr,vr),u(Cu,yr),u(Cu,Er),u(Er,br),u(Er,Ir),u(Ir,xr),u(Er,Pr),r(n,jr,a),r(n,Ar,a),u(Ar,Tr),u(Tr,Sr),u(Sr,Lr),u(Ar,Or),u(Ar,Mr),u(Mr,Cr),u(Mr,qr),u(qr,Nr),u(Mr,Rr),u(Ar,$r),u(Ar,Dr),u(Dr,Hr),u(Ar,Gr),u(Ar,Br),Br.innerHTML='<code class="language-js"><span class="token comment">// filename: index.js</span>\n<span class="token keyword">import</span> squareArea <span class="token keyword">from</span> <span class="token string">\'./square.js\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> circleArea <span class="token keyword">from</span> <span class="token string">\'./circle.js\'</span><span class="token punctuation">;</span>\n\n<span class="token comment">// highlight-next-line</span>\n<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',u(Ar,Fr),u(Ar,Jr),Jr.innerHTML='<code class="language-js"><span class="token comment">// filename: circle.js</span>\n<span class="token comment">// highlight-start</span>\n<span class="token comment">// const PI = 3.141;</span>\n<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> <span class="token constant">PI</span> <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">\'./index.js\'</span><span class="token punctuation">;</span>\n<span class="token comment">// highlight-end</span>\n\n<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span></code>',u(Ar,Ur),u(Ar,Wr),u(Wr,_r),u(Ar,Vr),u(Ar,zr),zr.innerHTML='\n<code class="language-">RangeError: Maximum call stack size exceeded</code>',r(n,Yr,a),r(n,Kr,a),u(Kr,Zr),u(Zr,Qr),u(Qr,Xr),u(Kr,ni),u(Kr,ai),u(ai,si),u(Kr,ti),u(Kr,ei),u(ei,oi),u(oi,pi),u(ei,ci),u(ei,li),u(li,ui),u(Kr,ri),u(Kr,ii),ii.innerHTML='<code class="language-js"><span class="token comment">// fixing circular dependencies when generating module graph</span>\n<span class="token comment">// highlight-next-line</span>\n<span class="token keyword">const</span> <span class="token constant">MODULE_CACHE</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">function</span> <span class="token function">createModule</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n <span class="token comment">// highlight-next-line</span>\n <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token constant">MODULE_CACHE</span><span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n   <span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Module</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token comment">// highlight-next-line</span>\n   <span class="token constant">MODULE_CACHE</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> module<span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token comment">// highlight-next-line</span>\n   module<span class="token punctuation">.</span><span class="token function">initDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n <span class="token punctuation">&#125;</span>\n <span class="token comment">// highlight-next-line</span>\n <span class="token keyword">return</span> <span class="token constant">MODULE_CACHE</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token operator">...</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token function">initDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token comment">// highlight-next-line</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>dependencies <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span>\n\n<span class="token comment">// fixing circular dependencies when traversing module graph</span>\n<span class="token keyword">function</span> <span class="token function">collectModules</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">collect</span><span class="token punctuation">(</span>graph<span class="token punctuation">,</span> modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// highlight-next-line</span>\n  <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token comment">// highlight-start</span>\n  <span class="token keyword">function</span> <span class="token function">collect</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> modules</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>modules<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      modules<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      module<span class="token punctuation">.</span>dependencies<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">dependency</span> <span class="token operator">=></span> <span class="token function">collect</span><span class="token punctuation">(</span>dependency<span class="token punctuation">,</span> modules<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',u(Kr,ki),u(Kr,di),u(di,hi),u(Kr,fi),u(Kr,mi),mi.innerHTML='<code class="language-sh">$ node output/bundle.js\nArea of square:  25\nArea of circle NaN</code>',u(Kr,gi),u(Kr,wi),u(wi,vi),u(Kr,yi),u(Kr,Ei),Ei.innerHTML='<code class="language-js"><span class="token punctuation">&#123;</span>\n  <span class="token string">\'index.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> squareArea <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'square.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 1. require circle.js</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> circleArea <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'circle.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 3. define PI on exports</span>\n    exports<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 4. call &#96;circleArea&#96;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">\'circle.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token comment">// 2. at the point of executing this, PI is not yet defined</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token constant">PI</span><span class="token punctuation">:</span> <span class="token constant">PI</span> <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'index.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token comment">// 5. PI is undefined</span>\n      <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    exports<span class="token punctuation">.</span>default <span class="token operator">=</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span></code>',u(Kr,bi),u(Kr,Ii),u(Ii,xi),u(Ii,Pi),u(Pi,ji),u(Ii,Ai),u(Ii,Ti),u(Ti,Si),u(Ii,Li),u(Ii,Oi),u(Oi,Mi),u(Ii,Ci),u(Ii,qi),u(qi,Ni),u(Ii,Ri),u(Ii,$i),u($i,Di),u(Ii,Hi),u(Ii,Gi),u(Gi,Bi),u(Ii,Fi),u(Ii,Ji),u(Ji,Ui),u(Ii,Wi),u(Ii,_i),u(_i,Vi),u(Ii,zi),u(Kr,Yi),u(Kr,Ki),u(Ki,Zi),u(Kr,Qi),u(Kr,Xi),Xi.innerHTML='<code class="language-js"><span class="token punctuation">&#123;</span>\n  <span class="token string">\'index.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> square_import <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'square.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 1. require circle.js</span>\n    <span class="token keyword">const</span> circle_import <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'circle.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 3. define PI on exports</span>\n    exports<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> square_import<span class="token punctuation">[</span><span class="token string">\'default\'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 4. call &#96;circleArea&#96;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> circle_import<span class="token punctuation">[</span><span class="token string">\'default\'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">\'circle.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token comment">// 2. we keep a reference of the &#96;index.js&#96;\'s &#96;exports&#96; object</span>\n    <span class="token keyword">const</span> index_import <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'index.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token comment">// 5. we get PI from the &#96;exports&#96;</span>\n      <span class="token keyword">return</span> index_import<span class="token punctuation">[</span><span class="token string">\'PI\'</span><span class="token punctuation">]</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    exports<span class="token punctuation">.</span>default <span class="token operator">=</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span></code>',u(Kr,nk),u(Kr,ak),u(ak,sk),u(ak,tk),u(tk,ek),u(ak,ok),u(Kr,pk),u(Kr,ck),u(ck,lk),u(ck,uk),u(uk,rk),u(ck,ik),r(n,kk,a),r(n,dk,a),u(dk,hk),u(hk,fk),u(fk,mk),u(dk,gk),u(dk,wk),u(wk,vk),u(wk,yk),u(yk,Ek),u(wk,bk),u(wk,Ik),u(Ik,xk),u(wk,Pk),u(dk,jk),u(dk,Ak),u(Ak,Tk),u(Ak,Sk),u(Sk,Lk),u(Ak,Ok),r(n,Mk,a),r(n,Ck,a),u(Ck,qk),u(qk,Nk),u(Nk,Rk),u(Ck,$k),u(Ck,Dk),u(Dk,Hk),u(Ck,Gk),u(Ck,Bk),u(Bk,Fk),u(Fk,Jk),u(Bk,Uk),u(Bk,Wk),u(Wk,_k),u(Ck,Vk),u(Ck,zk),u(zk,Yk),u(Ck,Kk),u(Ck,Zk),u(Zk,Qk),r(n,Xk,a),r(n,nd,a),u(nd,ad),u(ad,sd),u(sd,td),u(nd,ed),u(nd,od),u(od,pd),u(pd,cd),u(cd,ld),u(od,ud),u(od,rd),u(rd,id),u(id,kd),u(od,dd),u(od,hd),u(hd,fd),u(fd,md),u(od,gd),u(od,wd),u(wd,vd),u(vd,yd)},p:n,d(n){n&&i(s),n&&i(tn),n&&i(en),n&&i(mn),n&&i(gn),n&&i(vn),n&&i(yn),n&&i(En),n&&i(bn),n&&i(An),n&&i(Tn),n&&i(Sn),n&&i(Ln),n&&i(ra),n&&i(ia),n&&i(Ra),n&&i($a),n&&i(se),n&&i(te),n&&i(np),n&&i(ap),n&&i(oc),n&&i(pc),n&&i(Lc),n&&i(Oc),n&&i(Mu),n&&i(Cu),n&&i(jr),n&&i(Ar),n&&i(Yr),n&&i(Kr),n&&i(kk),n&&i(dk),n&&i(Mk),n&&i(Ck),n&&i(Xk),n&&i(nd)}}}function dn(n){let s,t;const e=[hn];let o={$$slots:{default:[kn]},$$scope:{ctx:n}};for(let n=0;n<e.length;n+=1)o=a(o,e[n]);return s=new rn({props:o}),{c(){J(s.$$.fragment)},l(n){U(s.$$.fragment,n)},m(n,a){W(s,n,a),t=!0},p(n,[a]){const t=0&a?function(n,a){const s={},t={},e={$$scope:1};let o=n.length;for(;o--;){const p=n[o],c=a[o];if(c){for(const n in p)n in c||(t[n]=1);for(const n in c)e[n]||(s[n]=c[n],e[n]=1);n[o]=c}else for(const n in p)e[n]=1}for(const n in t)n in s||(s[n]=void 0);return s}(e,[(o=hn,"object"==typeof o&&null!==o?o:{})]):{};var o;1&a&&(t.$$scope={dirty:a,ctx:n}),s.$set(t)},i(n){t||(B(s.$$.fragment,n),t=!0)},o(n){F(s.$$.fragment,n),t=!1},d(n){_(s,n)}}}const hn={title:"I wrote my module bundler",date:"2019-09-18T08:00:00Z",tags:["JavaScript","module bundler","dev tool","webpack"],description:"In my previous article, I explained how module bundler works. In this article, I am going to show you how I wrote my module bundler...",series:"Write a module bundler",slug:"i-wrote-my-module-bundler",type:"blog"};class fn extends Y{constructor(n){super(),z(this,n,null,dn,p,{})}}setTimeout(()=>{new fn({target:document.querySelector("#app"),hydrate:!0});if(document.querySelector(".twitter-tweet")){const n=document.createElement("script");n.async=!0,n.src="https://platform.twitter.com/widgets.js",n.charset="utf-8",document.body.appendChild(n)}},3e3);
