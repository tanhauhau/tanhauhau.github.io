import{s as Ct,d as Ie,e as $t,f as dt,n as Mt}from"../chunks/scheduler.85ImRbsk.js";import{S as Rt,i as Ut,m as kt,n as Pt,o as It,t as St,a as zt,p as qt,e as l,s as n,H as Re,c as a,q as r,h as o,d as Ue,r as ke,g as t,u as Pe,j as s}from"../chunks/index.JMRAb4ib.js";import{g as Et,a as mt}from"../chunks/code-snippet.p32Anx_S.js";import{B as Bt}from"../chunks/BlogLayout.n3Egsk1p.js";import{t as Vt}from"../chunks/twitter-card-image.6izpPI6I.js";const jt=""+new URL("../assets/rebase-8.eFUIJxxp.webp",import.meta.url).href,Ot=""+new URL("../assets/rebase-8._HHuiOti.webp",import.meta.url).href,At=""+new URL("../assets/rebase-8.fmWI52zA.png",import.meta.url).href,_t=""+new URL("../assets/rebase-8.t4hidXIN.png",import.meta.url).href,Dt=""+new URL("../assets/rebase-7.EUrbaiW0.webp",import.meta.url).href,Wt=""+new URL("../assets/rebase-7.piPXCcfe.webp",import.meta.url).href,Zt=""+new URL("../assets/rebase-7.b7ZNX-x1.png",import.meta.url).href,ut=""+new URL("../assets/rebase-7.Uw0LwRak.png",import.meta.url).href,Gt=""+new URL("../assets/rebase-6.BG3Ya10b.webp",import.meta.url).href,Kt=""+new URL("../assets/rebase-6.uS0CmS1x.webp",import.meta.url).href,Nt=""+new URL("../assets/rebase-6.ZANXd54s.png",import.meta.url).href,bt=""+new URL("../assets/rebase-6.QVR0jse-.png",import.meta.url).href,Xt=""+new URL("../assets/rebase-5.iUBLDZ36.webp",import.meta.url).href,Ft=""+new URL("../assets/rebase-5.5w_E109i.webp",import.meta.url).href,Jt=""+new URL("../assets/rebase-5.niqVrJup.png",import.meta.url).href,ft=""+new URL("../assets/rebase-5.1gTfZeRx.png",import.meta.url).href,Yt=""+new URL("../assets/rebase-4.GTVKHcmC.webp",import.meta.url).href,Qt=""+new URL("../assets/rebase-4.Q1FaSnWz.webp",import.meta.url).href,ei=""+new URL("../assets/rebase-4.v5tdM5Fv.png",import.meta.url).href,ht=""+new URL("../assets/rebase-4.ZdYcft2J.png",import.meta.url).href,ti=""+new URL("../assets/rebase-2.tzXfb7rM.webp",import.meta.url).href,ii=""+new URL("../assets/rebase-2.swfIDa7f.webp",import.meta.url).href,si=""+new URL("../assets/rebase-2.E5OVDtwc.png",import.meta.url).href,wt=""+new URL("../assets/rebase-2.oCZu7cG8.png",import.meta.url).href,li=""+new URL("../assets/rebase-1.kRJBmSH3.webp",import.meta.url).href,ai=""+new URL("../assets/rebase-1.yKM5W7Lu.webp",import.meta.url).href,ni=""+new URL("../assets/rebase-1.OrEaNlvX.png",import.meta.url).href,gt=""+new URL("../assets/rebase-1.8ZWsK3Bv.png",import.meta.url).href,oi=""+new URL("../assets/initial.qGb5I-5V.webp",import.meta.url).href,ri=""+new URL("../assets/initial.NjbLjYPF.webp",import.meta.url).href,ci=""+new URL("../assets/initial.MseGAc4g.png",import.meta.url).href,vt=""+new URL("../assets/initial.YyVfuFc5.png",import.meta.url).href;function pi(K){let c,b='Last week, I <a href="/git-gudder/">shared about git commands</a> at <a href="https://github.com/Shopee/shopee-react-knowledgeable" rel="nofollow">Shopee React Knowledgeable</a>. At the end of the talk, one of my colleague approached me and asked me about git rebase. She somehow ended up with a messed up git history with <code class="inline">git rebase</code>, and she couldn&#39;t comprehend how she ended up there.',_,m,p="I found that her scenario was interesting, and decided to write it out here.",d,u,Se="This was what she told me:",N,f,ze='<p>I branched out <code class="inline">feat/a</code> branch from <code class="inline">master</code> and made a few commits (<code class="inline">commit #1</code>, <code class="inline">commit #2</code>).</p> <p>I noticed that master branch has new commits, so I pulled <code class="inline">master</code> branch, and rebased my branch <code class="inline">feat/a</code> onto master branch.</p> <p>Then, instead of <code class="inline">git push --force</code> my local <code class="inline">feat/a</code> to remote <code class="inline">origin</code>, I <code class="inline">git pull --rebase origin feat/a</code>.</p> <p>And, my commits on <code class="inline">feat/a</code>, eg <code class="inline">commit #1</code>, <code class="inline">commit #2</code> were gone!</p>',X,h,qe='So, we expected to see <code class="inline">commit #1</code>, <code class="inline">commit #2</code> at <code class="inline">HEAD</code> after rebasing onto <code class="inline">origin/feat/a</code> after the <code class="inline">git pull --rebase</code>, yet, the only commits we saw were a bunch of commits from the <code class="inline">master</code> branch.',F,w,Ee="To understand what happened, I decided to draw diagrams to visualize what had happened:",J,g,Be=`<span style="display: block; position: relative; padding-top: 126.667%; width: 100%;"><picture><source type="image/webp" srcset="${ri}, ${oi} 2x"/><img src="${vt}" srcset="${vt}, ${ci} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="initil" title="Before rebasing"/></picture></span>`,Y,v,Ve='So, the first thing she did was to <code class="inline">git rebase</code> <code class="inline">feat/a</code> on top of <code class="inline">master</code>:',Q,x,je=`<span style="display: block; position: relative; padding-top: 69.828%; width: 100%;"><picture><source type="image/webp" srcset="${ai}, ${li} 2x"/><img src="${gt}" srcset="${gt}, ${ni} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="first rebase" title="Rebase feat/a on top of master"/></picture></span>`,ee,L,Oe="So far, everything looked normal. The next command was the tricky one.",te,y,Ae='She rebased <code class="inline">feat/a</code> on top of <code class="inline">origin/feat/a</code>, she ran:',ie,T,se,Lt=`<pre class="prism language-"><code><span class="line">$ git checkout feat/a</span>
<span class="line">$ git rebase origin/feat/a</span></code></pre>`,le,H,De='The most important thing on <code class="inline">git rebase</code> is the 3 reference points of rebasing:',ae,C,We=`<span style="display: block; position: relative; padding-top: 69.828%; width: 100%;"><picture><source type="image/webp" srcset="${ii}, ${ti} 2x"/><img src="${wt}" srcset="${wt}, ${si} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="3 reference points" title="The 3 reference points"/></picture></span>`,ne,$,Ze="So, when she typed",oe,M,re,yt='<pre class="prism language-"><code><span class="line">$ git rebase origin/feat/a</span></code></pre>',ce,R,Ge=", it meant:",pe,U,de,Tt='<pre class="prism language-"><code><span class="line">$ git rebase --onto origin/feat/a origin/feat/a feat/a</span></code></pre>',me,k,Ke='<li><code class="inline">new base</code>: <code class="inline">origin/feat/a</code></li> <li><code class="inline">upstream</code>: <code class="inline">origin/feat/a</code></li> <li><code class="inline">branch</code>: <code class="inline">feat/a</code></li>',_e,P,Ne='So what happened was all the commits in master after branching out <code class="inline">feat/a</code> all the way to the newly rebased commits in <code class="inline">feat/a</code> were rebased onto <code class="inline">origin/feat/a</code>:',ue,I,Xe=`<span style="display: block; position: relative; padding-top: 50.625%; width: 100%;"><picture><source type="image/webp" srcset="${Qt}, ${Yt} 2x"/><img src="${ht}" srcset="${ht}, ${ei} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="rebase again"/></picture></span>`,be,S,Fe='However, if you look at the history right now, the commit <code class="inline">commit #1</code> and <code class="inline">commit #2</code> was written twice, first the original commit, second the rebased commit. In cases like this, git would not rewrote the commits again, if git could figure out whether it was a duplicate:',fe,z,Je=`<span style="display: block; position: relative; padding-top: 68.644%; width: 100%;"><picture><source type="image/webp" srcset="${Ft}, ${Xt} 2x"/><img src="${ft}" srcset="${ft}, ${Jt} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="actual rebase again result"/></picture></span>`,he,q,Ye='It was as though both commit <code class="inline">commit #1</code> and <code class="inline">commit #2</code> were gone, and left with commits from <code class="inline">master</code> branch, because git did not rewrote them when rebasing <code class="inline">feat/a</code>. And actually the changes made in <code class="inline">commit #1</code> and <code class="inline">commit #2</code> were still available.',we,E,Qe='<p>You can read more about this behaviour in <a href="https://git-scm.com/book/en/v2/Git-Branching-Rebasing#_rebase_rebase" rel="nofollow">git&#39;s documentation</a></p>',ge,B,et='So, what she should have done if she wanted to actually rebased the local <code class="inline">feat/a</code> on top of <code class="inline">origin/feat/a</code>, especially after she made another commit, <code class="inline">commit #0</code>?',ve,V,tt=`<span style="display: block; position: relative; padding-top: 58.273%; width: 100%;"><picture><source type="image/webp" srcset="${Kt}, ${Gt} 2x"/><img src="${bt}" srcset="${bt}, ${Nt} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="adding one more commit"/></picture></span>`,xe,j,it='Well, she should specify the <code class="inline">&lt;upstream&gt;</code> reference point:',Le,O,st=`<span style="display: block; position: relative; padding-top: 57.042%; width: 100%;"><picture><source type="image/webp" srcset="${Wt}, ${Dt} 2x"/><img src="${ut}" srcset="${ut}, ${Zt} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="reference points"/></picture></span>`,ye,A,Te,Ht='<pre class="prism language-"><code><span class="line">$ git rebase --onto origin/feat/a master feat/a</span></code></pre>',He,D,lt="And you would get:",Ce,W,at=`<span style="display: block; position: relative; padding-top: 60.902%; width: 100%;"><picture><source type="image/webp" srcset="${Ot}, ${jt} 2x"/><img src="${_t}" srcset="${_t}, ${At} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="result"/></picture></span>`,$e,Z,nt='Here again, git is smart enough not to rewrite <code class="inline">commit #1</code> and <code class="inline">commit #2</code>.',Me,G,ot='<h2><a href="#summary" id="summary">Summary</a></h2> <p>When using <code class="inline">git rebase</code>, always remember the 3 reference points of rebase, the <code class="inline">new base</code>, <code class="inline">upstream</code> and <code class="inline">branch</code>.</p>';return{c(){c=l("p"),c.innerHTML=b,_=n(),m=l("p"),m.textContent=p,d=n(),u=l("p"),u.textContent=Se,N=n(),f=l("blockquote"),f.innerHTML=ze,X=n(),h=l("p"),h.innerHTML=qe,F=n(),w=l("p"),w.textContent=Ee,J=n(),g=l("p"),g.innerHTML=Be,Y=n(),v=l("p"),v.innerHTML=Ve,Q=n(),x=l("p"),x.innerHTML=je,ee=n(),L=l("p"),L.textContent=Oe,te=n(),y=l("p"),y.innerHTML=Ae,ie=n(),T=l("div"),se=new Re(!1),le=n(),H=l("p"),H.innerHTML=De,ae=n(),C=l("p"),C.innerHTML=We,ne=n(),$=l("p"),$.textContent=Ze,oe=n(),M=l("div"),re=new Re(!1),ce=n(),R=l("p"),R.textContent=Ge,pe=n(),U=l("div"),de=new Re(!1),me=n(),k=l("ul"),k.innerHTML=Ke,_e=n(),P=l("p"),P.innerHTML=Ne,ue=n(),I=l("p"),I.innerHTML=Xe,be=n(),S=l("p"),S.innerHTML=Fe,fe=n(),z=l("p"),z.innerHTML=Je,he=n(),q=l("p"),q.innerHTML=Ye,we=n(),E=l("blockquote"),E.innerHTML=Qe,ge=n(),B=l("p"),B.innerHTML=et,ve=n(),V=l("p"),V.innerHTML=tt,xe=n(),j=l("p"),j.innerHTML=it,Le=n(),O=l("p"),O.innerHTML=st,ye=n(),A=l("div"),Te=new Re(!1),He=n(),D=l("p"),D.textContent=lt,Ce=n(),W=l("p"),W.innerHTML=at,$e=n(),Z=l("p"),Z.innerHTML=nt,Me=n(),G=l("section"),G.innerHTML=ot,this.h()},l(e){c=a(e,"P",{"data-svelte-h":!0}),r(c)!=="svelte-qzzab7"&&(c.innerHTML=b),_=o(e),m=a(e,"P",{"data-svelte-h":!0}),r(m)!=="svelte-1ovu1he"&&(m.textContent=p),d=o(e),u=a(e,"P",{"data-svelte-h":!0}),r(u)!=="svelte-e5prac"&&(u.textContent=Se),N=o(e),f=a(e,"BLOCKQUOTE",{"data-svelte-h":!0}),r(f)!=="svelte-a2nrkt"&&(f.innerHTML=ze),X=o(e),h=a(e,"P",{"data-svelte-h":!0}),r(h)!=="svelte-j7otx6"&&(h.innerHTML=qe),F=o(e),w=a(e,"P",{"data-svelte-h":!0}),r(w)!=="svelte-309l1l"&&(w.textContent=Ee),J=o(e),g=a(e,"P",{"data-svelte-h":!0}),r(g)!=="svelte-kib43k"&&(g.innerHTML=Be),Y=o(e),v=a(e,"P",{"data-svelte-h":!0}),r(v)!=="svelte-qcb2e"&&(v.innerHTML=Ve),Q=o(e),x=a(e,"P",{"data-svelte-h":!0}),r(x)!=="svelte-og6vk0"&&(x.innerHTML=je),ee=o(e),L=a(e,"P",{"data-svelte-h":!0}),r(L)!=="svelte-10uom1e"&&(L.textContent=Oe),te=o(e),y=a(e,"P",{"data-svelte-h":!0}),r(y)!=="svelte-1grd3vf"&&(y.innerHTML=Ae),ie=o(e),T=a(e,"DIV",{class:!0});var i=Ue(T);se=ke(i,!1),i.forEach(t),le=o(e),H=a(e,"P",{"data-svelte-h":!0}),r(H)!=="svelte-pxy4l4"&&(H.innerHTML=De),ae=o(e),C=a(e,"P",{"data-svelte-h":!0}),r(C)!=="svelte-cvggch"&&(C.innerHTML=We),ne=o(e),$=a(e,"P",{"data-svelte-h":!0}),r($)!=="svelte-3vd5d4"&&($.textContent=Ze),oe=o(e),M=a(e,"DIV",{class:!0});var rt=Ue(M);re=ke(rt,!1),rt.forEach(t),ce=o(e),R=a(e,"P",{"data-svelte-h":!0}),r(R)!=="svelte-1391g6c"&&(R.textContent=Ge),pe=o(e),U=a(e,"DIV",{class:!0});var ct=Ue(U);de=ke(ct,!1),ct.forEach(t),me=o(e),k=a(e,"UL",{"data-svelte-h":!0}),r(k)!=="svelte-orneup"&&(k.innerHTML=Ke),_e=o(e),P=a(e,"P",{"data-svelte-h":!0}),r(P)!=="svelte-1gqbrnd"&&(P.innerHTML=Ne),ue=o(e),I=a(e,"P",{"data-svelte-h":!0}),r(I)!=="svelte-2n3k69"&&(I.innerHTML=Xe),be=o(e),S=a(e,"P",{"data-svelte-h":!0}),r(S)!=="svelte-19cjc2l"&&(S.innerHTML=Fe),fe=o(e),z=a(e,"P",{"data-svelte-h":!0}),r(z)!=="svelte-1p31m79"&&(z.innerHTML=Je),he=o(e),q=a(e,"P",{"data-svelte-h":!0}),r(q)!=="svelte-1bar42i"&&(q.innerHTML=Ye),we=o(e),E=a(e,"BLOCKQUOTE",{"data-svelte-h":!0}),r(E)!=="svelte-7q0jkb"&&(E.innerHTML=Qe),ge=o(e),B=a(e,"P",{"data-svelte-h":!0}),r(B)!=="svelte-5q50bn"&&(B.innerHTML=et),ve=o(e),V=a(e,"P",{"data-svelte-h":!0}),r(V)!=="svelte-1nkel07"&&(V.innerHTML=tt),xe=o(e),j=a(e,"P",{"data-svelte-h":!0}),r(j)!=="svelte-7fdemh"&&(j.innerHTML=it),Le=o(e),O=a(e,"P",{"data-svelte-h":!0}),r(O)!=="svelte-1rovohc"&&(O.innerHTML=st),ye=o(e),A=a(e,"DIV",{class:!0});var pt=Ue(A);Te=ke(pt,!1),pt.forEach(t),He=o(e),D=a(e,"P",{"data-svelte-h":!0}),r(D)!=="svelte-1r9fydh"&&(D.textContent=lt),Ce=o(e),W=a(e,"P",{"data-svelte-h":!0}),r(W)!=="svelte-aoe7qx"&&(W.innerHTML=at),$e=o(e),Z=a(e,"P",{"data-svelte-h":!0}),r(Z)!=="svelte-upmytj"&&(Z.innerHTML=nt),Me=o(e),G=a(e,"SECTION",{"data-svelte-h":!0}),r(G)!=="svelte-1mez009"&&(G.innerHTML=ot),this.h()},h(){se.a=null,Pe(T,"class","code-section"),re.a=null,Pe(M,"class","code-section"),de.a=null,Pe(U,"class","code-section"),Te.a=null,Pe(A,"class","code-section")},m(e,i){s(e,c,i),s(e,_,i),s(e,m,i),s(e,d,i),s(e,u,i),s(e,N,i),s(e,f,i),s(e,X,i),s(e,h,i),s(e,F,i),s(e,w,i),s(e,J,i),s(e,g,i),s(e,Y,i),s(e,v,i),s(e,Q,i),s(e,x,i),s(e,ee,i),s(e,L,i),s(e,te,i),s(e,y,i),s(e,ie,i),s(e,T,i),se.m(Lt,T),s(e,le,i),s(e,H,i),s(e,ae,i),s(e,C,i),s(e,ne,i),s(e,$,i),s(e,oe,i),s(e,M,i),re.m(yt,M),s(e,ce,i),s(e,R,i),s(e,pe,i),s(e,U,i),de.m(Tt,U),s(e,me,i),s(e,k,i),s(e,_e,i),s(e,P,i),s(e,ue,i),s(e,I,i),s(e,be,i),s(e,S,i),s(e,fe,i),s(e,z,i),s(e,he,i),s(e,q,i),s(e,we,i),s(e,E,i),s(e,ge,i),s(e,B,i),s(e,ve,i),s(e,V,i),s(e,xe,i),s(e,j,i),s(e,Le,i),s(e,O,i),s(e,ye,i),s(e,A,i),Te.m(Ht,A),s(e,He,i),s(e,D,i),s(e,Ce,i),s(e,W,i),s(e,$e,i),s(e,Z,i),s(e,Me,i),s(e,G,i)},p:Mt,d(e){e&&(t(c),t(_),t(m),t(d),t(u),t(N),t(f),t(X),t(h),t(F),t(w),t(J),t(g),t(Y),t(v),t(Q),t(x),t(ee),t(L),t(te),t(y),t(ie),t(T),t(le),t(H),t(ae),t(C),t(ne),t($),t(oe),t(M),t(ce),t(R),t(pe),t(U),t(me),t(k),t(_e),t(P),t(ue),t(I),t(be),t(S),t(fe),t(z),t(he),t(q),t(we),t(E),t(ge),t(B),t(ve),t(V),t(xe),t(j),t(Le),t(O),t(ye),t(A),t(He),t(D),t(Ce),t(W),t($e),t(Z),t(Me),t(G))}}}function di(K){let c,b;const _=[K[0],xt];let m={$$slots:{default:[pi]},$$scope:{ctx:K}};for(let p=0;p<_.length;p+=1)m=Ie(m,_[p]);return c=new Bt({props:m}),{c(){kt(c.$$.fragment)},l(p){Pt(c.$$.fragment,p)},m(p,d){It(c,p,d),b=!0},p(p,[d]){const u=d&1?Et(_,[d&1&&mt(p[0]),d&0&&mt(xt)]):{};d&2&&(u.$$scope={dirty:d,ctx:p}),c.$set(u)},i(p){b||(St(c.$$.fragment,p),b=!0)},o(p){zt(c.$$.fragment,p),b=!1},d(p){qt(c,p)}}}const xt={title:"Git commits went missing after a rebase",date:"2019-09-04T08:00:00Z",description:"What happened when you do a rebase",tags:["JavaScript","git","rebase","scm"],label:"blog",tableOfContents:[{link:"summary",title:"Summary"}]};function mi(K,c,b){return $t("blog",{image:Vt}),K.$$set=_=>{b(0,c=Ie(Ie({},c),dt(_)))},c=dt(c),[c]}class wi extends Rt{constructor(c){super(),Ut(this,c,mi,di,Ct,{})}}export{wi as component};
