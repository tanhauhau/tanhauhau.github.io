import"../chunks/Bzak7iHL.js";import"../chunks/kfVmCPsV.js";import{p as j,g as W,d as B,b as S,s,f as $,e as n,a as O,r as a,n as I}from"../chunks/C2PHntuy.js";import{h as o}from"../chunks/C3QlhiH-.js";import{i as T}from"../chunks/BQOOHHT8.js";import{l as q,s as E}from"../chunks/gzNpScmH.js";import{B as R}from"../chunks/B1caYEk9.js";import{t as A}from"../chunks/C3bQ3Oc7.js";const y={title:"Implementing {#range} in Svelte",wip:!0,label:"blog",description:"Anyone whowants to get started in contributing to the Svelte source codeOverviewToday we are going to dive in and implmeent `&#123;#range&#125;` logic block in Svelte.We are going to look at how if you are unfamiliar with the Svelte compiler, I recommend you to read ...",tableOfContents:[{link:"overview",title:"Overview"},{link:"start-implementation",title:"Start implementation"}]},{title:K,wip:M,label:Q,description:U,tableOfContents:V}=y;var C=S(`<p>Anyone who</p> <ul><li>wants to get started in contributing to the Svelte source code</li></ul> <section><h2><a href="#overview" id="overview">Overview</a></h2> <p>Today we are going to dive in and implmeent <code class="inline">&#123;#range&#125;</code> logic block in Svelte.</p> <p>We are going to look at how</p> <p>if you are unfamiliar with the Svelte compiler, I recommend you to read <a href="/the-svelte-compiler-handbook">"The Svelte Compiler Handbook"</a>, which talks about the Svelte compiler at a high level.</p> <p>Armed with the overview of the compilation pipeline, let's dive into the detail, by implementing a new logic block, <code class="inline">&#123;#range&#125;</code>.</p> <p>A quick idea of how <code class="inline">&#123;#range&#125;</code> behaves:</p> <p><strong>1. The syntax:</strong></p> <div class="code-section"><!></div> <div class="code-section"><!></div> <p><strong>2. The behavior:</strong></p> <p>The <code class="inline">&#123;#range&#125;</code> behaves like <a href="https://www.rubyguides.com/2016/06/ruby-ranges-how-do-they-work/" rel="nofollow">Ruby range</a>:</p> <ul><li><code class="inline">&#123;#range&#125;</code> loops from the start to end inclusively</li> <li>allow descending range too: <code class="inline">&#123;#range 5..1 as n&#125;</code></li> <li>allow ranging through characters: <code class="inline">&#123;#range 'a'..'z' as n&#125;</code></li></ul></section> <section><h2><a href="#start-implementation" id="start-implementation">Start implementation</a></h2> <p>With an <a href="https://github.com/sveltejs/svelte/issues/2968" rel="nofollow">https://github.com/sveltejs/svelte/issues/2968</a></p> <div class="code-section"><!></div> <div class="code-section"><!></div> <p>TODO: don't add the dependencies yet
NOTE: copy code from EachBlock, since they lookalike</p> <div class="code-section"><!></div> <div class="code-section"><!></div></section>`,1);function X(d,r){const u=q(r,["children","$$slots","$$events","$$legacy"]);j(r,!1),W("blog",{image:A}),T(),R(d,E(()=>u,()=>y,{children:(x,F)=>{var c=C(),t=s($(c),4),e=s(n(t),14),m=n(e);o(m,()=>'<pre class="prism language-svelte"><code><div class="line"><span class="token comment">&lt;!-- loop &#96;n&#96; through 1, 2, 3, 4, 5 --></span></div><div class="line"><span class="token language-javascript"><span class="token punctuation">&#123;</span>#range <span class="token number">1.</span><span class="token number">.5</span> <span class="token keyword">as</span> n<span class="token punctuation">&#125;</span></span></div><div class="line">  <span class="token language-javascript"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span></div><div class="line"><span class="token language-javascript"><span class="token punctuation">&#123;</span><span class="token operator">/</span>range<span class="token punctuation">&#125;</span></span></div></code></pre>'),a(e);var k=s(e,2),g=n(k);o(g,()=>'<pre class="prism language-svelte"><code><div class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></div><div class="line">  <span class="token keyword">let</span> start <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></div><div class="line">  <span class="token keyword">let</span> end <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span></div><div class="line"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></div><div class="line"></div><div class="line"><span class="token comment">&lt;!-- loop &#96;n&#96; through 1, 2, 3, 4, 5 --></span></div><div class="line"><span class="token language-javascript"><span class="token punctuation">&#123;</span>#range start<span class="token punctuation">.</span><span class="token punctuation">.</span>end <span class="token keyword">as</span> n<span class="token punctuation">&#125;</span></span></div><div class="line">  <span class="token language-javascript"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span></div><div class="line"><span class="token language-javascript"><span class="token punctuation">&#123;</span><span class="token operator">/</span>range<span class="token punctuation">&#125;</span></span></div><div class="line"></div><div class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name"><span class="token namespace">bind:</span>value=</span><span class="token language-javascript"><span class="token punctuation">&#123;</span>start<span class="token punctuation">&#125;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></div><div class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name"><span class="token namespace">bind:</span>value=</span><span class="token language-javascript"><span class="token punctuation">&#123;</span>end<span class="token punctuation">&#125;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></div></code></pre>'),a(k),I(6),a(t);var v=s(t,2),l=s(n(v),4),w=n(l);o(w,()=>`<pre class="prism language-"><code><span class="line">ParseError: Expected if, each or await</span>
<span class="line">  at error (compiler.js:6208:16)</span>
<span class="line">  at Parser.error (compiler.js:6336:3)</span>
<span class="line">  at mustache (compiler.js:5911:11)</span>
<span class="line">  at new Parser (compiler.js:6288:12)</span></code></pre>`),a(l);var p=s(l,2),f=n(p);o(f,()=>`<pre class="prism language-"><code><span class="line">Error: Not implemented: RangeBlock</span>
<span class="line">  at get_constructor (compiler.js:17451:18)</span>
<span class="line">  at children.map.child (compiler.js:17460:23)</span>
<span class="line">  at Array.map (&lt;anonymous&gt;)</span>
<span class="line">  at map_children (compiler.js:17459:18)</span>
<span class="line">  at new Element$1 (compiler.js:16523:19)</span></code></pre>`),a(p);var i=s(p,4),b=n(i);o(b,()=>`<pre class="prism language-"><code><span class="line">Error: TODO implement RangeBlock</span>
<span class="line">  at new FragmentWrapper (compiler.js:12846:11)</span>
<span class="line">  at new ElementWrapper (compiler.js:10261:19)</span>
<span class="line">  at new FragmentWrapper (compiler.js:12888:21)</span>
<span class="line">  at new Renderer (compiler.js:12983:19)</span>
<span class="line">  at dom (compiler.js:13199:19)</span></code></pre>`),a(i);var h=s(i,2),_=n(h);o(_,()=>`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">export</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">default</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">RangeBlockWrapper</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Wrapper</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">	block</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Block</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">	node</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">RangeBlock</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">	fragment</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">FragmentWrapper</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">	index_name</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Identifier</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">	</span><span style="color: var(--shiki-token-keyword)">constructor</span><span style="color: var(--shiki-color-text)">(</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">		renderer</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Renderer</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">		block</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Block</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">		parent</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Wrapper</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">		node</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">RangeBlock</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">		strip_whitespace</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">boolean</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">		next_sibling</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Wrapper</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">	) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-function)">super</span><span style="color: var(--shiki-color-text)">(renderer</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> block</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> parent</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> node);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.cannot_use_innerhtml</span><span style="color: var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.not_static_content</span><span style="color: var(--shiki-color-text)">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-comment)">// const &#123; dependencies &#125; = node.expression;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-comment)">// block.add_dependencies(dependencies);</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-constant)">renderer</span><span style="color: var(--shiki-token-function)">.add_to_context</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">node</span><span style="color: var(--shiki-color-text)">.index</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">true</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.block </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">block</span><span style="color: var(--shiki-token-function)">.child</span><span style="color: var(--shiki-color-text)">(&#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">			comment</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">create_debugging_comment</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.node</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">renderer</span><span style="color: var(--shiki-color-text)">.component)</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">			name</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">renderer</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">component</span><span style="color: var(--shiki-token-function)">.get_unique_name</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&quot;create_range_block&quot;</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">			type</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;range&quot;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">		&#125;);</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.index_name </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> &#123; type</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;Identifier&quot;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> name</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">node</span><span style="color: var(--shiki-color-text)">.index &#125;;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-constant)">renderer</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">blocks</span><span style="color: var(--shiki-token-function)">.push</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.block);</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.fragment </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">FragmentWrapper</span><span style="color: var(--shiki-color-text)">(</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">			renderer</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">			</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.block</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">			</span><span style="color: var(--shiki-token-constant)">node</span><span style="color: var(--shiki-color-text)">.children</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">			</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">			strip_whitespace</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">			next_sibling</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">		);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">	&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">	</span><span style="color: var(--shiki-token-function)">render</span><span style="color: var(--shiki-color-text)">(block</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Block</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> parent_node</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Identifier</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> parent_nodes</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Identifier</span><span style="color: var(--shiki-color-text)">) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">fragment</span><span style="color: var(--shiki-token-function)">.render</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.block</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">null</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">x</span><span style="color: var(--shiki-token-string-expression)">&#96;#nodes&#96;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">as</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Identifier</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">	&#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`),a(h),a(v),O(x,c)},$$slots:{default:!0}})),B()}export{X as component};
