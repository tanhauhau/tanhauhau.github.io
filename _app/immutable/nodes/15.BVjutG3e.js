import{s as Ht,d as Be,e as $t,f as dt,n as Mt}from"../chunks/scheduler.D6VJxl8L.js";import{S as Rt,i as Ut,m as kt,n as Pt,o as Bt,t as It,a as St,p as zt,e as l,s as n,H as Re,c as a,q as r,h as o,d as Ue,r as ke,g as t,u as Pe,j as s}from"../chunks/index.CLAVN-Y5.js";import{g as qt,a as mt}from"../chunks/code-snippet.Gym6WUAG.js";import{B as Dt}from"../chunks/BlogLayout.BTH3PMCG.js";import{t as Et}from"../chunks/twitter-card-image.C3bQ3Oc7.js";const jt=""+new URL("../assets/rebase-8.B4VQgnHG.webp",import.meta.url).href,Vt=""+new URL("../assets/rebase-8.D8ce6I62.webp",import.meta.url).href,Nt=""+new URL("../assets/rebase-8.B-ZYjnbM.png",import.meta.url).href,_t=""+new URL("../assets/rebase-8.C3iGJ1cg.png",import.meta.url).href,Ot=""+new URL("../assets/rebase-7.RSttqJbT.webp",import.meta.url).href,Jt=""+new URL("../assets/rebase-7.CmI9cJx9.webp",import.meta.url).href,Kt=""+new URL("../assets/rebase-7.Bvtk1f7H.png",import.meta.url).href,ut=""+new URL("../assets/rebase-7.BTDQvBFq.png",import.meta.url).href,Wt=""+new URL("../assets/rebase-6.EbdhrXRu.webp",import.meta.url).href,At=""+new URL("../assets/rebase-6.C5LQKZLX.webp",import.meta.url).href,Gt=""+new URL("../assets/rebase-6.BkA1d3ni.png",import.meta.url).href,bt=""+new URL("../assets/rebase-6.BBVHSOx7.png",import.meta.url).href,Qt=""+new URL("../assets/rebase-5.CJQEsNnf.webp",import.meta.url).href,Zt=""+new URL("../assets/rebase-5.DnD8TXT2.webp",import.meta.url).href,Yt=""+new URL("../assets/rebase-5.CeKpWsm6.png",import.meta.url).href,ft=""+new URL("../assets/rebase-5.DWBN9l5H.png",import.meta.url).href,Xt=""+new URL("../assets/rebase-4.ZNUodyYK.webp",import.meta.url).href,Ft=""+new URL("../assets/rebase-4.BDUVpKdb.webp",import.meta.url).href,ei=""+new URL("../assets/rebase-4.C_m10zkW.png",import.meta.url).href,ht=""+new URL("../assets/rebase-4.Bl1hx-3Y.png",import.meta.url).href,ti=""+new URL("../assets/rebase-2.C3Nd9vus.webp",import.meta.url).href,ii=""+new URL("../assets/rebase-2.CzB8gNrt.webp",import.meta.url).href,si=""+new URL("../assets/rebase-2.Tk5UO3By.png",import.meta.url).href,wt=""+new URL("../assets/rebase-2.CgJm7twb.png",import.meta.url).href,li=""+new URL("../assets/rebase-1.CREkGZIf.webp",import.meta.url).href,ai=""+new URL("../assets/rebase-1.DIozlbsu.webp",import.meta.url).href,ni=""+new URL("../assets/rebase-1.6sRo2W9d.png",import.meta.url).href,gt=""+new URL("../assets/rebase-1.DxlawrcG.png",import.meta.url).href,oi=""+new URL("../assets/initial.CoZvkj7l.webp",import.meta.url).href,ri=""+new URL("../assets/initial.2NsuNg8X.webp",import.meta.url).href,ci=""+new URL("../assets/initial.yx4YBziB.png",import.meta.url).href,vt=""+new URL("../assets/initial.BjJV-4Vz.png",import.meta.url).href;function pi(A){let c,b='Last week, I <a href="/git-gudder/">shared about git commands</a> at <a href="https://github.com/Shopee/shopee-react-knowledgeable" rel="nofollow">Shopee React Knowledgeable</a>. At the end of the talk, one of my colleague approached me and asked me about git rebase. She somehow ended up with a messed up git history with <code class="inline">git rebase</code>, and she couldn&#39;t comprehend how she ended up there.',_,m,p="I found that her scenario was interesting, and decided to write it out here.",d,u,Ie="This was what she told me:",G,f,Se='<p>I branched out <code class="inline">feat/a</code> branch from <code class="inline">master</code> and made a few commits (<code class="inline">commit #1</code>, <code class="inline">commit #2</code>).</p> <p>I noticed that master branch has new commits, so I pulled <code class="inline">master</code> branch, and rebased my branch <code class="inline">feat/a</code> onto master branch.</p> <p>Then, instead of <code class="inline">git push --force</code> my local <code class="inline">feat/a</code> to remote <code class="inline">origin</code>, I <code class="inline">git pull --rebase origin feat/a</code>.</p> <p>And, my commits on <code class="inline">feat/a</code>, eg <code class="inline">commit #1</code>, <code class="inline">commit #2</code> were gone!</p>',Q,h,ze='So, we expected to see <code class="inline">commit #1</code>, <code class="inline">commit #2</code> at <code class="inline">HEAD</code> after rebasing onto <code class="inline">origin/feat/a</code> after the <code class="inline">git pull --rebase</code>, yet, the only commits we saw were a bunch of commits from the <code class="inline">master</code> branch.',Z,w,qe="To understand what happened, I decided to draw diagrams to visualize what had happened:",Y,g,De=`<span style="display: block; position: relative; padding-top: 126.667%; width: 100%;"><picture><source type="image/webp" srcset="${ri}, ${oi} 2x"/><img src="${vt}" srcset="${vt}, ${ci} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="initil" title="Before rebasing"/></picture></span>`,X,v,Ee='So, the first thing she did was to <code class="inline">git rebase</code> <code class="inline">feat/a</code> on top of <code class="inline">master</code>:',F,x,je=`<span style="display: block; position: relative; padding-top: 69.828%; width: 100%;"><picture><source type="image/webp" srcset="${ai}, ${li} 2x"/><img src="${gt}" srcset="${gt}, ${ni} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="first rebase" title="Rebase feat/a on top of master"/></picture></span>`,ee,L,Ve="So far, everything looked normal. The next command was the tricky one.",te,y,Ne='She rebased <code class="inline">feat/a</code> on top of <code class="inline">origin/feat/a</code>, she ran:',ie,T,se,Lt=`<pre class="prism language-"><code><span class="line">$ git checkout feat/a</span>
<span class="line">$ git rebase origin/feat/a</span></code></pre>`,le,C,Oe='The most important thing on <code class="inline">git rebase</code> is the 3 reference points of rebasing:',ae,H,Je=`<span style="display: block; position: relative; padding-top: 69.828%; width: 100%;"><picture><source type="image/webp" srcset="${ii}, ${ti} 2x"/><img src="${wt}" srcset="${wt}, ${si} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="3 reference points" title="The 3 reference points"/></picture></span>`,ne,$,Ke="So, when she typed",oe,M,re,yt='<pre class="prism language-"><code><span class="line">$ git rebase origin/feat/a</span></code></pre>',ce,R,We=", it meant:",pe,U,de,Tt='<pre class="prism language-"><code><span class="line">$ git rebase --onto origin/feat/a origin/feat/a feat/a</span></code></pre>',me,k,Ae='<li><code class="inline">new base</code>: <code class="inline">origin/feat/a</code></li> <li><code class="inline">upstream</code>: <code class="inline">origin/feat/a</code></li> <li><code class="inline">branch</code>: <code class="inline">feat/a</code></li>',_e,P,Ge='So what happened was all the commits in master after branching out <code class="inline">feat/a</code> all the way to the newly rebased commits in <code class="inline">feat/a</code> were rebased onto <code class="inline">origin/feat/a</code>:',ue,B,Qe=`<span style="display: block; position: relative; padding-top: 50.625%; width: 100%;"><picture><source type="image/webp" srcset="${Ft}, ${Xt} 2x"/><img src="${ht}" srcset="${ht}, ${ei} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="rebase again"/></picture></span>`,be,I,Ze='However, if you look at the history right now, the commit <code class="inline">commit #1</code> and <code class="inline">commit #2</code> was written twice, first the original commit, second the rebased commit. In cases like this, git would not rewrote the commits again, if git could figure out whether it was a duplicate:',fe,S,Ye=`<span style="display: block; position: relative; padding-top: 68.644%; width: 100%;"><picture><source type="image/webp" srcset="${Zt}, ${Qt} 2x"/><img src="${ft}" srcset="${ft}, ${Yt} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="actual rebase again result"/></picture></span>`,he,z,Xe='It was as though both commit <code class="inline">commit #1</code> and <code class="inline">commit #2</code> were gone, and left with commits from <code class="inline">master</code> branch, because git did not rewrote them when rebasing <code class="inline">feat/a</code>. And actually the changes made in <code class="inline">commit #1</code> and <code class="inline">commit #2</code> were still available.',we,q,Fe='<p>You can read more about this behaviour in <a href="https://git-scm.com/book/en/v2/Git-Branching-Rebasing#_rebase_rebase" rel="nofollow">git&#39;s documentation</a></p>',ge,D,et='So, what she should have done if she wanted to actually rebased the local <code class="inline">feat/a</code> on top of <code class="inline">origin/feat/a</code>, especially after she made another commit, <code class="inline">commit #0</code>?',ve,E,tt=`<span style="display: block; position: relative; padding-top: 58.273%; width: 100%;"><picture><source type="image/webp" srcset="${At}, ${Wt} 2x"/><img src="${bt}" srcset="${bt}, ${Gt} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="adding one more commit"/></picture></span>`,xe,j,it='Well, she should specify the <code class="inline">&lt;upstream&gt;</code> reference point:',Le,V,st=`<span style="display: block; position: relative; padding-top: 57.042%; width: 100%;"><picture><source type="image/webp" srcset="${Jt}, ${Ot} 2x"/><img src="${ut}" srcset="${ut}, ${Kt} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="reference points"/></picture></span>`,ye,N,Te,Ct='<pre class="prism language-"><code><span class="line">$ git rebase --onto origin/feat/a master feat/a</span></code></pre>',Ce,O,lt="And you would get:",He,J,at=`<span style="display: block; position: relative; padding-top: 60.902%; width: 100%;"><picture><source type="image/webp" srcset="${Vt}, ${jt} 2x"/><img src="${_t}" srcset="${_t}, ${Nt} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="result"/></picture></span>`,$e,K,nt='Here again, git is smart enough not to rewrite <code class="inline">commit #1</code> and <code class="inline">commit #2</code>.',Me,W,ot='<h2><a href="#summary" id="summary">Summary</a></h2> <p>When using <code class="inline">git rebase</code>, always remember the 3 reference points of rebase, the <code class="inline">new base</code>, <code class="inline">upstream</code> and <code class="inline">branch</code>.</p>';return{c(){c=l("p"),c.innerHTML=b,_=n(),m=l("p"),m.textContent=p,d=n(),u=l("p"),u.textContent=Ie,G=n(),f=l("blockquote"),f.innerHTML=Se,Q=n(),h=l("p"),h.innerHTML=ze,Z=n(),w=l("p"),w.textContent=qe,Y=n(),g=l("p"),g.innerHTML=De,X=n(),v=l("p"),v.innerHTML=Ee,F=n(),x=l("p"),x.innerHTML=je,ee=n(),L=l("p"),L.textContent=Ve,te=n(),y=l("p"),y.innerHTML=Ne,ie=n(),T=l("div"),se=new Re(!1),le=n(),C=l("p"),C.innerHTML=Oe,ae=n(),H=l("p"),H.innerHTML=Je,ne=n(),$=l("p"),$.textContent=Ke,oe=n(),M=l("div"),re=new Re(!1),ce=n(),R=l("p"),R.textContent=We,pe=n(),U=l("div"),de=new Re(!1),me=n(),k=l("ul"),k.innerHTML=Ae,_e=n(),P=l("p"),P.innerHTML=Ge,ue=n(),B=l("p"),B.innerHTML=Qe,be=n(),I=l("p"),I.innerHTML=Ze,fe=n(),S=l("p"),S.innerHTML=Ye,he=n(),z=l("p"),z.innerHTML=Xe,we=n(),q=l("blockquote"),q.innerHTML=Fe,ge=n(),D=l("p"),D.innerHTML=et,ve=n(),E=l("p"),E.innerHTML=tt,xe=n(),j=l("p"),j.innerHTML=it,Le=n(),V=l("p"),V.innerHTML=st,ye=n(),N=l("div"),Te=new Re(!1),Ce=n(),O=l("p"),O.textContent=lt,He=n(),J=l("p"),J.innerHTML=at,$e=n(),K=l("p"),K.innerHTML=nt,Me=n(),W=l("section"),W.innerHTML=ot,this.h()},l(e){c=a(e,"P",{"data-svelte-h":!0}),r(c)!=="svelte-qzzab7"&&(c.innerHTML=b),_=o(e),m=a(e,"P",{"data-svelte-h":!0}),r(m)!=="svelte-1ovu1he"&&(m.textContent=p),d=o(e),u=a(e,"P",{"data-svelte-h":!0}),r(u)!=="svelte-e5prac"&&(u.textContent=Ie),G=o(e),f=a(e,"BLOCKQUOTE",{"data-svelte-h":!0}),r(f)!=="svelte-a2nrkt"&&(f.innerHTML=Se),Q=o(e),h=a(e,"P",{"data-svelte-h":!0}),r(h)!=="svelte-j7otx6"&&(h.innerHTML=ze),Z=o(e),w=a(e,"P",{"data-svelte-h":!0}),r(w)!=="svelte-309l1l"&&(w.textContent=qe),Y=o(e),g=a(e,"P",{"data-svelte-h":!0}),r(g)!=="svelte-kib43k"&&(g.innerHTML=De),X=o(e),v=a(e,"P",{"data-svelte-h":!0}),r(v)!=="svelte-qcb2e"&&(v.innerHTML=Ee),F=o(e),x=a(e,"P",{"data-svelte-h":!0}),r(x)!=="svelte-og6vk0"&&(x.innerHTML=je),ee=o(e),L=a(e,"P",{"data-svelte-h":!0}),r(L)!=="svelte-10uom1e"&&(L.textContent=Ve),te=o(e),y=a(e,"P",{"data-svelte-h":!0}),r(y)!=="svelte-1grd3vf"&&(y.innerHTML=Ne),ie=o(e),T=a(e,"DIV",{class:!0});var i=Ue(T);se=ke(i,!1),i.forEach(t),le=o(e),C=a(e,"P",{"data-svelte-h":!0}),r(C)!=="svelte-pxy4l4"&&(C.innerHTML=Oe),ae=o(e),H=a(e,"P",{"data-svelte-h":!0}),r(H)!=="svelte-cvggch"&&(H.innerHTML=Je),ne=o(e),$=a(e,"P",{"data-svelte-h":!0}),r($)!=="svelte-3vd5d4"&&($.textContent=Ke),oe=o(e),M=a(e,"DIV",{class:!0});var rt=Ue(M);re=ke(rt,!1),rt.forEach(t),ce=o(e),R=a(e,"P",{"data-svelte-h":!0}),r(R)!=="svelte-1391g6c"&&(R.textContent=We),pe=o(e),U=a(e,"DIV",{class:!0});var ct=Ue(U);de=ke(ct,!1),ct.forEach(t),me=o(e),k=a(e,"UL",{"data-svelte-h":!0}),r(k)!=="svelte-orneup"&&(k.innerHTML=Ae),_e=o(e),P=a(e,"P",{"data-svelte-h":!0}),r(P)!=="svelte-1gqbrnd"&&(P.innerHTML=Ge),ue=o(e),B=a(e,"P",{"data-svelte-h":!0}),r(B)!=="svelte-2n3k69"&&(B.innerHTML=Qe),be=o(e),I=a(e,"P",{"data-svelte-h":!0}),r(I)!=="svelte-19cjc2l"&&(I.innerHTML=Ze),fe=o(e),S=a(e,"P",{"data-svelte-h":!0}),r(S)!=="svelte-1p31m79"&&(S.innerHTML=Ye),he=o(e),z=a(e,"P",{"data-svelte-h":!0}),r(z)!=="svelte-1bar42i"&&(z.innerHTML=Xe),we=o(e),q=a(e,"BLOCKQUOTE",{"data-svelte-h":!0}),r(q)!=="svelte-7q0jkb"&&(q.innerHTML=Fe),ge=o(e),D=a(e,"P",{"data-svelte-h":!0}),r(D)!=="svelte-5q50bn"&&(D.innerHTML=et),ve=o(e),E=a(e,"P",{"data-svelte-h":!0}),r(E)!=="svelte-1nkel07"&&(E.innerHTML=tt),xe=o(e),j=a(e,"P",{"data-svelte-h":!0}),r(j)!=="svelte-7fdemh"&&(j.innerHTML=it),Le=o(e),V=a(e,"P",{"data-svelte-h":!0}),r(V)!=="svelte-1rovohc"&&(V.innerHTML=st),ye=o(e),N=a(e,"DIV",{class:!0});var pt=Ue(N);Te=ke(pt,!1),pt.forEach(t),Ce=o(e),O=a(e,"P",{"data-svelte-h":!0}),r(O)!=="svelte-1r9fydh"&&(O.textContent=lt),He=o(e),J=a(e,"P",{"data-svelte-h":!0}),r(J)!=="svelte-aoe7qx"&&(J.innerHTML=at),$e=o(e),K=a(e,"P",{"data-svelte-h":!0}),r(K)!=="svelte-upmytj"&&(K.innerHTML=nt),Me=o(e),W=a(e,"SECTION",{"data-svelte-h":!0}),r(W)!=="svelte-1mez009"&&(W.innerHTML=ot),this.h()},h(){se.a=null,Pe(T,"class","code-section"),re.a=null,Pe(M,"class","code-section"),de.a=null,Pe(U,"class","code-section"),Te.a=null,Pe(N,"class","code-section")},m(e,i){s(e,c,i),s(e,_,i),s(e,m,i),s(e,d,i),s(e,u,i),s(e,G,i),s(e,f,i),s(e,Q,i),s(e,h,i),s(e,Z,i),s(e,w,i),s(e,Y,i),s(e,g,i),s(e,X,i),s(e,v,i),s(e,F,i),s(e,x,i),s(e,ee,i),s(e,L,i),s(e,te,i),s(e,y,i),s(e,ie,i),s(e,T,i),se.m(Lt,T),s(e,le,i),s(e,C,i),s(e,ae,i),s(e,H,i),s(e,ne,i),s(e,$,i),s(e,oe,i),s(e,M,i),re.m(yt,M),s(e,ce,i),s(e,R,i),s(e,pe,i),s(e,U,i),de.m(Tt,U),s(e,me,i),s(e,k,i),s(e,_e,i),s(e,P,i),s(e,ue,i),s(e,B,i),s(e,be,i),s(e,I,i),s(e,fe,i),s(e,S,i),s(e,he,i),s(e,z,i),s(e,we,i),s(e,q,i),s(e,ge,i),s(e,D,i),s(e,ve,i),s(e,E,i),s(e,xe,i),s(e,j,i),s(e,Le,i),s(e,V,i),s(e,ye,i),s(e,N,i),Te.m(Ct,N),s(e,Ce,i),s(e,O,i),s(e,He,i),s(e,J,i),s(e,$e,i),s(e,K,i),s(e,Me,i),s(e,W,i)},p:Mt,d(e){e&&(t(c),t(_),t(m),t(d),t(u),t(G),t(f),t(Q),t(h),t(Z),t(w),t(Y),t(g),t(X),t(v),t(F),t(x),t(ee),t(L),t(te),t(y),t(ie),t(T),t(le),t(C),t(ae),t(H),t(ne),t($),t(oe),t(M),t(ce),t(R),t(pe),t(U),t(me),t(k),t(_e),t(P),t(ue),t(B),t(be),t(I),t(fe),t(S),t(he),t(z),t(we),t(q),t(ge),t(D),t(ve),t(E),t(xe),t(j),t(Le),t(V),t(ye),t(N),t(Ce),t(O),t(He),t(J),t($e),t(K),t(Me),t(W))}}}function di(A){let c,b;const _=[A[0],xt];let m={$$slots:{default:[pi]},$$scope:{ctx:A}};for(let p=0;p<_.length;p+=1)m=Be(m,_[p]);return c=new Dt({props:m}),{c(){kt(c.$$.fragment)},l(p){Pt(c.$$.fragment,p)},m(p,d){Bt(c,p,d),b=!0},p(p,[d]){const u=d&1?qt(_,[d&1&&mt(p[0]),d&0&&mt(xt)]):{};d&2&&(u.$$scope={dirty:d,ctx:p}),c.$set(u)},i(p){b||(It(c.$$.fragment,p),b=!0)},o(p){St(c.$$.fragment,p),b=!1},d(p){zt(c,p)}}}const xt={title:"Git commits went missing after a rebase",date:"2019-09-04T08:00:00Z",description:"What happened when you do a rebase",tags:["JavaScript","git","rebase","scm"],label:"blog",tableOfContents:[{link:"summary",title:"Summary"}]};function mi(A,c,b){return $t("blog",{image:Et}),A.$$set=_=>{b(0,c=Be(Be({},c),dt(_)))},c=dt(c),[c]}class wi extends Rt{constructor(c){super(),Ut(this,c,mi,di,Ht,{})}}export{wi as component};
