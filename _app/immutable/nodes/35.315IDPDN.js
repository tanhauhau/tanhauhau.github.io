import{s as Qe,d as _e,e as We,f as qe,n as Fe}from"../chunks/scheduler.85ImRbsk.js";import{S as Ge,i as Ke,m as Xe,n as Ze,o as et,t as tt,a as st,p as lt,e as n,s as o,H as Se,c as i,q as p,h as a,d as je,r as ze,g as s,u as Ae,j as l}from"../chunks/index.JMRAb4ib.js";import{g as nt,a as Be}from"../chunks/code-snippet.p32Anx_S.js";import{B as it}from"../chunks/BlogLayout.TadBQAnB.js";import{t as ot}from"../chunks/twitter-card-image.6izpPI6I.js";const at=""+new URL("../assets/flow-ast.H-21Junq.webp",import.meta.url).href,rt=""+new URL("../assets/flow-ast.ALSY6_Yu.webp",import.meta.url).href,pt=""+new URL("../assets/flow-ast.NJlV0yVR.png",import.meta.url).href,Ee=""+new URL("../assets/flow-ast.9Kwc2g_3.png",import.meta.url).href,ct=""+new URL("../assets/babel-eslint-8-ast.z-lNAA5U.webp",import.meta.url).href,ut=""+new URL("../assets/babel-eslint-8-ast.I_wfJQix.webp",import.meta.url).href,dt=""+new URL("../assets/babel-eslint-8-ast.O1za2ygN.png",import.meta.url).href,Ne=""+new URL("../assets/babel-eslint-8-ast.k1Q9v9qR.png",import.meta.url).href,_t=""+new URL("../assets/flow-ast.H-21Junq.webp",import.meta.url).href,ft=""+new URL("../assets/flow-ast.ALSY6_Yu.webp",import.meta.url).href,ht=""+new URL("../assets/flow-ast.NJlV0yVR.png",import.meta.url).href,Je=""+new URL("../assets/flow-ast.9Kwc2g_3.png",import.meta.url).href,mt=""+new URL("../assets/ast-explorer.TTQOrBdQ.webp",import.meta.url).href,bt=""+new URL("../assets/ast-explorer.__mhBEjG.webp",import.meta.url).href,wt=""+new URL("../assets/ast-explorer.0n14hNUw.png",import.meta.url).href,Ve=""+new URL("../assets/ast-explorer.22Xclbsi.png",import.meta.url).href;function vt(j){let r,h='Today <a href="https://dev.wgao19.cc/" rel="nofollow">Wei Gao</a> posed an interesting question:',_,d,c='She was upgrading Flow to v0.85, <a href="https://medium.com/flow-type/asking-for-required-annotations-64d4f9c1edf8" rel="nofollow">which requires her to explicitly type the argument of the function call</a>. However, when she saved the file, our <a href="https://github.com/prettier/prettier" rel="nofollow">eslint-prettier</a> automatically format the code into a weird syntax:',u,f,fe="So, when she wrote:",z,m,A,De='<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-function)">fooFunction</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-function)">Bar</span><span style="color: var(--shiki-color-text)">&gt;(</span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">);</span></span></code></pre>',B,b,he='With <a href="https://github.com/prettier/eslint-plugin-prettier" rel="nofollow">eslint-plugin-prettier</a>, eslint <em>‚Äúfixed‚Äù</em> the code into:',E,w,N,Oe='<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-function)">fooFunction</span><span style="color: var(--shiki-color-text)"> &lt; </span><span style="color: var(--shiki-token-function)">Bar</span><span style="color: var(--shiki-color-text)"> &gt; (</span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">);</span></span></code></pre>',J,v,me='It felt like eslint sees <code class="inline">&lt;</code> and <code class="inline">&gt;</code> as the comparison operator, rather than <code class="inline">&lt;Type&gt;</code> as a whole!',V,x,be='To confirm with my hypothesis, I opened up my favourite tool for inspecting <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree" rel="nofollow">AST</a>: <a href="https://astexplorer.net/" rel="nofollow">astexplorer.net</a>',Y,D,O,y,we='You can paste your code into <a href="https://astexplorer.net/" rel="nofollow">astexplorer.net</a> and see how different parser ‚Äúsees‚Äù your code in terms of a AST (Abstract Syntax Tree).',Q,g,ve=`<span style="display: block; position: relative; padding-top: 57.183%; width: 100%;"><picture><source type="image/webp" srcset="${bt}, ${mt} 2x"/><img src="${Ve}" srcset="${Ve}, ${wt} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="You can choose different a parser!"/></picture></span>`,W,k,xe="As you can see from the picture above, you can choose from different parsers:",F,L,ye='<li><strong>acorn</strong>‚Ää‚Äî‚Ääthe parser used by webpack after the loaders, webpack uses acorn‚Äôs AST to find <code class="inline">import</code> and <code class="inline">require()</code> syntax to know generate the dependency tree of your project, as well as provide an entry for plugins like <a href="https://webpack.js.org/plugins/define-plugin/" rel="nofollow">DefinePlugin</a> to transform the transpiled code.</li> <li><strong>babylon</strong>‚Äî‚Ääthe <a href="https://github.com/babel/babel/" rel="nofollow">babel</a> parser, now it‚Äôs called <a href="https://babeljs.io/docs/en/babel-parser" rel="nofollow">@babel/parser</a>.</li> <li><strong>flow</strong>, <strong>typescript</strong>, <strong>uglify-js</strong>‚Äî‚Ääthe parsers that each of the library uses</li> <li><strong>esprima</strong>‚Ää‚Äî‚Ääthe default eslint parser</li> <li><strong>babel-eslint</strong>‚Ää‚Äî‚Ääa wrapper of babel parser for eslint, which is also the one we used, because we have a ton of babel plugins configured, so by using babel-eslint we don‚Äôt have to reconfigure the same plugins for eslint.</li>',G,K,X,T,ge="So I copied our code into astexplorer, and selected the ‚Äúflow‚Äù parser:",Z,H,ke=`<span style="display: block; position: relative; padding-top: 28.927%; width: 100%;"><picture><source type="image/webp" srcset="${ft}, ${_t} 2x"/><img src="${Je}" srcset="${Je}, ${ht} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="flow ast"/></picture></span>`,ee,C,Le="I can see the type annotation is being parsed as ‚ÄúTypeParameterInstantiation‚Äù, however when I changed the parser to ‚Äúbabel-eslint8‚Äù,",te,M,Te=`<span style="display: block; position: relative; padding-top: 39.444%; width: 100%;"><picture><source type="image/webp" srcset="${ut}, ${ct} 2x"/><img src="${Ne}" srcset="${Ne}, ${dt} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="babel eslint 8 ast"/></picture></span>`,se,$,He="I get a Binary Expression and a SequenceExpression!",le,ne,ie,R,Ce='<strong>Binary Expression</strong> is a way to express logical expression and mathematical expression, eg: <code class="inline">a + b</code> , <code class="inline">a &amp;&amp; b</code> , <code class="inline">a &lt;= b</code>, etc.',oe,P,Me='<strong>Sequence Expression</strong> on the other hand is something you don‚Äôt see people write that often, you can look up how it works in <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Comma_Operator" rel="nofollow">Comma operator (MDN)</a>, basically you can write expressions as a expression by joining them with a comma operator (<code class="inline">,</code>), and the expression returns the value of the last expression, eg: result = <code class="inline">(a++, b++, c -= 2, d.push(e), --f)</code>, you increment <code class="inline">a</code> , <code class="inline">b</code> , decrement <code class="inline">c</code> by 2, and pushed <code class="inline">e</code> into <code class="inline">d</code> and decrement <code class="inline">f</code> and set result to the new value of <code class="inline">f</code>. Wow, that‚Äôs a lot in one statement! It‚Äôs confusing to read, but you see this often in a minified code.',ae,re,pe,U,$e='Now this explains why prettier will try to add space in between <code class="inline">&lt;</code> and <code class="inline">&gt;</code> .',ce,I,Re="I saw that there‚Äôs a babel-eslint9, and I gave it a try, and‚Ä¶",ue,q,Pe=`<span style="display: block; position: relative; padding-top: 28.927%; width: 100%;"><picture><source type="image/webp" srcset="${rt}, ${at} 2x"/><img src="${Ee}" srcset="${Ee}, ${pt} 2x" loading="lazy" style="position: absolute; top: 0; width: 100%; height: 100%" alt="babel eslint 9 ast"/></picture></span>`,de,S,Ue='It seems like the bug was fixed on <code class="inline">babel-eslint9</code>, so I plowed through the release notes of babel-eslint, and I found this <a href="https://github.com/babel/babel-eslint/pull/444" rel="nofollow">merge commit</a>. So it seems like upgrading babel-eslint to v9 will solve the issue! üéâ';return{c(){r=n("p"),r.innerHTML=h,_=o(),d=n("p"),d.innerHTML=c,u=o(),f=n("p"),f.textContent=fe,z=o(),m=n("div"),A=new Se(!1),B=o(),b=n("p"),b.innerHTML=he,E=o(),w=n("div"),N=new Se(!1),J=o(),v=n("p"),v.innerHTML=me,V=o(),x=n("p"),x.innerHTML=be,Y=o(),D=n("hr"),O=o(),y=n("p"),y.innerHTML=we,Q=o(),g=n("p"),g.innerHTML=ve,W=o(),k=n("p"),k.textContent=xe,F=o(),L=n("ul"),L.innerHTML=ye,G=o(),K=n("hr"),X=o(),T=n("p"),T.textContent=ge,Z=o(),H=n("p"),H.innerHTML=ke,ee=o(),C=n("p"),C.textContent=Le,te=o(),M=n("p"),M.innerHTML=Te,se=o(),$=n("p"),$.textContent=He,le=o(),ne=n("hr"),ie=o(),R=n("p"),R.innerHTML=Ce,oe=o(),P=n("p"),P.innerHTML=Me,ae=o(),re=n("hr"),pe=o(),U=n("p"),U.innerHTML=$e,ce=o(),I=n("p"),I.textContent=Re,ue=o(),q=n("p"),q.innerHTML=Pe,de=o(),S=n("p"),S.innerHTML=Ue,this.h()},l(e){r=i(e,"P",{"data-svelte-h":!0}),p(r)!=="svelte-1xjxepp"&&(r.innerHTML=h),_=a(e),d=i(e,"P",{"data-svelte-h":!0}),p(d)!=="svelte-fem2qq"&&(d.innerHTML=c),u=a(e),f=i(e,"P",{"data-svelte-h":!0}),p(f)!=="svelte-1hz5r35"&&(f.textContent=fe),z=a(e),m=i(e,"DIV",{class:!0});var t=je(m);A=ze(t,!1),t.forEach(s),B=a(e),b=i(e,"P",{"data-svelte-h":!0}),p(b)!=="svelte-smcm8a"&&(b.innerHTML=he),E=a(e),w=i(e,"DIV",{class:!0});var Ie=je(w);N=ze(Ie,!1),Ie.forEach(s),J=a(e),v=i(e,"P",{"data-svelte-h":!0}),p(v)!=="svelte-1mx5gae"&&(v.innerHTML=me),V=a(e),x=i(e,"P",{"data-svelte-h":!0}),p(x)!=="svelte-14m4uj6"&&(x.innerHTML=be),Y=a(e),D=i(e,"HR",{}),O=a(e),y=i(e,"P",{"data-svelte-h":!0}),p(y)!=="svelte-18jbsvy"&&(y.innerHTML=we),Q=a(e),g=i(e,"P",{"data-svelte-h":!0}),p(g)!=="svelte-4bzsjs"&&(g.innerHTML=ve),W=a(e),k=i(e,"P",{"data-svelte-h":!0}),p(k)!=="svelte-1hetemh"&&(k.textContent=xe),F=a(e),L=i(e,"UL",{"data-svelte-h":!0}),p(L)!=="svelte-1b0n8ly"&&(L.innerHTML=ye),G=a(e),K=i(e,"HR",{}),X=a(e),T=i(e,"P",{"data-svelte-h":!0}),p(T)!=="svelte-18y3jdi"&&(T.textContent=ge),Z=a(e),H=i(e,"P",{"data-svelte-h":!0}),p(H)!=="svelte-x4ytzb"&&(H.innerHTML=ke),ee=a(e),C=i(e,"P",{"data-svelte-h":!0}),p(C)!=="svelte-nfwvl8"&&(C.textContent=Le),te=a(e),M=i(e,"P",{"data-svelte-h":!0}),p(M)!=="svelte-1grpo11"&&(M.innerHTML=Te),se=a(e),$=i(e,"P",{"data-svelte-h":!0}),p($)!=="svelte-an2hdx"&&($.textContent=He),le=a(e),ne=i(e,"HR",{}),ie=a(e),R=i(e,"P",{"data-svelte-h":!0}),p(R)!=="svelte-14v7v7s"&&(R.innerHTML=Ce),oe=a(e),P=i(e,"P",{"data-svelte-h":!0}),p(P)!=="svelte-1htqpwp"&&(P.innerHTML=Me),ae=a(e),re=i(e,"HR",{}),pe=a(e),U=i(e,"P",{"data-svelte-h":!0}),p(U)!=="svelte-1q56tr5"&&(U.innerHTML=$e),ce=a(e),I=i(e,"P",{"data-svelte-h":!0}),p(I)!=="svelte-1naux1u"&&(I.textContent=Re),ue=a(e),q=i(e,"P",{"data-svelte-h":!0}),p(q)!=="svelte-1hepp1f"&&(q.innerHTML=Pe),de=a(e),S=i(e,"P",{"data-svelte-h":!0}),p(S)!=="svelte-iqz6h2"&&(S.innerHTML=Ue),this.h()},h(){A.a=null,Ae(m,"class","code-section"),N.a=null,Ae(w,"class","code-section")},m(e,t){l(e,r,t),l(e,_,t),l(e,d,t),l(e,u,t),l(e,f,t),l(e,z,t),l(e,m,t),A.m(De,m),l(e,B,t),l(e,b,t),l(e,E,t),l(e,w,t),N.m(Oe,w),l(e,J,t),l(e,v,t),l(e,V,t),l(e,x,t),l(e,Y,t),l(e,D,t),l(e,O,t),l(e,y,t),l(e,Q,t),l(e,g,t),l(e,W,t),l(e,k,t),l(e,F,t),l(e,L,t),l(e,G,t),l(e,K,t),l(e,X,t),l(e,T,t),l(e,Z,t),l(e,H,t),l(e,ee,t),l(e,C,t),l(e,te,t),l(e,M,t),l(e,se,t),l(e,$,t),l(e,le,t),l(e,ne,t),l(e,ie,t),l(e,R,t),l(e,oe,t),l(e,P,t),l(e,ae,t),l(e,re,t),l(e,pe,t),l(e,U,t),l(e,ce,t),l(e,I,t),l(e,ue,t),l(e,q,t),l(e,de,t),l(e,S,t)},p:Fe,d(e){e&&(s(r),s(_),s(d),s(u),s(f),s(z),s(m),s(B),s(b),s(E),s(w),s(J),s(v),s(V),s(x),s(Y),s(D),s(O),s(y),s(Q),s(g),s(W),s(k),s(F),s(L),s(G),s(K),s(X),s(T),s(Z),s(H),s(ee),s(C),s(te),s(M),s(se),s($),s(le),s(ne),s(ie),s(R),s(oe),s(P),s(ae),s(re),s(pe),s(U),s(ce),s(I),s(ue),s(q),s(de),s(S))}}}function xt(j){let r,h;const _=[j[0],Ye];let d={$$slots:{default:[vt]},$$scope:{ctx:j}};for(let c=0;c<_.length;c+=1)d=_e(d,_[c]);return r=new it({props:d}),{c(){Xe(r.$$.fragment)},l(c){Ze(r.$$.fragment,c)},m(c,u){et(r,c,u),h=!0},p(c,[u]){const f=u&1?nt(_,[u&1&&Be(c[0]),u&0&&Be(Ye)]):{};u&2&&(f.$$scope={dirty:u,ctx:c}),r.$set(f)},i(c){h||(tt(r.$$.fragment,c),h=!0)},o(c){st(r.$$.fragment,c),h=!1},d(c){lt(r,c)}}}const Ye={title:"My eslint doesn‚Äôt work with for flow 0.85‚Äôs explicit type argument syntax",date:"2019-01-17T08:00:00Z",description:"and how I figured out why.",label:"blog"};function yt(j,r,h){return We("blog",{image:ot}),j.$$set=_=>{h(0,r=_e(_e({},r),qe(_)))},r=qe(r),[r]}class Ct extends Ge{constructor(r){super(),Ke(this,r,yt,xt,Qe,{})}}export{Ct as component};
